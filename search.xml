<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>AST</title>
    <url>/2020/07/03/AST/</url>
    <content><![CDATA[<p>AST ä¸€ç§è¯­æ³•æ ‘<span id="more"></span></p>
<div class="tip">
   tipæ–‡æ¡ˆ
</div>
]]></content>
      <tags>
        <tag>JS</tag>
      </tags>
  </entry>
  <entry>
    <title>CSSå‡†å¤‡</title>
    <url>/2020/04/08/CSS_review/</url>
    <content><![CDATA[<h3 id="å¸ƒå±€"><a href="#å¸ƒå±€" class="headerlink" title="å¸ƒå±€"></a>å¸ƒå±€</h3><h4 id="1-ä»‹ç»ä¸‹BFCåŠå…¶åº”ç”¨"><a href="#1-ä»‹ç»ä¸‹BFCåŠå…¶åº”ç”¨" class="headerlink" title="1. ä»‹ç»ä¸‹BFCåŠå…¶åº”ç”¨"></a>1. ä»‹ç»ä¸‹BFCåŠå…¶åº”ç”¨</h4><ul>
<li><p>BFC æ˜¯ä»€ä¹ˆ:<br>å®ƒæ˜¯ css ç›’æ¨¡å‹çš„æ¸²æŸ“æ¨¡å¼ã€‚<br>æœ‰ç€ç›’å­å¯¹é½ï¼Œå¤–è¾¹è·é‡å ï¼Œæ¸…é™¤æµ®åŠ¨ï¼Œé˜²æ­¢æ–‡å­—ç¯ç»•ï¼Œå¤šåˆ—æœ€ååˆ—å®½åº¦è‡ªå®šä¹‰ï¼ˆä¸æŒ¤æ‰ï¼‰</p>
</li>
<li><p>æ€ä¹ˆæ–°å»ºä¸€ä¸ª BFC :<br>ä¸€ä¸ªæ–°çš„ BFC å¯ä»¥é€šè¿‡ç»™å®¹å™¨æ·»åŠ ä»»ä½•ä¸€ä¸ªè§¦å‘ BFC çš„ CSS æ ·å¼ï¼Œå¦‚ overflow : scroll, overflow : hidden, display : flex, float: left,æˆ–è€… display: tableæ¥åˆ›å»ºã€‚<br>display: table å¯èƒ½ä¼šäº§ç”Ÿä¸€äº›é—®é¢˜<br>overflow: scroll å¯èƒ½ä¼šæ˜¾ç¤ºä¸å¿…è¦çš„æ»šåŠ¨æ¡<br>float: left å°†ä¼šæŠŠå…ƒç´ ç½®äºå®¹å™¨çš„å·¦è¾¹ï¼Œå…¶ä»–å…ƒç´ ç¯ç»•ç€å®ƒ<br>overflow: hidden å°†ä¼šå‰ªåˆ‡æ‰æº¢å‡ºçš„å…ƒç´ </p>
</li>
</ul>
<p>å‚è€ƒé“¾æ¥ï¼š<br><a href="https://www.w3cplus.com/css/understanding-block-formatting-contexts-in-css.html">w3cPlus</a><br><a href="https://developer.mozilla.org/zh-CN/docs/Web/Guide/CSS/Block_formatting_context">MDN</a></p>
<h4 id="2-floatå¸ƒå±€ï¼Œclearfix"><a href="#2-floatå¸ƒå±€ï¼Œclearfix" class="headerlink" title="2. floatå¸ƒå±€ï¼Œclearfix"></a>2. floatå¸ƒå±€ï¼Œclearfix</h4><h4 id="3-flexå¸ƒå±€"><a href="#3-flexå¸ƒå±€" class="headerlink" title="3. flexå¸ƒå±€"></a>3. flexå¸ƒå±€</h4><h4 id="4-ç›’å­æ¨¡å‹ç†è§£ä»¥åŠç›¸å…³CSSå±æ€§"><a href="#4-ç›’å­æ¨¡å‹ç†è§£ä»¥åŠç›¸å…³CSSå±æ€§" class="headerlink" title="4. ç›’å­æ¨¡å‹ç†è§£ä»¥åŠç›¸å…³CSSå±æ€§"></a>4. ç›’å­æ¨¡å‹ç†è§£ä»¥åŠç›¸å…³CSSå±æ€§</h4><ul>
<li>ä»€ä¹ˆæ˜¯ç›’å­æ¨¡å‹ï¼Ÿ<br>ç½‘é¡µçš„ dom å…·æœ‰ç›’å­çš„å±æ€§ï¼Œä¸€å±‚ä¸€å±‚çš„è£…è½½ã€‚æ•…æŠŠ dom ç§°ä¸ºç›’å­æ¨¡å‹ã€‚<br>ç›’å­æ¨¡å‹èŒƒå›´åŒ…æ‹¬ï¼šcontent ã€padding ã€border ã€margin</li>
</ul>
<p>å­˜åœ¨ä¸¤ç§ç›’å­æ¨¡å‹ï¼šæ ‡å‡† w3c ç›’å­æ¨¡å‹ï¼ˆä¸»æµï¼‰ã€IEç›’å­æ¨¡å‹ï¼ˆä»¥é¡µé¢å¤´é¡¶çš„ Doctype å£°æ˜æ¥åŒºåˆ†ï¼‰<br>å®ƒä»¬åŒºåˆ«åœ¨äºï¼šæ ‡å‡† w3c ç›’å­æ¨¡å‹ï¼Œcontent æ˜¯ä»…ä»…åŒ…æ‹¬è‡ªèº«å®½é«˜ï¼Œè€Œ IEç›’å­æ¨¡å‹çš„ content å®½é«˜æ˜¯ï¼ˆè‡ªèº«å®½é«˜+ padding + borderï¼‰</p>
<ul>
<li><p><strong>offset</strong>ç³»åˆ—ï¼š<br>(offset å•è¯è‡ªèº«å°±æœ‰åç§»é‡çš„æ„æ€) è¡¨ç¤ºå…ƒç´ åœ¨å±å¹•ä¸Šå ç”¨çš„å¯è§ç©ºé—´ï¼Œéƒ½ä»¥åƒç´ ä¸ºå•ä½ã€‚<br>å±æ€§ä¸º åªè¯»ä¸å¯å†™<br>å¯è§å¤§å°ç”±ï¼šé«˜åº¦ã€å®½åº¦ã€å†…è¾¹è·ã€æ»šåŠ¨æ¡ã€è¾¹æ¡†ã€‚ ï¼ˆ<strong>ï¼ï¼ï¼ä¸åŒ…æ‹¬å¤–è¾¹è·</strong>ï¼‰</p>
<ul>
<li>offsetHeight : å…ƒç´ åœ¨å‚ç›´æ–¹å‘å ç”¨çš„ç©ºé—´å¤§å°</li>
<li>offsetWidth : å…ƒç´ åœ¨æ°´å¹³æ–¹å‘å ç”¨çš„ç©ºé—´å¤§å°</li>
<li>offsetLeft : å…ƒç´ çš„å·¦è¾¹æ¡† è‡³ <strong>åŒ…å«å…ƒç´ </strong>çš„å·¦å†…è¾¹æ¡† çš„åƒç´ è·ç¦»</li>
<li>offsetTop : å…ƒç´ çš„ä¸Šè¾¹æ¡† è‡³ <strong>åŒ…å«å…ƒç´ </strong>çš„ä¸Šå†…è¾¹æ¡† çš„åƒç´ è·ç¦»</li>
<li>offsetParent : åŒ…å«å…ƒç´ çš„å¼•ç”¨</li>
</ul>
</li>
<li><p><strong>client</strong>ç³»åˆ—ï¼š<br>å±æ€§ä¸º åªè¯»ä¸å¯å†™<br>(è¡¨ç¤ºå®¢æˆ·åŒºå¤§å°çš„å«ä¹‰) å…ƒç´ å†…å®¹ä»¥åŠå†…è¾¹è·å ç”¨çš„ç©ºé—´å¤§å°</p>
<ul>
<li>clientWidth : å†…å®¹å®½åº¦ + å·¦å³å†…è¾¹è· </li>
<li>clientHeight : å†…å®¹é«˜åº¦ + ä¸Šä¸‹å†…è¾¹è·<br>åº”ç”¨åœºæ™¯ï¼š<br>æµè§ˆå™¨è§†å£å¤§å°ï¼šdocument.documentElement.clientWidth / clientHeight<br>é€‚é…ie7:      document.body.clientWidth / clientHeight<br>(document.compatMode == â€˜BackCompatâ€™ // ç¡®ä¿æµè§ˆå™¨åœ¨æ··æ‚æ¨¡å¼ æ­¤æ—¶æ˜¯é€‚é…ieç³»åˆ—)</li>
</ul>
</li>
<li><p><strong>scroll</strong>ç³»åˆ—ï¼š</p>
</li>
<li><p><strong>getBoundingClientrect</strong></p>
</li>
</ul>
<h4 id="5-margin"><a href="#5-margin" class="headerlink" title="5. margin"></a>5. margin</h4><pre><code>+ marginå¡Œé™·é—®é¢˜
+ marginè´Ÿå€¼é—®é¢˜
</code></pre>
<h4 id="slot-A-display-none-B-visibility-hidden-C-opacity-0çš„åŒºåˆ«"><a href="#slot-A-display-none-B-visibility-hidden-C-opacity-0çš„åŒºåˆ«" class="headerlink" title="#### slot. A: display:none; B: visibility:hidden; C: opacity: 0çš„åŒºåˆ«"></a>#### slot. A: display:none; B: visibility:hidden; C: opacity: 0çš„åŒºåˆ«</h4><ul>
<li>å±•ç¤ºç¨‹åº¦ä¸Š<br>éƒ½ä¸æ˜¾ç¤º</li>
<li>domå¯æ“ä½œä¸Š<br>Aä¸å¯æ“ä½œï¼ŒBä¸å¯æ“ä½œï¼ŒCå¯æ“ä½œ</li>
<li>ç»§æ‰¿æ€§<br>Aå’ŒCçš„çˆ¶ç›’å­è®¾ç½®äº†å¯¹åº”çš„å±æ€§Aå’ŒCï¼Œåˆ™ä»–ä»¬çš„å­ä»£ä¹Ÿæ˜¯ä¸å¯è§ï¼Œä¸å¯æ“ä½œã€‚Bçš„å­ä»£æ˜¯å¯ä»¥è®¾ç½®æ˜¾ç¤ºçš„</li>
<li>æ€§èƒ½<br>Aæ”¹å˜äº†ç»“æ„ï¼Œå¼•èµ·æ–‡æ¡£å›æµï¼Œæ€§èƒ½æ¶ˆè€—æœ€å¤§<br>Bå¼•èµ·å…ƒç´ é‡ç»˜ï¼Œæ¶ˆè€—ä¸­ç­‰<br>Cæ¶ˆè€—æœ€ä½</li>
</ul>
<p>å‚è€ƒé“¾æ¥ï¼š<br><a href="https://www.zhangxinxu.com/wordpress/2012/02/css-overflow-hidden-visibility-hidden-disabled-use/">å¼ é‘«æ—­BLOG</a></p>
]]></content>
      <tags>
        <tag>é¢è¯•</tag>
      </tags>
  </entry>
  <entry>
    <title>ES2019æ–°å˜åŒ–</title>
    <url>/2020/07/20/ES2019%E6%96%B0%E5%B1%9E%E6%80%A7/</url>
    <content><![CDATA[<p>1 æ•°ç»„ï¼š<br>æ•°ç»„é™ç»´ï¼šArray.prototype.flat() é€’å½’åœ°å°†åµŒå¥—æ•°ç»„æ‹¼åˆåˆ°æŒ‡å®šæ·±åº¦ åˆ›å»ºæ–°æ•°ç»„ï¼Œä¸æ”¹åŸæ•°ç»„</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> arr1 = [<span class="number">1</span>, <span class="number">2</span>, [<span class="number">3</span>, <span class="number">4</span>]];</span><br><span class="line">arr1.flat(); </span><br><span class="line"><span class="comment">// [1, 2, 3, 4]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> arr2 = [<span class="number">1</span>, <span class="number">2</span>, [<span class="number">3</span>, <span class="number">4</span>, [<span class="number">5</span>, <span class="number">6</span>]]];</span><br><span class="line">arr2.flat(<span class="number">2</span>); </span><br><span class="line"><span class="comment">// [1, 2, 3, 4, 5, 6]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> arr3 = [<span class="number">1</span>, <span class="number">2</span>, [<span class="number">3</span>, <span class="number">4</span>, [<span class="number">5</span>, <span class="number">6</span>, [<span class="number">7</span>, <span class="number">8</span>]]]];</span><br><span class="line">arr3.flat(<span class="literal">Infinity</span>); </span><br><span class="line"><span class="comment">// [1, 2, 3, 4, 5, 6, 7, 8]</span></span><br></pre></td></tr></table></figure>

<p>flatè¿˜ä¼šç§»é™¤æ•°ç»„ç©ºé¡¹</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> arr4 = [<span class="number">1</span>, <span class="number">2</span>, , <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line">arr4.flat(); <span class="comment">// [1, 2, 4, 5]</span></span><br></pre></td></tr></table></figure>

<p>2 å­—ç¬¦ä¸²<br>å»å¤´å»å°¾ï¼š String.prototype.trimStart() å’Œ String.prototype.trimEnd() åˆ›å»ºæ–°å­—ç¬¦ä¸²ï¼Œä¸ä¿®æ”¹åŸå­—ç¬¦ä¸²</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> test = <span class="string">&quot; hello &quot;</span>;</span><br><span class="line"></span><br><span class="line">test.trim(); <span class="comment">// &quot;hello&quot;;</span></span><br><span class="line">test.trimStart(); <span class="comment">// &quot;hello &quot;;</span></span><br><span class="line">test.trimEnd(); <span class="comment">// &quot; hello&quot;;</span></span><br></pre></td></tr></table></figure>


<p>3 å¯¹è±¡<br>Object.fromEntries() æ•°ç»„è½¬å¯¹è±¡<br>ä¸ä¹‹ç›¸å¯¹åº”çš„æ˜¯Object.entries() å¯¹è±¡è½¬æ•°ç»„</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123; <span class="attr">prop1</span>: <span class="number">2</span>, <span class="attr">prop2</span>: <span class="number">10</span>, <span class="attr">prop3</span>: <span class="number">15</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è½¬åŒ–ä¸ºé”®å€¼å¯¹æ•°ç»„ï¼š</span></span><br><span class="line"><span class="keyword">let</span> array = <span class="built_in">Object</span>.entries(obj); </span><br><span class="line"><span class="comment">// [[&quot;prop1&quot;, 2], [&quot;prop2&quot;, 10], [&quot;prop3&quot;, 15]]</span></span><br><span class="line"></span><br><span class="line">array = array.map(<span class="function">(<span class="params">[key, value]</span>) =&gt;</span> [key, <span class="built_in">Math</span>.pow(value, <span class="number">2</span>)]); </span><br><span class="line"><span class="comment">// [[&quot;prop1&quot;, 4], [&quot;prop2&quot;, 100], [&quot;prop3&quot;, 225]]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> newObj = <span class="built_in">Object</span>.fromEntries(array); </span><br><span class="line"><span class="comment">// &#123;prop1: 4, prop2: 100, prop3: 225&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å‚è€ƒï¼š<br><a href="https://github.com/sisterAn/blog/issues/47">ç“¶å­å›çš„blog</a></p>
]]></content>
      <tags>
        <tag>ES JS</tag>
      </tags>
  </entry>
  <entry>
    <title>H5-insertAdjacentElement</title>
    <url>/2019/03/11/H5-insertAdjacentElement/</url>
    <content><![CDATA[<h6 id="insertAdjacentElementä½œç”¨æ˜¯ï¼Ÿ"><a href="#insertAdjacentElementä½œç”¨æ˜¯ï¼Ÿ" class="headerlink" title="insertAdjacentElementä½œç”¨æ˜¯ï¼Ÿ"></a>insertAdjacentElementä½œç”¨æ˜¯ï¼Ÿ</h6><p>è¯¥æ–¹æ³•å°†ä¸€ä¸ªç»™å®šçš„å…ƒç´ èŠ‚ç‚¹<code>æ’å…¥åˆ°</code><em>ç›¸å¯¹äºè¢«è°ƒç”¨çš„å…ƒç´ </em>çš„ç»™å®šçš„<code>ä¸€ä¸ªä½ç½®</code>ã€‚</p>
<h6 id="å¦‚ä½•ç”¨å‘¢ï¼Ÿ"><a href="#å¦‚ä½•ç”¨å‘¢ï¼Ÿ" class="headerlink" title="å¦‚ä½•ç”¨å‘¢ï¼Ÿ"></a>å¦‚ä½•ç”¨å‘¢ï¼Ÿ</h6><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">element1.insertAdjacentElement(position, element2);</span><br></pre></td></tr></table></figure>
<p>å‚æ•°positon:</p>
<ul>
<li><code>beforebegin</code>: åœ¨è¯¥å…ƒç´ æœ¬èº«çš„å‰é¢.</li>
<li><code>afterbegin</code>:åªåœ¨è¯¥å…ƒç´ å½“ä¸­, åœ¨è¯¥å…ƒç´ ç¬¬ä¸€ä¸ªå­å­©å­å‰é¢.</li>
<li><code>beforeend</code>:åªåœ¨è¯¥å…ƒç´ å½“ä¸­, åœ¨è¯¥å…ƒç´ æœ€åä¸€ä¸ªå­å­©å­åé¢.</li>
<li><code>afterend</code>: åœ¨è¯¥å…ƒç´ æœ¬èº«çš„åé¢.</li>
</ul>
<p>element1ï¼šä¸åŠ¨çš„å…ƒç´ <br>element2ï¼šè¢«æ’å…¥çš„å…ƒç´ </p>
<h6 id="å…·ä½“ä¾‹å­"><a href="#å…·ä½“ä¾‹å­" class="headerlink" title="å…·ä½“ä¾‹å­"></a>å…·ä½“ä¾‹å­</h6><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> fileWrap = <span class="built_in">document</span>.querySelector(<span class="string">`#<span class="subst">$&#123;<span class="built_in">this</span>.fileWrapId&#125;</span>`</span>);</span><br><span class="line">fileWrap.insertAdjacentElement(<span class="string">&#x27;afterbegin&#x27;</span>, elem); <span class="comment">// elemä¸ºæ’å…¥çš„å…ƒç´ </span></span><br></pre></td></tr></table></figure>

<h6 id="å‚è€ƒé“¾æ¥ï¼š"><a href="#å‚è€ƒé“¾æ¥ï¼š" class="headerlink" title="å‚è€ƒé“¾æ¥ï¼š"></a>å‚è€ƒé“¾æ¥ï¼š</h6><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Element/insertAdjacentElement">mdn</a></p>
]]></content>
      <tags>
        <tag>H5</tag>
      </tags>
  </entry>
  <entry>
    <title>HTMLé¢è¯•å‡†å¤‡</title>
    <url>/2020/04/12/HTML_review/</url>
    <content><![CDATA[<h4 id="1-å¦‚ä½•ç†è§£HTMLè¯­ä¹‰åŒ–"><a href="#1-å¦‚ä½•ç†è§£HTMLè¯­ä¹‰åŒ–" class="headerlink" title="1. å¦‚ä½•ç†è§£HTMLè¯­ä¹‰åŒ–"></a>1. å¦‚ä½•ç†è§£HTMLè¯­ä¹‰åŒ–</h4><p>ä¹‹æ‰€ä»¥å°½å¯èƒ½ç”¨<strong>è´´è¿‘åº”ç”¨åœºæ™¯</strong>çš„æ ‡ç­¾</p>
<ul>
<li>èƒ½è®©<strong>å¼€å‘è€…</strong>ä¸€ç›®äº†ç„¶å±‚çº§å…³ç³»ï¼Œå¢åŠ ä»£ç å¯è¯»æ€§ã€‚</li>
<li>èƒ½è®©<strong>æœç´¢å¼•æ“ğŸ”</strong>æ›´å¥½çš„è¯†åˆ«ï¼ˆ<strong>SEO</strong>ï¼‰ã€‚</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/jonnzer/saveImgForYun@master/test1/%E8%AF%AD%E4%B9%89%E5%8C%96.jpeg" alt="è¯­ä¹‰åŒ–"></p>
<h4 id="2-å—çº§å…ƒç´ å’Œå†…è”å…ƒç´ "><a href="#2-å—çº§å…ƒç´ å’Œå†…è”å…ƒç´ " class="headerlink" title="2. å—çº§å…ƒç´ å’Œå†…è”å…ƒç´ "></a>2. å—çº§å…ƒç´ å’Œå†…è”å…ƒç´ </h4><pre><code>å—çº§ï¼šdisplay: block / table ï¼› æœ‰ div h1 h2 table ul ol pç­‰ï¼›
å†…è”ï¼šdisplay: inline / inline-block; æœ‰ span img input buttonç­‰ï¼›
</code></pre>
]]></content>
      <tags>
        <tag>é¢è¯•</tag>
      </tags>
  </entry>
  <entry>
    <title>JSæ‰§è¡Œé¡ºåº || EventLoop</title>
    <url>/2019/12/03/JS%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F/</url>
    <content><![CDATA[<h3 id="1-EventLoop"><a href="#1-EventLoop" class="headerlink" title="1.EventLoop"></a>1.EventLoop</h3><p>EventLoopå°±æ˜¯é‚£åªçœ‹ä¸è§çš„æ‰‹ï¼Œç”±å®ƒä¸»å®°ç€JSçš„ä¸€åˆ‡æ‰§è¡Œã€‚<br>JSçš„å¼‚æ­¥ä»£ç ï¼Œé‡åˆ°æ—¶ä¼šè¢«æ”¾ç½®åœ¨ä¸€ä¸ªå°åœˆå­é‡Œï¼Œå½“æŠŠåŒæ­¥ä»£ç æ‰§è¡Œå®Œï¼Œå°±ä»è¿™åœˆå­é‡Œå–å‡ºæ¥å¼‚æ­¥ä»£ç æ‰§è¡Œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;script start&#x27;</span>);</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// ç½®åº•è¿›ç¨‹</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;from setTimeout&#x27;</span>);</span><br><span class="line">&#125;,<span class="number">0</span>)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;script end&#x27;</span>);</span><br><span class="line"><span class="comment">// æ‰§è¡Œé¡ºåºï¼šscript start =&gt; script end =&gt; from setTimeout</span></span><br></pre></td></tr></table></figure>

<h3 id="2-å¾®ä»»åŠ¡-amp-amp-å®ä»»åŠ¡"><a href="#2-å¾®ä»»åŠ¡-amp-amp-å®ä»»åŠ¡" class="headerlink" title="2.å¾®ä»»åŠ¡ &amp;&amp; å®ä»»åŠ¡"></a>2.å¾®ä»»åŠ¡ &amp;&amp; å®ä»»åŠ¡</h3><p>ä¼˜å…ˆçº§ï¼šåŒæ­¥ä»£ç  &gt; å¾®ä»»åŠ¡ &gt; å®ä»»åŠ¡ &gt; å¼‚æ­¥ä»£ç <br>å®ä»»åŠ¡ï¼šscript , setTimeout, setInterval, setImmediate, i/0 , UI rendering ,requestAnimationFrame<br>å¾®ä»»åŠ¡ï¼šprocess.nextTick, promise, Object.observe, MutationObserver,await</p>
<ul>
<li>new Promise(fn) // ä¹Ÿå±äºå¾®ä»»åŠ¡ï¼Œæ‰§è¡Œä¼˜å…ˆçº§é«˜</li>
<li>ä¸”process.nextTickä¼˜å…ˆçº§å¤§äºpromise.then</li>
<li>awaitåçš„asyncçš„fn ä¹Ÿä¼šç«‹åˆ»æ‰§è¡Œ å› ä¸ºè¿™æ˜¯ä¸€ä¸ªpromiseè¿”å›</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;1&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// setTimeout1</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;2&#x27;</span>);</span><br><span class="line">    process.nextTick(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// process2</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;3&#x27;</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve</span>) </span>&#123; <span class="comment">// promise2</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;4&#x27;</span>);</span><br><span class="line">        resolve();</span><br><span class="line">    &#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// then2</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;5&#x27;</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line">process.nextTick(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// process1</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;6&#x27;</span>);</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;7&#x27;</span>); <span class="comment">// new Promiseç«‹å³æ‰§è¡Œ</span></span><br><span class="line">    resolve();</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// then1</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;8&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// setTimeout2</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;9&#x27;</span>);</span><br><span class="line">    process.nextTick(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// process3</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;10&#x27;</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve</span>) </span>&#123; <span class="comment">// promise3</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;11&#x27;</span>);</span><br><span class="line">        resolve();</span><br><span class="line">    &#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// then3</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;12&#x27;</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¾“å‡ºé¡ºåº ï¼š</span></span><br><span class="line"><span class="comment">// ç¬¬ä¸€æ­¥ï¼š</span></span><br><span class="line"><span class="comment">// </span></span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œå®Œ 1 å’Œ 7åï¼Œç°åœ¨çœ‹ä¸‹ï¼Œèº«è¾¹æœ‰è¿™äº›ä»»åŠ¡</p>
<table>
<thead>
<tr>
<th>å®ä»»åŠ¡Event</th>
<th align="center">å¾®ä»»åŠ¡Event Queue</th>
</tr>
</thead>
<tbody><tr>
<td>setTimeout1</td>
<td align="center">process1</td>
</tr>
<tr>
<td>setTimeout2</td>
<td align="center">then1</td>
</tr>
</tbody></table>
<p>ç°åœ¨ç¬¬ä¸€è½®çš„ä¸»çº¿è·‘å®Œäº†ï¼Œè½®åˆ°ç¬¬ä¸€è½®çš„å¾®ä»»åŠ¡äº†ï¼Œ<br>æ‰€ä»¥ï¼Œæ¥ä¸‹æ¥æ‰§è¡Œçš„æ˜¯process1å’Œthen1ï¼Œä¹Ÿå°±æ˜¯<br>1ï¼Œ7ï¼Œ6ï¼Œ8ï¼Œ </p>
<p>ç¬¬ä¸€è½®ç»“æŸï¼Œ<br>ç¬¬äºŒè½®å¼€å§‹ã€‚</p>
<p>æ¥ä¸‹æ¥æ˜¯å¼€å¯æ–°çš„ä¸€è½®eventLoopã€‚å¼€å§‹æŸ¥è¯¢åˆ°æ–°çš„å®ä»»åŠ¡setTimeout1ï¼›</p>
<table>
<thead>
<tr>
<th>å®ä»»åŠ¡Event</th>
<th align="center">å¾®ä»»åŠ¡Event Queue</th>
</tr>
</thead>
<tbody><tr>
<td>setTimeout1</td>
<td align="center">process2</td>
</tr>
<tr>
<td>setTimeout2</td>
<td align="center">then2</td>
</tr>
<tr>
<td></td>
<td align="center"></td>
</tr>
<tr>
<td>1ï¼Œ7ï¼Œ6ï¼Œ8ï¼Œ2ï¼Œ4ï¼Œ3ï¼Œ5</td>
<td align="center"></td>
</tr>
</tbody></table>
<p>è¿™ä¸‹å¥½äº†ï¼ŒsetTimeout1å®ä»»åŠ¡å®Œæˆäº†ã€‚<br>æ¥ä¸‹æ¥ï¼Œå°±å‰©setTimeout2å®ä»»åŠ¡ã€‚</p>
<table>
<thead>
<tr>
<th>å®ä»»åŠ¡Event</th>
<th align="center">å¾®ä»»åŠ¡Event Queue</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td align="center">process3</td>
</tr>
<tr>
<td>setTimeout2</td>
<td align="center">then3</td>
</tr>
</tbody></table>
<p>1ï¼Œ7ï¼Œ6ï¼Œ8ï¼Œ2ï¼Œ4ï¼Œ3ï¼Œ5ï¼Œ9ï¼Œ11ï¼Œ10ï¼Œ12</p>
<h3 id="3-Vueçš„nextTick"><a href="#3-Vueçš„nextTick" class="headerlink" title="3. Vueçš„nextTick"></a>3. Vueçš„nextTick</h3><blockquote>
<p>å¼‚æ­¥æ›´æ–°å†…éƒ¨æ˜¯æœ€é‡è¦çš„å°±æ˜¯nextTickæ–¹æ³•ï¼Œå®ƒè´Ÿè´£å°†å¼‚æ­¥ä»»åŠ¡åŠ å…¥é˜Ÿåˆ—å’Œæ‰§è¡Œå¼‚æ­¥ä»»åŠ¡ã€‚<br>VUE  ä¹Ÿå°†å®ƒæš´éœ²å‡ºæ¥æä¾›ç»™ç”¨æˆ·ä½¿ç”¨ã€‚åœ¨æ•°æ®ä¿®æ”¹å®Œæˆåï¼Œç«‹å³è·å–ç›¸å…³DOMè¿˜æ²¡é‚£ä¹ˆå¿«æ›´æ–°ï¼Œä½¿ç”¨nextTickä¾¿å¯ä»¥è§£å†³è¿™ä¸€é—®é¢˜ã€‚</p>
</blockquote>
<blockquote>
<p>watcher:æ¯ä¸ªç›‘è§†è€…éƒ½æœ‰ä»–ä»¬è‡ªå·±çš„idï¼Œå½“æ²¡æœ‰è®°å½•åˆ°å¯¹åº”çš„ç›‘è§†è€….<br>å³ç¬¬ä¸€æ¬¡è¿›å…¥é€»è¾‘ï¼Œå¦åˆ™æ˜¯é‡å¤çš„ç›‘è§†è€…ï¼Œåˆ™ä¸ä¼šè¿›å…¥ã€‚è¿™ä¸€æ­¥å°±æ˜¯å®ç°ç›‘è§†è€…å»é‡çš„ç‚¹ã€‚</p>
</blockquote>
<blockquote>
<p>new Promise &gt; MutationObserver &gt; setImmediate &gt; setTimeout</p>
</blockquote>
<blockquote>
<p>å¼‚æ­¥é˜Ÿåˆ—æ›´æ–°domå’Œæ•°æ®ï¼Œæ‰§è¡Œcallbackå›è°ƒ</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;input v-<span class="keyword">if</span>=<span class="string">&quot;show&quot;</span> type=<span class="string">&quot;text&quot;</span> ref=<span class="string">&quot;myInput&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// js</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">data</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="attr">show</span>: <span class="literal">false</span>,</span><br><span class="line">&#125;,</span><br><span class="line"><span class="function"><span class="title">mounted</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.show = <span class="literal">true</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">this</span>.$refs.myInput.focus() <span class="comment">// error</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">this</span>.$nextTick(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// è·å–domçš„æ›´æ–°ï¼ŒæˆåŠŸæ‰§è¡Œ</span></span><br><span class="line">        <span class="built_in">this</span>.$refs.myInput.focus()</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;,</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>å‚è€ƒé“¾æ¥ï¼š<br><a href="https://juejin.im/post/5aa8a07cf265da238a3022a4">æ˜é‡‘</a><br><a href="https://juejin.im/post/59e85eebf265da430d571f89">æ˜é‡‘2</a><br><a href="https://segmentfault.com/a/1190000019494012">segment</a><br><a href="cxymsg.com/guide/eventLoop.html#%E5%89%8D%E8%A8%80">blog</a><br><a href="https://segmentfault.com/a/1190000015057278">promise async await</a><br><a href="https://github.com/answershuto/learnVue/blob/master/docs/Vue.js%E5%BC%82%E6%AD%A5%E6%9B%B4%E6%96%B0DOM%E7%AD%96%E7%95%A5%E5%8F%8AnextTick.MarkDown#nexttick">vue nextTickåŸç†</a></p>
]]></content>
      <tags>
        <tag>JSåŸç†</tag>
      </tags>
  </entry>
  <entry>
    <title>JSæ¨¡å—åŒ–</title>
    <url>/2020/01/04/JS%E6%A8%A1%E5%9D%97%E5%8C%96/</url>
    <content><![CDATA[<blockquote>
<p>æ¨¡å—åŒ–çš„ç®€å•åŒ…è£…</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="built_in">module</span> = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// åˆ©ç”¨äº†è‡ªæ‰§è¡Œå‡½æ•°çš„å°é—­æ€§</span></span><br><span class="line">    <span class="keyword">var</span> _count = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> m1 = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        alert(_count)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> m2 = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        alert(_count + <span class="number">1</span>)</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">m1</span>: m1,</span><br><span class="line">        <span class="attr">m2</span>: m2</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure>


<h3 id="1-JSæ¨¡å—åŒ–å‘å±•å†å²"><a href="#1-JSæ¨¡å—åŒ–å‘å±•å†å²" class="headerlink" title="1 JSæ¨¡å—åŒ–å‘å±•å†å²"></a>1 JSæ¨¡å—åŒ–å‘å±•å†å²</h3><ul>
<li>CommonJS å’Œ AMD CMD é¼è¶³ä¹‹åŠ¿ ï¼ˆå‰ï¼‰ ES6 ï¼ˆåï¼‰<br>ï¼ˆçŸ¥åæ¡†æ¶ Node.jsã€RequireJSå‰ç½®åŠ è½½ å’Œ Seajså°±è¿‘åŠ è½½ åˆ†åˆ«å¯¹åº”å‰ä¸‰ä¸ªï¼‰</li>
<li>è°ˆè°ˆç°é˜¶æ®µï¼š<ul>
<li>ES6æ ‡å‡†å‘å¸ƒåï¼Œmoduleæˆä¸ºæ ‡å‡†ï¼Œæ ‡å‡†ä½¿ç”¨æ˜¯ä»¥<code>export</code>æŒ‡ä»¤å¯¼å‡ºæ¥å£ï¼Œä»¥<code>import</code>å¼•å…¥æ¨¡å—ã€‚</li>
<li>åœ¨æˆ‘ä»¬ä¸€è´¯çš„nodeæ¨¡å—ä¸­ï¼Œæˆ‘ä»¬ä¾ç„¶é‡‡ç”¨çš„æ˜¯<code>CommonJS</code>è§„èŒƒï¼Œä½¿ç”¨<code>require</code>å¼•å…¥æ¨¡å—ï¼Œä½¿ç”¨<code>module.exports</code>å¯¼å‡ºæ¥å£ã€‚æ˜¯<code>åŒæ­¥</code>åŠ è½½ JS è„šæœ¬ã€‚è¿™ä¹ˆåšåœ¨æœåŠ¡ç«¯æ¯«æ— é—®é¢˜ï¼Œå› ä¸ºæ–‡ä»¶éƒ½å­˜åœ¨ç£ç›˜ä¸Šï¼Œç„¶è€Œæµè§ˆå™¨çš„ç‰¹æ€§å†³å®šäº† JS è„šæœ¬éœ€è¦å¼‚æ­¥åŠ è½½ï¼Œå¦åˆ™å°±ä¼šå¤±å»å“åº”ï¼Œå› æ­¤ CommonJS è§„èŒƒ<code>æ— æ³•ç›´æ¥åœ¨æµè§ˆå™¨</code>ä¸­ä½¿ç”¨ã€‚</li>
</ul>
</li>
</ul>
<h3 id="2-å¯¹äºes6æ¨¡å—çš„çœ‹æ³•ï¼ˆå‚è€ƒé˜®ä¸€å³°è€å¸ˆï¼‰"><a href="#2-å¯¹äºes6æ¨¡å—çš„çœ‹æ³•ï¼ˆå‚è€ƒé˜®ä¸€å³°è€å¸ˆï¼‰" class="headerlink" title="2 å¯¹äºes6æ¨¡å—çš„çœ‹æ³•ï¼ˆå‚è€ƒé˜®ä¸€å³°è€å¸ˆï¼‰"></a>2 å¯¹äºes6æ¨¡å—çš„çœ‹æ³•ï¼ˆå‚è€ƒé˜®ä¸€å³°è€å¸ˆï¼‰</h3><ul>
<li><p><code>es6æ ‡å‡†</code>å°†æˆä¸ºæœåŠ¡å™¨å’Œæµè§ˆå™¨ç«¯æ¨¡å—åŒ–çš„<code>é€šç”¨è§£å†³æ–¹æ³•</code> </p>
</li>
<li><p><code>è¿è¡Œæ—¶åŠ è½½</code>ï¼šä»£ç è¿è¡Œåˆ°è¿™ä¸ªè¯­å¥çš„æ—¶å€™æ‰ä¼šåŠ è½½ </p>
</li>
<li><p><code>ç¼–è¯‘æ—¶åŠ è½½</code>ï¼šæ‰“åŒ…å·¥å…·ç¼–è¯‘jsæ—¶ï¼Œå°±ä¼šå»åˆ†ææ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œæ‰€ä»¥ä¸èƒ½æ”¾åœ¨ä»»ä½•æ¡ä»¶ä»£ç å—é‡Œã€‚å±‚çº§æœ€ä¼˜å…ˆ</p>
</li>
<li><p>es6æ¨¡å—ä¸­çš„thisæŒ‡å‘æ˜¯undefinedï¼Œä¸è¦è½»æ˜“ç”¨this, CommonJsä¸­çš„thisæŒ‡å‘å½“å‰æ¨¡å—</p>
</li>
<li><p>exportçš„ä½¿ç”¨ï¼Œå¦‚æœéœ€å¯¼å‡ºçš„æ¨¡å—å‰é¢æ²¡æœ‰exportï¼Œé‚£åœ¨exportçš„æ—¶å€™å°±è¦åŠ ä¸Š{}</p>
  <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="keyword">export</span> &#123;fn&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>exportå¯¼å‡ºè¯­å¥æ˜¯åŠ¨æ€ç»‘å®šçš„ï¼Œå¦‚æœå¯¼å‡ºçš„å€¼å‘ç”Ÿå˜åŒ–ï¼Œé‚£importè¿›çš„å€¼ä¹Ÿä¼šéšä¹‹å˜åŒ–</p>
  <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// exportJs</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">var</span> foo = <span class="string">&#x27;bar&#x27;</span>;</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; () =&gt; foo = <span class="string">&#x27;baz&#x27;</span>; &#125;,<span class="number">500</span>);</span><br><span class="line"></span><br><span class="line">é‚£ä¹ˆfooå˜é‡å€¼å°†åœ¨500msåå˜æˆbazå­—ç¬¦ä¸²ï¼Œè¿™ç‚¹ä¸<span class="string">`commonJS`</span>ä¸ä¸€æ ·ï¼ŒcommonJsæ˜¯ä¼šç¼“å­˜å€¼ã€‚</span><br></pre></td></tr></table></figure></li>
<li><p><code>import</code>å‘½ä»¤å…·æœ‰æå‡æ•ˆæœï¼Œä¼šæå‡åˆ°æ•´ä¸ªæ¨¡å—çš„å¤´éƒ¨å¹¶é¦–å…ˆæ‰§è¡Œï¼Œä½†è¿˜æ˜¯å»ºè®®æ”¾åœ¨å¤´éƒ¨å†™æ¯”è¾ƒå¥½ã€‚</p>
  <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">foo();</span><br><span class="line"><span class="keyword">import</span> &#123;foo&#125; <span class="keyword">from</span> <span class="string">&#x27;module&#x27;</span>; <span class="comment">// right </span></span><br></pre></td></tr></table></figure></li>
<li><p>*å·æŒ‡å®šæ•´ä½“è¾“å‡ºçš„ä¸€ä¸ªå¯¹è±¡</p>
  <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// circle.js</span></span><br><span class="line"><span class="keyword">export</span> funciton <span class="function"><span class="title">fn1</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">fn2</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// main.js éœ€è¦å¼•å…¥cilcle.js</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> circle <span class="keyword">from</span> <span class="string">&#x27;./circle&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è°ƒç”¨ï¼š</span></span><br><span class="line">circle.fn1();</span><br><span class="line">circle.fn2();</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p>export çš„defaultè¾“å‡ºï¼Œé»˜è®¤è¾“å‡º</p>
  <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// exportJs</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;foo&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// importJs</span></span><br><span class="line"><span class="keyword">import</span> customFn <span class="keyword">from</span> <span class="string">&#x27;./exportJS&#x27;</span></span><br><span class="line">customFn();</span><br></pre></td></tr></table></figure></li>
<li><p>importå‡½æ•°å¤§æ‹¬å·çš„å†™æ³•æ—¶æœº<br>exportåé¢æ¥ç€defaultçš„æ—¶å€™ï¼Œä¸ç”¨å¤§æ‹¬å·ï¼Œæ²¡æ¥ç€çš„æ—¶å€™æ˜¯è¦å¤§æ‹¬å·çš„ã€‚</p>
  <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ—  default</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">fn1</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="keyword">import</span> &#123; fn1&#125; <span class="keyword">from</span> <span class="string">&#x27;exportJs&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æœ‰default</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">fn2</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="keyword">import</span> fn2 <span class="keyword">from</span> <span class="string">&#x27;exportJs&#x27;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>å› ä¸ºé™æ€åˆ†ææ²¡æœ‰è¿è¡Œæ—¶åŠ è½½é‚£ä¹ˆâ€œåŠ¨æ€åŒ–â€ï¼Œæ‰€ä»¥ï¼Œimportæœ‰ä¸ªææ¡ˆï¼Œç›®å‰å¯ä»¥åœ¨webpackä½¿ç”¨ï¼Œå¯ä»¥åŠ¨æ€è¾“å…¥ä¸€ä¸ªè¾ƒä¸ºç‹­çª„çš„è·¯å¾„ï¼Œç„¶åè¿”å›ä¸€ä¸ªpromiseå¯¹è±¡<br>è¿™ä¸ªæƒ…å†µä¸‹çš„importæ˜¯æ”¯æŒ<code>æŒ‰éœ€åŠ è½½</code>ï¼Œ<code>æ¡ä»¶åŠ è½½</code>ï¼Œå’Œ<code>åŠ¨æ€çš„æ¨¡å—è·¯å¾„</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> main = <span class="built_in">document</span>.querySelector(<span class="string">&#x27;main&#x27;</span>)</span><br><span class="line"><span class="keyword">import</span>(<span class="string">&#x27;./someModule/$&#123;someVariable&#125;.js&#x27;</span>)</span><br><span class="line">    .then(<span class="function"><span class="params">module</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">module</span>.loadPageInfo(main)</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">        mian.textContent = err.message;                                                 </span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure></li>
<li><p>scriptæ ‡ç­¾çš„deferå’Œasyncå±æ€§å·®å¼‚ï¼Œä¸¤è€…éƒ½æ˜¯å–æ¶ˆäº†jsçš„åŒæ­¥å±æ€§ã€‚<br>ä½†æ˜¯deferæ˜¯<code>æ¸²æŸ“å®Œå†æ‰§è¡Œ</code>ï¼Œè€Œasyncæ˜¯<code>ä¸‹è½½å®Œå°±æ‰§è¡Œ</code>ã€‚</p>
</li>
<li><p>å¾…éªŒè¯ï¼šes6æ¨¡å—åœ¨ç½‘é¡µä¸Šçš„åŠ è½½</p>
  <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;script type=<span class="string">&quot;module&quot;</span>&gt;</span><br><span class="line">    <span class="keyword">import</span> utils <span class="keyword">from</span> <span class="string">&#x27;./util.js&#x27;</span>;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></li>
<li><p>es6æ¨¡å—ï¼Œå¯¼å‡ºçš„å˜é‡ä¸å¯ä»¥é‡æ–°èµ‹å€¼ï¼Œä½†å¯ä»¥æ·»åŠ æˆ–ä¿®æ”¹å±æ€§ï¼Œå°±æ˜¯å†…å­˜åœ°å€ä¸èƒ½æ”¹ï¼Œé‡Œé¢å­˜çš„å†…å®¹éšä½ æ”¹ï¼Œå¾…éªŒè¯ã€‚</p>
  <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// lib.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">let</span> obj = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; obj &#125; <span class="keyword">from</span> <span class="string">&#x27;lib&#x27;</span></span><br><span class="line"></span><br><span class="line">obj.prop = <span class="number">123</span>; <span class="comment">// right</span></span><br><span class="line">obj = &#123;&#125;        <span class="comment">// typeError</span></span><br></pre></td></tr></table></figure></li>
<li><p>ä½¿ç”¨<code>import</code>å‘½ä»¤åŠ è½½<code>commonJS</code>æ¨¡å—ï¼ŒNodeä¼šè‡ªåŠ¨å°†<code>module.exports</code>å½“æˆæ¨¡å—çš„é»˜è®¤è¾“å‡ºï¼Œå³ç­‰åŒäº<code>export default</code></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// b.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// es.js</span></span><br><span class="line"><span class="keyword">import</span> foo <span class="keyword">from</span> <span class="string">&#x27;./b.js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> bar <span class="keyword">from</span> <span class="string">&#x27;./b.js&#x27;</span></span><br><span class="line"><span class="comment">// bar = &#123;default: null&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; somethimg &#125; <span class="keyword">from</span> <span class="string">&#x27;fs&#x27;</span> <span class="comment">// errorï¼ï¼ï¼</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> express <span class="keyword">from</span> <span class="string">&#x27;express&#x27;</span></span><br><span class="line"><span class="keyword">const</span> app = express.default() <span class="comment">// right</span></span><br></pre></td></tr></table></figure></li>
<li><p><code>commonJs</code>çš„åŠ è½½åŸç†<br>commonJsæ¯ä¸ªæ¨¡å—éƒ½æ˜¯ä¸€ä¸ªè„šæœ¬æ–‡ä»¶ï¼ŒNodeå†…éƒ¨ç”¨requireå‘½ä»¤ç¬¬ä¸€æ¬¡åŠ è½½å°±ä¼šæ‰§è¡Œè¿™ä¸ªè„šæœ¬ï¼Œç„¶ç”Ÿæˆä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªä¼šç¼“å­˜ï¼Œå³æ˜¯å¤šæ¬¡requireï¼Œä¸æ¸…ç¼“å­˜ä¸‹ï¼Œéƒ½å–ç¬¬ä¸€æ¬¡ã€‚</p>
  <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">id</span>: <span class="string">&#x27;&#x27;</span>,         <span class="comment">// æ¨¡å—å</span></span><br><span class="line">    <span class="attr">exports</span>: &#123;&#125;,    <span class="comment">// å¯¼å‡ºæ¨¡å—, </span></span><br><span class="line">    <span class="attr">loaded</span>: <span class="literal">true</span>    <span class="comment">// æ˜¯å¦åŠ è½½è¿‡</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>å¾ªç¯åŠ è½½ï¼šæ¨¡å—ä¹‹é—´ç›¸äº’å¼•ç”¨<br>CommonJsä¼šå‡ºç°ï¼Œè¾“å‡ºå·²æ‰§è¡Œçš„éƒ¨åˆ†ï¼Œæœªæ‰§è¡Œçš„éƒ¨åˆ†ä¸ä¼šè¾“å‡º<br>es6æ¨¡å—åˆ™ä¸ä¼šæŠ¥é”™</p>
</li>
</ul>
<p>å‚è€ƒæ–‡ç« ï¼š<br><a href="https://juejin.im/post/58882a42128fe100684ad9de">æ˜é‡‘</a><br>é˜®ä¸€å³°es6 æ¨¡å—ç¯‡ç« </p>
]]></content>
      <tags>
        <tag>æ¨¡å—åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title>MVVMå®ç°ï¼ˆObject.defineProperty &amp;&amp; è§‚å¯Ÿè®¢é˜…ï¼‰</title>
    <url>/2020/07/23/MVVM/</url>
    <content><![CDATA[<h3 id="1-MVVMç‰¹ç‚¹å›¾è§£"><a href="#1-MVVMç‰¹ç‚¹å›¾è§£" class="headerlink" title="1. MVVMç‰¹ç‚¹å›¾è§£"></a>1. MVVMç‰¹ç‚¹å›¾è§£</h3><p><img src="/MVVM/MVVM1.png" alt="MVVMæ³¨è§£å›¾1"><br><img src="/MVVM/MVVM2.png" alt="MVVMæ³¨è§£å›¾2"><br><img src="/MVVM/MVVM3.png" alt="MVVMæ³¨è§£å›¾3"><br><img src="/MVVM/MVVM4.png" alt="MVVMæ³¨è§£å›¾4"><br><img src="/MVVM/MVVM5.png" alt="MVVMæ³¨è§£å›¾5"></p>
<h3 id="2-MVVMçš„åŠŸèƒ½ï¼š"><a href="#2-MVVMçš„åŠŸèƒ½ï¼š" class="headerlink" title="2. MVVMçš„åŠŸèƒ½ï¼š"></a>2. MVVMçš„åŠŸèƒ½ï¼š</h3><ul>
<li>ç»™æ‰€æœ‰dataå±æ€§å€¼éƒ½è®¾ç½®æ•°æ®åŠ«æŒï¼Œç»‘å®šå¥½å±æ€§è§‚å¯Ÿã€‚ï¼ˆ<em>ä¹Ÿæ˜¯æ·±åº¦å“åº”åŸç†</em>ï¼‰</li>
<li>ç»“åˆè§‚å¯Ÿè®¢é˜…è€…æ¨¡å¼</li>
</ul>
<h3 id="3-ä»£ç å®ç°ï¼š-MVVM-åŒ…å«åŒå‘æ•°æ®ç»‘å®šã€v-modelã€computed"><a href="#3-ä»£ç å®ç°ï¼š-MVVM-åŒ…å«åŒå‘æ•°æ®ç»‘å®šã€v-modelã€computed" class="headerlink" title="3.ä»£ç å®ç°ï¼š(MVVM åŒ…å«åŒå‘æ•°æ®ç»‘å®šã€v-modelã€computed)"></a>3.ä»£ç å®ç°ï¼š(<code>MVVM </code>åŒ…å«åŒå‘æ•°æ®ç»‘å®šã€<code>v-model</code>ã€<code>computed</code>)</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * let zs = new Vue(&#123;</span></span><br><span class="line"><span class="comment"> *     el: &#x27;#app&#x27;,</span></span><br><span class="line"><span class="comment"> *     data: &#123;a: 1&#125;</span></span><br><span class="line"><span class="comment"> * &#125;)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param </span>options å‚è€ƒvueå®ä¾‹åŒ–æ—¶ä¼ è¿›çš„å¯¹è±¡,ä»£è¡¨æˆ‘ä»¬å­˜å‚¨çš„æ‰€æœ‰å¯¹è±¡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">demoVue</span>(<span class="params">options = &#123;&#125;</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.$options = options;  <span class="comment">// å½“å‰å®ä¾‹ï¼Œå­˜å‚¨å­˜è¿›çš„å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">let</span> data = <span class="built_in">this</span>._data = <span class="built_in">this</span>.$options.data;  <span class="comment">// å½“å‰å®ä¾‹ï¼Œå­˜å‚¨options.data å‡†å¤‡åƒvueä¸€æ ·è§‚å¯Ÿæ•°æ®</span></span><br><span class="line">    observe(data);</span><br><span class="line">    <span class="comment">// ä¸ºäº†ä»£ç†_dataå±æ€§ã€‚å¯ä»¥ç›´æ¥åœ¨å®ä¾‹çš„æ—¶å€™å–åˆ°dataï¼Œå†ç”¨defineä¸€æ¬¡</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> data) &#123;</span><br><span class="line">        <span class="built_in">Object</span>.defineProperty(<span class="built_in">this</span>,key,&#123;</span><br><span class="line">            <span class="attr">enumerable</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="function"><span class="title">get</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">this</span>._data[key]; <span class="comment">// å°†this._data.key é€šè¿‡å®šä¹‰å¯¹è±¡çš„æ–¹å¼ èµ‹ç»™äº† this.keyï¼Œæ¨¡æ‹Ÿvue</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="function"><span class="title">set</span>(<span class="params">newVal</span>)</span> &#123;</span><br><span class="line">                <span class="built_in">this</span>._data[key] = newVal;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> computed = <span class="built_in">this</span>.$options.computed;</span><br><span class="line">    operatedComputed.call(<span class="built_in">this</span>)  <span class="comment">// computedde çš„æ“ä½œéœ€æ”¾åœ¨æ•°æ®éƒ½å·²è¢«è§‚å¯Ÿå®Œï¼Œå¹¶æŒ‚è½½åˆ°_dataé‡Œ</span></span><br><span class="line">   </span><br><span class="line">    <span class="keyword">new</span> Compile(options.el, <span class="built_in">this</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">operatedComputed</span>(<span class="params"></span>) </span>&#123; <span class="comment">// computed å¤„ç†å‡½æ•°</span></span><br><span class="line">    <span class="keyword">let</span> vm = <span class="built_in">this</span></span><br><span class="line">    <span class="keyword">let</span> computedFn = <span class="built_in">this</span>.$options.computed</span><br><span class="line">    <span class="built_in">Object</span>.keys(computedFn).forEach(<span class="function"><span class="keyword">function</span>(<span class="params">key</span>)</span>&#123;</span><br><span class="line">        <span class="comment">// computedæŒ‚è½½åˆ°vmä¸Š</span></span><br><span class="line">        <span class="built_in">Object</span>.defineProperty(vm,key,&#123;</span><br><span class="line">            <span class="attr">get</span>: <span class="keyword">typeof</span> computedFn[key] === <span class="string">&#x27;function&#x27;</span> ?  computedFn[key] : computedFn[key].get,</span><br><span class="line">            <span class="function"><span class="title">set</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">observe</span>(<span class="params">data</span>) </span>&#123; <span class="comment">// æ•°æ®åŠ«æŒï¼Œå¢åŠ Object.defineProperty</span></span><br><span class="line">     <span class="keyword">if</span> (<span class="keyword">typeof</span> data !== <span class="string">&#x27;object&#x27;</span>) <span class="keyword">return</span>;</span><br><span class="line">     <span class="keyword">return</span> <span class="keyword">new</span> Observe(data); <span class="comment">// æ–¹ä¾¿é€’å½’</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æŠŠæ•°æ®ç¼–è¯‘åˆ°domä¸Šï¼Œå®ç°æ•°æ®ç»‘å®š</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param </span>el æ›¿æ¢çš„dom</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param </span>vm å®ä¾‹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@constructor</span></span></span><br><span class="line"><span class="comment"> * note:</span></span><br><span class="line"><span class="comment"> * (1) æ–‡æ¡£ç¢ç‰‡</span></span><br><span class="line"><span class="comment"> * (2) regExp.$n: --[https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/RegExp/n]</span></span><br><span class="line"><span class="comment"> * (3)æ­£åˆ™å›¾å½¢åŒ– https://regexper.com/</span></span><br><span class="line"><span class="comment"> * (4)æ­£åˆ™å¯¹ç…§è¡¨ï¼šhttp://tool.oschina.net/uploads/apidocs/jquery/regexp.html</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Compile</span>(<span class="params">el, vm</span>) </span>&#123;</span><br><span class="line">    vm.$el = <span class="built_in">document</span>.querySelector(el);</span><br><span class="line">    <span class="keyword">let</span> fragment = <span class="built_in">document</span>.createDocumentFragment(); <span class="comment">// ä¹‹æ‰€ä»¥ç”¨äº†æ–‡æ¡£ç¢ç‰‡ï¼Œæ˜¯å› ä¸ºè¿™æ ·é€ æˆé¡µé¢æ¸²æŸ“å›æµçš„ä»£ä»·æœ€ä½</span></span><br><span class="line">    <span class="keyword">let</span> child;</span><br><span class="line">    <span class="comment">// æ­¤å¤„ç”¨åˆ°äº†appendChildçš„ä¸€ä¸ªç‰¹æ€§ï¼šå¯¹äºè¢«æ·»åŠ çš„å­èŠ‚ç‚¹ï¼Œå¦‚æœä¹‹å‰å·²ç»å­˜åœ¨ï¼Œåˆ™ä¼šé”€æ¯è‡ªå·±åœ¨domæ ‘çš„èŠ‚ç‚¹ï¼Œç„¶åæŠŠè‡ªå·±æ·»åŠ åˆ°æ–°çš„åœ°æ–¹</span></span><br><span class="line">    <span class="comment">// å› æ­¤vm.$el.firstChildæ‰ä¼šä¸åœåœ°åˆ‡æ¢æˆä¸‹ä¸€ä¸ªå­èŠ‚ç‚¹ã€‚</span></span><br><span class="line">    <span class="comment">// --[https://developer.mozilla.org/zh-CN/docs/Web/API/Node/appendChild]</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (child = vm.$el.firstChild) &#123;</span><br><span class="line">        fragment.appendChild(child);</span><br><span class="line">    &#125;</span><br><span class="line">    replace(fragment);</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Array.from å°†ä¼ªæ•°ç»„å¯¹è±¡è½¬ä¸ºæ•°ç»„å®ä¾‹</span></span><br><span class="line"><span class="comment">      textContext: èŠ‚ç‚¹å†…å®¹</span></span><br><span class="line"><span class="comment">      èŠ‚ç‚¹ç±»å‹ --[https://developer.mozilla.org/zh-CN/docs/Web/API/Node/nodeType] nodeTypeä¸º3æ—¶ï¼Œæ˜¯elementæˆ–è€…å±æ€§ä¸­çš„å­—</span></span><br><span class="line"><span class="comment">      ä¹‹æ‰€ä»¥æŠ½ç¦»å‡ºæ–¹æ³•ï¼Œæ˜¯å› ä¸ºæƒ³è¦é‡å¤è°ƒç”¨ï¼Œå½“å­èŠ‚ç‚¹é‡Œè¿˜æœ‰å­èŠ‚ç‚¹æ—¶ï¼Œå¯ä»¥è°ƒç”¨ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">replace</span>(<span class="params">fragment</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">Array</span>.from(fragment.childNodes).forEach(<span class="function"><span class="keyword">function</span> (<span class="params">node</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">let</span> text = node.textContent;</span><br><span class="line">            <span class="keyword">let</span> exp;</span><br><span class="line">            <span class="keyword">let</span> reg = <span class="regexp">/\&#123;\&#123;(.*)\&#125;\&#125;/</span>;</span><br><span class="line">            <span class="keyword">if</span> (node.nodeType === <span class="number">3</span> &amp;&amp; reg.test(text)) &#123;</span><br><span class="line">               exp = text.replace(reg, <span class="string">&#x27;$1&#x27;</span>); <span class="comment">// æ­£åˆ™åŒ¹é…ä¸­ç¬¬ä¸€ä¸ªæ‹¬å·æ‰€ä»£è¡¨çš„å†…å®¹</span></span><br><span class="line">                <span class="keyword">let</span> pointArr = exp.split(<span class="string">&#x27;.&#x27;</span>); <span class="comment">// a.a b</span></span><br><span class="line">                <span class="keyword">let</span> existVal = vm;</span><br><span class="line">                pointArr.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">key</span>) </span>&#123; <span class="comment">// vm.a.a  vm.b</span></span><br><span class="line">                    existVal = existVal[key];</span><br><span class="line">                &#125;);</span><br><span class="line">                <span class="comment">// æ·»åŠ ä¸€ä¸ªwatcheräº‹ä»¶ ç›‘å¬äº†å€¼çš„å˜åŒ–</span></span><br><span class="line">                <span class="keyword">new</span> Watcher(vm,exp,<span class="function"><span class="keyword">function</span> (<span class="params">newVal</span>) </span>&#123;</span><br><span class="line">                    node.textContent = text.replace(reg, newVal);</span><br><span class="line">                &#125;);</span><br><span class="line">                 <span class="comment">// @todoæ­¤å¤„parseræœ‰å¾…å®Œå–„ï¼Œåªèƒ½å…¼å®¹çº¯&#123;&#123;&#125;&#125;ï¼Œå¸¦ä¸Šå…¶ä»–å­—ç¬¦ä¼šè®©existValå¤±æ•ˆ</span></span><br><span class="line">                node.textContent = text.replace(reg, existVal);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (node.nodeType === <span class="number">1</span> ) &#123; <span class="comment">// v-modelå®ç°</span></span><br><span class="line">                <span class="keyword">let</span> attr = <span class="built_in">Array</span>.from(node.attributes)</span><br><span class="line">                <span class="keyword">let</span> attr_value;</span><br><span class="line">                attr.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">item</span>)</span>&#123;</span><br><span class="line">                    <span class="keyword">if</span> (item.name === <span class="string">&#x27;v-model&#x27;</span>) &#123;</span><br><span class="line">                        attr_value = item.value</span><br><span class="line">                        <span class="keyword">new</span> Watcher(vm,attr_value, <span class="function"><span class="keyword">function</span>(<span class="params">newVal</span>) </span>&#123;</span><br><span class="line">                            node.value = newVal</span><br><span class="line">                        &#125;)</span><br><span class="line">                        node.addEventListener(<span class="string">&#x27;input&#x27;</span>,<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">                            vm[attr_value] = e.target.value</span><br><span class="line">                        &#125;)  </span><br><span class="line">                    &#125;</span><br><span class="line">                   </span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (node.childNodes) &#123;</span><br><span class="line">                replace(node);</span><br><span class="line">            &#125;</span><br><span class="line">            vm.$el.appendChild(fragment); <span class="comment">// æ–‡æ¡£ç¢ç‰‡çš„å†…å®¹é‡æ–°æ·»åŠ åˆ°åŸæ¥æŒ‚è½½çš„å…ƒç´ é‡Œ</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="variable">data</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns <span class="type">&#123;*&#125;</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@constructor</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Observe</span>(<span class="params">data</span>) </span>&#123; <span class="comment">// å®é™…è§‚å¯Ÿæ–¹æ³•,è®¾ç½® Object.defineProperty</span></span><br><span class="line">    <span class="keyword">let</span> dep = <span class="keyword">new</span> Dep();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> data) &#123;</span><br><span class="line">        <span class="keyword">let</span> val = data[key];</span><br><span class="line">        observe(val); <span class="comment">// è¿™é‡Œå°±å·²ç»å¯ä»¥é€’å½’äº†</span></span><br><span class="line">        <span class="built_in">Object</span>.defineProperty(data,key, &#123;</span><br><span class="line">            <span class="attr">enumerable</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="function"><span class="title">get</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">                <span class="comment">// æ­¤æ—¶Dep.targetæ˜¯this</span></span><br><span class="line">                <span class="keyword">if</span> (Dep.target) &#123;</span><br><span class="line">                    dep.addSub(Dep.target); <span class="comment">// æ·»åŠ äº‹ä»¶è®¢é˜…ï¼ˆwatcher çš„ pushï¼‰</span></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> val;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="function"><span class="title">set</span>(<span class="params">newVal</span>)</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (newVal ===  val) &#123; <span class="comment">// å€¼æ²¡å‘ç”Ÿå˜åŒ–</span></span><br><span class="line">                    <span class="keyword">return</span>; </span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    val = newVal; <span class="comment">// æ›´æ–°å€¼ã€‚getè·å–å€¼æ—¶ï¼Œä¹Ÿå¯ä»¥å¾—åˆ°æœ€æ–°çš„å€¼ã€‚</span></span><br><span class="line">                    observe(newVal); <span class="comment">// è¿™é‡Œæ˜¯ä¸ºäº†ç»™æ–°å€¼ä¹Ÿæ·»ä¸Šè§‚å¯Ÿè€…</span></span><br><span class="line">                    dep.notify(); <span class="comment">// æ·»åŠ äº‹ä»¶çš„é€šçŸ¥æ›´æ–°ï¼ˆwatcherçš„updateï¼‰</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å‘å¸ƒè®¢é˜…å‡½æ•°</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Dep</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Dep</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.subs = []; <span class="comment">// äº‹ä»¶æ± </span></span><br><span class="line">&#125;</span><br><span class="line">Dep.prototype.addSub = <span class="function"><span class="keyword">function</span> (<span class="params">sub</span>) </span>&#123; <span class="comment">// è®¢é˜…</span></span><br><span class="line">    <span class="built_in">this</span>.subs.push(sub);</span><br><span class="line">&#125;;</span><br><span class="line">Dep.prototype.notify = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="comment">// é€šçŸ¥</span></span><br><span class="line">    <span class="built_in">this</span>.subs.forEach(<span class="function"><span class="params">sub</span> =&gt;</span> &#123;</span><br><span class="line">        sub.update();</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * äº‹ä»¶æ± å…¶ä¸­çš„ä¸€ä¸ª</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param </span>vm: å®ä¾‹ç¯å¢ƒï¼ˆæ€»çš„æ•°æ®æ¥æºï¼‰</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param </span>æ­£åˆ™è¡¨è¾¾å¼çš„éå†å¯¹è±¡exp (è¦æ›´æ”¹çš„å¯¹è±¡)</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param </span>fnï¼ˆå¤„ç†çš„å›è°ƒå‡½æ•°ï¼‰</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@constructor</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Watcher</span>(<span class="params">vm,exp,fn</span>) </span>&#123; <span class="comment">// fnæ˜¯å›è°ƒå‡½æ•° newçš„æ—¶å€™ä¼ è¿›æ¥</span></span><br><span class="line">    <span class="built_in">this</span>.vm = vm;</span><br><span class="line">    <span class="built_in">this</span>.exp = exp;</span><br><span class="line">    <span class="built_in">this</span>.fn = fn;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ·»åŠ åˆ°è®¢é˜…ä¸­</span></span><br><span class="line">    <span class="comment">// Dep.target ??? æ‰®æ¼”ç€ä¸€ä¸ªwatcherå¯¹è±¡ï¼Œä¹Ÿæ˜¯Watcherçš„å®ä¾‹  å®ƒå’Œ Object.definePropertyçš„getä¼šæœ‰ååº”</span></span><br><span class="line">    Dep.target = <span class="built_in">this</span>;</span><br><span class="line">    <span class="keyword">let</span> val = vm;</span><br><span class="line">    <span class="keyword">let</span> arr = exp.split(<span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">    arr.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">k</span>) </span>&#123; <span class="comment">// è¿™é‡Œè·å– this.a.aæ—¶è¿˜æ˜¯ä¼šè§¦å‘åˆ°é»˜è®¤çš„getter</span></span><br><span class="line">        val = val[k];</span><br><span class="line">    &#125;);</span><br><span class="line">    Dep.target = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">Watcher.prototype.update = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="comment">// watcherçš„æ›´æ–°æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">let</span> val = <span class="built_in">this</span>.vm;</span><br><span class="line">    <span class="keyword">let</span> arr = <span class="built_in">this</span>.exp.split(<span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">    arr.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">k</span>) </span>&#123;</span><br><span class="line">        val = val[k];</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">this</span>.fn(val); <span class="comment">// æŠŠæœ€æ–°å€¼ä¼ è¿›callback</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123;a.a&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123;b&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;b&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123;cacultate_c&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--&lt;script src=&quot;../dist/my_bundle.js&quot;&gt;&lt;/script&gt;--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./compile.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// è°ƒç”¨</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> little = <span class="keyword">new</span> demoVue(&#123;</span></span><br><span class="line"><span class="javascript">        <span class="attr">el</span>: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line"><span class="javascript">        <span class="attr">data</span>: &#123;</span></span><br><span class="line"><span class="javascript">            <span class="attr">a</span>: &#123;<span class="attr">a</span>:<span class="string">&quot;æ˜¯a&quot;</span>&#125;,</span></span><br><span class="line"><span class="javascript">            <span class="attr">b</span>: <span class="string">&quot;æ˜¯b&quot;</span></span></span><br><span class="line"><span class="javascript">        &#125;,</span></span><br><span class="line"><span class="javascript">        <span class="attr">computed</span>: &#123;</span></span><br><span class="line"><span class="javascript">            <span class="attr">cacultate_c</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">return</span> <span class="built_in">this</span>.a.a + <span class="built_in">this</span>.b;</span></span><br><span class="line"><span class="javascript">            &#125;,</span></span><br><span class="line"><span class="javascript">            <span class="attr">cacultate_d</span>: &#123;</span></span><br><span class="line"><span class="javascript">                <span class="function"><span class="title">get</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">                    <span class="keyword">return</span> <span class="built_in">this</span>.a.a + <span class="built_in">this</span>.b + <span class="built_in">this</span>.b</span></span><br><span class="line"><span class="javascript">                &#125;,</span></span><br><span class="line"><span class="javascript">                <span class="function"><span class="title">set</span>(<span class="params">val</span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">                    <span class="built_in">this</span>.a = val</span></span><br><span class="line"><span class="javascript">                &#125;</span></span><br><span class="line"><span class="javascript">            &#125;</span></span><br><span class="line"><span class="javascript">        &#125;</span></span><br><span class="line"><span class="javascript">    &#125;);</span></span><br><span class="line"><span class="javascript"></span></span><br></pre></td></tr></table></figure>


<hr>
<h3 id="çŸ¥è¯†å‚¨å¤‡"><a href="#çŸ¥è¯†å‚¨å¤‡" class="headerlink" title="çŸ¥è¯†å‚¨å¤‡"></a>çŸ¥è¯†å‚¨å¤‡</h3><p>1ã€ <code>Object.defineProperty</code> ç»™å¯¹è±¡è®¾ç½®æŸå±æ€§ï¼Œå¹¶ä¸”å¯ä»¥è®¾ç½®setterï¼Œç”¨äºç»‘å®šå±æ€§ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;&#125;</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(obj, <span class="string">&#x27;school&#x27;</span>,&#123;</span><br><span class="line">    <span class="attr">configurable</span>: <span class="literal">true</span>, <span class="comment">// è®© delete æ›´æ–°å±æ€§å€¼ ç”Ÿæ•ˆ</span></span><br><span class="line">    <span class="attr">enumberable</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="function"><span class="title">get</span>(<span class="params"></span>)</span>&#123; <span class="comment">// å–å€¼</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">123</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">set</span>(<span class="params">val</span>)</span>&#123; <span class="comment">// è®¾ç½®å€¼æ—¶è§¦å‘</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;setting &#x27;</span>)</span><br><span class="line">        obj.school = val <span class="comment">// è¶…å‡ºå†…å­˜ mag size</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(obj)</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h4><p><a href="https://juejin.im/post/5e7410ed51882549087dc365#heading-0">æ˜é‡‘ - MVVM</a><br><a href="https://blog.csdn.net/hf872914334/article/details/88899326">å‘å¸ƒè®¢é˜…æ¨¡å¼ &amp;&amp; è§‚å¯Ÿè€…æ¨¡å¼</a><br><a href="https://zhuanlan.zhihu.com/p/51357583">å‘å¸ƒè®¢é˜…æ¨¡å¼ &amp;&amp; è§‚å¯Ÿè€…æ¨¡å¼</a><br><a href="https://segmentfault.com/a/1190000019700618">Vue2.0å“åº”åŸç†</a></p>
]]></content>
      <tags>
        <tag>MVVM æ¡†æ¶</tag>
      </tags>
  </entry>
  <entry>
    <title>PWA</title>
    <url>/2020/02/06/PWA/</url>
    <content><![CDATA[<h3 id="1-PWAæ˜¯ä»€ä¹ˆï¼Ÿï¼ˆProgressive-Web-Appï¼‰"><a href="#1-PWAæ˜¯ä»€ä¹ˆï¼Ÿï¼ˆProgressive-Web-Appï¼‰" class="headerlink" title="1.PWAæ˜¯ä»€ä¹ˆï¼Ÿï¼ˆProgressive Web Appï¼‰"></a>1.PWAæ˜¯ä»€ä¹ˆï¼Ÿï¼ˆ<code>Progressive Web App</code>ï¼‰</h3><p>ä¹¦é¢ä¸Šæ„æ€ï¼šæ¸è¿›å¼ç½‘ç»œåº”ç”¨<br>ç‰¹ç‚¹ï¼š</p>
<ul>
<li>ç¨³å®šï¼šä¸å¥½çš„ç½‘ç»œç¯å¢ƒä¸‹ä¹Ÿæœ‰å¥½çš„å±•ç°æ•°æ®èƒ½åŠ›ï¼ˆ<code>service worker</code>ï¼‰</li>
<li>è¿‡æ¸¡è‡ªç„¶çš„åŠ¨ç”»äº¤äº’ï¼Œè‰¯å¥½çš„æ»šåŠ¨ï¼Œå“åº”å¿«</li>
<li>åƒåŸç”Ÿä¸€èˆ¬ä¸æ»‘ï¼Œå¯ä»¥æ¨é€ï¼Œå¯å®‰è£…</li>
<li>androidæ”¯æŒåº¦å¥½ï¼Œappleæ”¯æŒåº¦å·®</li>
</ul>
<h3 id="1-1-å…³é”®æŠ€æœ¯"><a href="#1-1-å…³é”®æŠ€æœ¯" class="headerlink" title="1.1 å…³é”®æŠ€æœ¯"></a>1.1 å…³é”®æŠ€æœ¯</h3><ul>
<li>service worker : ä¸€ä¸ªå­˜åœ¨äºå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„ä»£ç†ï¼Œå¯ä»¥æ§åˆ¶ç¼“å­˜å’Œåº”å¯¹èµ„æºè¯·æ±‚,é¢„ç¼“å­˜å…³é”®èµ„æºã€‚æ‰€ä»¥å®ƒå¯¹å®‰å…¨çš„è¦æ±‚ä¹Ÿå¾ˆé«˜ï¼Œéœ€è¦åœ¨Httpsç¯å¢ƒä¸‹è¿è¡Œã€‚</li>
<li>manifest: ï¼ˆå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªå¯è®¾ç½®çš„å…¥å£æ–‡ä»¶ï¼‰<br>â€‹              èƒ½å¤Ÿå°†ä½ æµè§ˆçš„ç½‘é¡µæ·»åŠ åˆ°ä½ çš„æ‰‹æœºå±å¹•ä¸Š<br>â€‹              åœ¨ Android ä¸Šèƒ½å¤Ÿå…¨å±å¯åŠ¨ï¼Œä¸æ˜¾ç¤ºåœ°å€æ  ï¼ˆ ç”±äº Iphone æ‰‹æœºçš„æµè§ˆå™¨æ˜¯ Safari ï¼Œæ‰€ä»¥ä¸æ”¯æŒå“¦ï¼‰<br>â€‹              æ§åˆ¶å±å¹• æ¨ªå± / ç«–å± å±•ç¤º<br>â€‹              å®šä¹‰å¯åŠ¨ç”»é¢<br>â€‹              å¯ä»¥è®¾ç½®ä½ çš„åº”ç”¨å¯åŠ¨æ˜¯ä»ä¸»å±å¹•å¯åŠ¨è¿˜æ˜¯ä» URL å¯åŠ¨<br>â€‹              å¯ä»¥è®¾ç½®ä½ æ·»åŠ å±å¹•ä¸Šçš„åº”ç”¨ç¨‹åºå›¾æ ‡ã€åå­—ã€å›¾æ ‡å¤§å°</li>
</ul>
<h3 id="2-å¯ä»¥ç”¨æ¥å¹²å˜›å‘¢"><a href="#2-å¯ä»¥ç”¨æ¥å¹²å˜›å‘¢" class="headerlink" title="2.å¯ä»¥ç”¨æ¥å¹²å˜›å‘¢"></a>2.å¯ä»¥ç”¨æ¥å¹²å˜›å‘¢</h3><ul>
<li>æ¨é€ï¼Œè¿™ç‚¹éœ€è¦å®‰å“å»éªŒè¯ï¼Œç›®å‰PWAçš„æ”¯æŒåº¦ä»…æ˜¯å®‰å“æ¯”è¾ƒå¥½ã€‚iosçš„googleæµè§ˆå™¨ä¹Ÿä¸æ”¯æŒ</li>
<li>ç¦»çº¿ç¼“å­˜ã€‚ å¯ä»¥è®¾ç½®ç¼“å­˜çš„èµ„æºï¼Œå³ä½¿ç¦»çº¿ä¹Ÿå¯ä»¥è®¿é—®</li>
</ul>
<h3 id="3-DEMO"><a href="#3-DEMO" class="headerlink" title="3. DEMO"></a>3. DEMO</h3><p>demoå·²æ”¾åœ¨mineScriptæ–‡ä»¶å¤¹ä¸‹<br>githubåœ°å€æ˜¯ï¼š<a href="https://github.com/jonnzer/good_snippet/tree/master/PWA">demo</a></p>
<ul>
<li>ä»£ç ç»“æ„ï¼š</li>
</ul>
<ul>
<li>sw.js: å¼•å…¥serviceWorker.jsï¼Œå®šä¹‰ç¼“å­˜èµ„æºï¼Œéƒ¨ç½²æ•´ä¸ªswçš„ç”Ÿå‘½å‘¨æœŸä»£ç </li>
<li>manifest.json: ä¸€ä¸ªå®šä¹‰å¥½èƒŒæ™¯é¢œè‰²ï¼Œå±•ç¤ºå›¾ç‰‡ï¼Œiconï¼Œçš„å…¥å£æ–‡ä»¶ã€‚</li>
<li>å»ºè®®éƒ¨ç½²åœ¨httpsç¯å¢ƒä¸‹çš„cdnã€‚</li>
</ul>
<p>å‚è€ƒé“¾æ¥ï¼š<br><a href="https://developers.google.com/web/progressive-web-apps/">å®˜ç½‘</a><br><a href="https://juejin.im/post/5ae2f82f6fb9a07acd4d761e">æ˜é‡‘1</a><br><a href="https://www.villainhr.com/page/2017/01/08/Service%20Worker%20%E5%85%A8%E9%9D%A2%E8%BF%9B%E9%98%B6">serviceWorkerçš„è°ƒè¯•</a></p>
]]></content>
      <tags>
        <tag>å·¥å…·</tag>
      </tags>
  </entry>
  <entry>
    <title>apolloä¸»é¢˜å¢åŠ Valineè¯„è®º</title>
    <url>/2020/07/11/apollo%E4%B8%BB%E9%A2%98%E5%A2%9E%E5%8A%A0Valine%E8%AF%84%E8%AE%BA/</url>
    <content><![CDATA[<h4 id="åˆè¡·"><a href="#åˆè¡·" class="headerlink" title="åˆè¡·"></a>åˆè¡·</h4><p>å¤§é“è‡³ç®€<br>æœ€è¿‘åˆšè¿ç§»ä¸»é¢˜åˆ°<code>Apollo</code>ï¼Œç›¸å½“æ¸…æ–°çš„ä¸»é¢˜ï¼Œå…·ä½“çš„å‚è€ƒ<a href="https://github.com/pinggod/hexo-theme-apollo">github</a></p>
<h4 id="è¯„è®ºç³»ç»Ÿçš„é€‰æ‹©"><a href="#è¯„è®ºç³»ç»Ÿçš„é€‰æ‹©" class="headerlink" title="è¯„è®ºç³»ç»Ÿçš„é€‰æ‹©"></a>è¯„è®ºç³»ç»Ÿçš„é€‰æ‹©</h4><p>ä»æ”¯æŒçš„è¡¨æƒ…ä¸é¢œå€¼ä¸Šæ¥çœ‹ï¼Œæœæ–­é€‰æ‹©äº†<code>Valine</code><br>æ•ˆæœå›¾å¯ä»¥çœ‹åšå®¢ä¸‹æ–¹ğŸ˜Š</p>
<div class="tip">
    å› ä¸ºApolloä¸»é¢˜å·²ç»å…³é—­issueï¼Œæ‰€ä»¥åªèƒ½è‡ªå·±å»å¢åŠ è¯„è®ºçš„åˆå§‹åŒ–ä»£ç äº†
</div> 

<h4 id="é­”æ”¹"><a href="#é­”æ”¹" class="headerlink" title="é­”æ”¹"></a>é­”æ”¹</h4><p>1 <code>themes/apollo/_config.yml</code>:<br>    <figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">valine:</span></span><br><span class="line">    <span class="comment"># å¼€å¯ Valine è¯„è®º</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="comment"># è®¾ç½®åº”ç”¨ id å’Œ key</span></span><br><span class="line">    <span class="attr">appId:</span> <span class="string">æ‚¨çš„appId</span></span><br><span class="line">    <span class="attr">appKey:</span> <span class="string">æ‚¨çš„appkey</span></span><br></pre></td></tr></table></figure><br>2 <code>themes/apollo/source/js/Valine.min.js</code>ï¼š æ‹·è´Valinecdnè·¯å¾„ï¼Œç¼“å­˜åˆ°æœ¬åœ°ï¼Œä»¥é˜²ä¸‡ä¸€<br>3 <code>themes/apollo/layout/partial/head.jade</code>: å¢åŠ å¼•ç”¨<code>script(src=url_for(&quot;js/Valine.min.js&quot;))</code><br>4 <code>themes/apollo/layout/partial/comment.jade</code>: å¢åŠ ä¸»é¢˜çš„è¯„è®ºåˆ¤æ–­<br>     <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> theme.valine</span><br><span class="line">    div#vcomments</span><br><span class="line">    <span class="comment">//script(src=&quot;//unpkg.com/valine/dist/Valine.min.js&quot;)</span></span><br><span class="line">    script.</span><br><span class="line">        <span class="keyword">new</span> Valine(&#123; <span class="comment">// é‡Œé¢çš„å‚æ•°é…ç½®å…·ä½“å‚è€ƒValineå®˜ç½‘</span></span><br><span class="line">            <span class="attr">el</span>: <span class="string">&#x27;#vcomments&#x27;</span>,</span><br><span class="line">            <span class="attr">appId</span>: <span class="string">`#&#123;theme.valine.appId&#125;`</span>,</span><br><span class="line">            <span class="attr">appKey</span>: <span class="string">`#&#123;theme.valine.appKey&#125;`</span>,</span><br><span class="line">            <span class="attr">placeholder</span>: <span class="string">&#x27;å¿«æ¥è¯„è®ºå§(#^.^#)&#x27;</span>,</span><br><span class="line">            <span class="attr">avatar</span>: <span class="string">&#x27;wavatar&#x27;</span></span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure></p>
<hr>
<p>å‚è€ƒ<br><a href="https://www.playpi.org/2019032001.html">Valineå‰åæ‰€éœ€ä»‹ç»</a><br><a href="https://valine.js.org/">Valineå®˜ç½‘</a></p>
]]></content>
      <tags>
        <tag>Apollo Hexo Valine</tag>
      </tags>
  </entry>
  <entry>
    <title>æ•°ç»„å¸¸è§æŠ€å·§</title>
    <url>/2020/05/26/array/</url>
    <content><![CDATA[<h3 id="1-æ•°ç»„é™ç»´"><a href="#1-æ•°ç»„é™ç»´" class="headerlink" title="1. æ•°ç»„é™ç»´"></a>1. æ•°ç»„é™ç»´</h3><p>äºŒç»´æ•°ç»„é™ç»´æˆä¸€ç»´æ•°ç»„ï¼ˆå¼•è‡ªvueæºç ï¼‰</p>
<blockquote>
<p>åˆ©ç”¨åŸç†ï¼š<br>(1) <code>concat</code>çš„å±æ€§ : å¦‚æœconcatæ–¹æ³•çš„å‚æ•°æ˜¯ä¸€ä¸ªå…ƒç´ ï¼Œè¯¥å…ƒç´ ä¼šè¢«ç›´æ¥æ’å…¥åˆ°æ–°æ•°ç»„ä¸­ï¼›å¦‚æœå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè¯¥æ•°ç»„çš„å„ä¸ªå…ƒç´ å°†è¢«æ’å…¥åˆ°æ–°æ•°ç»„ä¸­ï¼›<br>(2) <code>apply</code>çš„ä¼˜åŒ–ï¼š<code>Array.prototype.concat.apply</code>([], children) ç­‰åŒäº [].concat(demoArr)</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> demoArr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,[<span class="number">7</span>,<span class="number">8</span>],[<span class="number">22</span>,<span class="number">23</span>,<span class="number">43</span>]]</span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">simpleNormalizeChildren</span> (<span class="params">children</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; children.length; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">Array</span>.isArray(children[i])) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">Array</span>.prototype.concat.apply([], children)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> children</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">simpleNormalizeChildren(demoArr)  </span><br><span class="line"><span class="comment">// result =&gt;  [1, 2, 3, 4, 5, 7, 8, 22, 23, 43]</span></span><br></pre></td></tr></table></figure>

<h4 id="æ‰©å±•ï¼š"><a href="#æ‰©å±•ï¼š" class="headerlink" title="æ‰©å±•ï¼š"></a>æ‰©å±•ï¼š</h4><p>å¤šç»´æ•°ç»„é€’å½’é™ç»´(å€ŸåŠ©äº†<code>é€’å½’</code>çš„èƒ½åŠ›)</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> children = [<span class="number">1</span>, [<span class="number">2</span>,<span class="number">3</span>], [<span class="number">4</span>, [<span class="number">5</span>, <span class="number">6</span>, [<span class="number">7</span>, <span class="number">8</span>]]], [<span class="number">9</span>, <span class="number">10</span>]];</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">simpleNormalizeChildren</span>(<span class="params">children</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; children.length; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">Array</span>.isArray(children[i])) &#123;</span><br><span class="line">      children = <span class="built_in">Array</span>.prototype.concat.apply([], children);</span><br><span class="line">      <span class="keyword">for</span>(<span class="keyword">let</span> j =<span class="number">0</span>; j&lt;children.length; j++) &#123;</span><br><span class="line">        simpleNormalizeChildren(children)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> children;</span><br><span class="line">&#125;</span><br><span class="line">simpleNormalizeChildren(children); </span><br><span class="line"><span class="comment">// result =&gt;  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</span></span><br></pre></td></tr></table></figure>

<h3 id="2-æ•°ç»„å»é‡"><a href="#2-æ•°ç»„å»é‡" class="headerlink" title="2. æ•°ç»„å»é‡"></a>2. æ•°ç»„å»é‡</h3><p>ï¼ˆ1ï¼‰ ES6 <code>set</code>æ–¹æ³• (Set å¯¹è±¡å…è®¸ä½ å­˜å‚¨ä»»ä½•ç±»å‹çš„å”¯ä¸€å€¼)</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">unique</span> (<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Array</span>.from(<span class="keyword">new</span> <span class="built_in">Set</span>(arr))</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">1</span>,<span class="string">&#x27;true&#x27;</span>,<span class="string">&#x27;true&#x27;</span>,<span class="literal">true</span>,<span class="literal">true</span>,<span class="number">15</span>,<span class="number">15</span>,<span class="literal">false</span>,<span class="literal">false</span>, <span class="literal">undefined</span>,<span class="literal">undefined</span>,</span><br><span class="line"> <span class="literal">null</span>,<span class="literal">null</span>, <span class="literal">NaN</span>, <span class="literal">NaN</span>,<span class="string">&#x27;NaN&#x27;</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;a&#x27;</span>,&#123;&#125;,&#123;&#125;];</span><br><span class="line"><span class="built_in">console</span>.log(unique(arr))</span><br><span class="line">Â <span class="comment">//[1, &quot;true&quot;, true, 15, false, undefined, null, NaN, &quot;NaN&quot;, 0, &quot;a&quot;, &#123;&#125;, &#123;&#125;] </span></span><br></pre></td></tr></table></figure>
<div class="tip">
  setæ–¹æ³•æ— æ³•è¯†åˆ«é‡å¤çš„{}ç©ºå¯¹è±¡
</div> 

<p>ï¼ˆ2ï¼‰åŒé‡forå¾ªç¯ï¼Œspliceå»é‡</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">unique</span>(<span class="params">arr</span>)</span>&#123;            </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;arr.length; i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">var</span> j=i+<span class="number">1</span>; j&lt;arr.length; j++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(arr[i]==arr[j])&#123;         <span class="comment">//å‰è€…ç­‰äºåè€…çš„æ—¶å€™ï¼Œspliceæ–¹æ³•åˆ é™¤åè€…</span></span><br><span class="line">                    arr.splice(j,<span class="number">1</span>);</span><br><span class="line">                    j--; </span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">1</span>,<span class="string">&#x27;true&#x27;</span>,<span class="string">&#x27;true&#x27;</span>,<span class="literal">true</span>,<span class="literal">true</span>,<span class="number">15</span>,<span class="number">15</span>,<span class="literal">false</span>,<span class="literal">false</span>, <span class="literal">undefined</span>,<span class="literal">undefined</span>,</span><br><span class="line">     <span class="literal">null</span>,<span class="literal">null</span>, <span class="literal">NaN</span>, <span class="literal">NaN</span>,<span class="string">&#x27;NaN&#x27;</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;a&#x27;</span>,&#123;&#125;,&#123;&#125;];</span><br><span class="line">    <span class="built_in">console</span>.log(unique(arr))</span><br><span class="line">    <span class="comment">//[1, &quot;true&quot;, 15, false, undefined, NaN, NaN, &quot;NaN&quot;, &quot;a&quot;, &#123;â€¦&#125;, &#123;â€¦&#125;]     </span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<div class="tip">
NaNå’Œ{}æ²¡æœ‰å»é‡ï¼Œä¸¤ä¸ªnullç›´æ¥æ¶ˆå¤±äº†
</div>


<p>(3) indexOfï¼ˆæ–°å»ºäº†ä¸€ä¸ªç©ºæ•°ç»„ï¼Œéå†æ—§æ•°ç»„ï¼Œå¦‚æœç©ºæ•°ç»„é‡Œæ²¡é‡åˆ°é‡å¤çš„éå†é¡¹ï¼Œåˆ™æ·»åŠ ï¼‰ </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">unique</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">Array</span>.isArray(arr)) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;type error!&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> array = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (array.indexOf(arr[i]) === -<span class="number">1</span>) &#123;</span><br><span class="line">            array.push(arr[i])</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> array;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">1</span>,<span class="string">&#x27;true&#x27;</span>,<span class="string">&#x27;true&#x27;</span>,<span class="literal">true</span>,<span class="literal">true</span>,<span class="number">15</span>,<span class="number">15</span>,<span class="literal">false</span>,<span class="literal">false</span>, <span class="literal">undefined</span>,<span class="literal">undefined</span>,</span><br><span class="line">           <span class="literal">null</span>,<span class="literal">null</span>, <span class="literal">NaN</span>, <span class="literal">NaN</span>,<span class="string">&#x27;NaN&#x27;</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;a&#x27;</span>,&#123;&#125;,&#123;&#125;];</span><br><span class="line"><span class="built_in">console</span>.log(unique(arr))</span><br><span class="line">   <span class="comment">// [1, &quot;true&quot;, true, 15, false, undefined, null, NaN, NaN, &quot;NaN&quot;, 0, &quot;a&quot;, &#123;â€¦&#125;, &#123;â€¦&#125;]  </span></span><br></pre></td></tr></table></figure>
<div class="tip">
NaNã€{}æ²¡æœ‰å»é‡</div>

<p>(4) sortæ’åºåå†å»é‡ï¼ˆsortåä¸€æ ·çš„å…ƒç´ çš„ä¼šåœ¨æ—è¾¹ï¼Œåªéœ€ä¸èº«è¾¹çš„å¯¹æ¯”ï¼‰é«˜æ€§èƒ½ï¼Œæ¨èğŸ‘</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">unique</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> seen; <span class="comment">// åŠ¨æ€æŒ‡é’ˆ</span></span><br><span class="line">  <span class="comment">// æµ…æ‹·è´å æ’åºtargetArr æ’åºæœ‰è¦æ±‚çš„è¯ï¼Œéœ€è¦sortä¼ å…¥è‡ªå®šä¹‰çš„æ’åºå‡½æ•°</span></span><br><span class="line">  <span class="keyword">var</span> targetArr = <span class="built_in">Array</span>.prototype.concat.call(arr).sort() </span><br><span class="line">  <span class="keyword">var</span> result = [];</span><br><span class="line">  <span class="comment">// ä¸ä¸Šä¸€ä½å¯¹æ¯” å› ä¸ºindexä¸º0çš„æ—¶å€™æ²¡æœ‰ä¸Šä¸€ä½ï¼Œæ‰€ä»¥ç›´æ¥æ’å…¥ç»“æœæ•°ç»„è¿”å›</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt;targetArr.length; i++) &#123; </span><br><span class="line">     <span class="comment">// è¿™é‡Œ 0è½¬ä¸ºbooleanæ˜¯falseï¼Œ!0å³true</span></span><br><span class="line">    <span class="comment">// è¿™ä¸ªifæ˜¯ï¼Œå¦‚æœæ˜¯ç¬¬ä¸€ä½ï¼Œæˆ–è€…ï¼ŒåŠ¨æ€æŒ‡é’ˆä¸éå†åˆ°çš„ä¸ä¸€æ ·ï¼Œå³æ˜¯åŒ¹é…åˆ°æ–°å…ƒç´ </span></span><br><span class="line">    <span class="keyword">if</span> (!i || seen !== targetArr[i]) &#123;</span><br><span class="line">      result.push(targetArr[i])</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ›´æ–°æŒ‡é’ˆ</span></span><br><span class="line">    seen = targetArr[i]</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// test</span></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">1</span>,<span class="string">&#x27;true&#x27;</span>,<span class="string">&#x27;true&#x27;</span>,<span class="literal">true</span>,<span class="literal">true</span>,<span class="number">15</span>,<span class="number">15</span>,<span class="literal">false</span>,<span class="literal">false</span>, <span class="literal">undefined</span>,<span class="literal">undefined</span>,</span><br><span class="line">         <span class="literal">null</span>,<span class="literal">null</span>, <span class="literal">NaN</span>, <span class="literal">NaN</span>,<span class="string">&#x27;NaN&#x27;</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;a&#x27;</span>,&#123;&#125;,&#123;&#125;];</span><br><span class="line"><span class="built_in">console</span>.log(unique(arr));</span><br></pre></td></tr></table></figure>

<div class="tip">
  sortæ–¹æ³•éœ€è¦æ³¨æ„çœ‹ä½¿ç”¨åœºæ™¯ï¼Œç‰¹æ®Šç±»å‹çš„æ—¶å€™ï¼Œsortä¼šæœ‰å‘ã€‚
</div>

<p>(5) underScore æ€è·¯ç‰ˆ ï¼ˆæä¾›ä¸‰ä¸ªå‚æ•°ï¼‰è¿™ä¸ªæ€è·¯æ‚ç³…ä¸Šé¢çš„æ–¹æ³•<br> <code>array</code>ï¼š å¿…å¡«å‚æ•°ï¼Œå»é‡ç›®æ ‡æ•°ç»„<br><code>isSorted</code>: è¡¨ç¤ºç›®æ ‡æ•°ç»„æ˜¯å¦å·²ç»æ’åºè¿‡äº†ï¼Œtrueçš„è¯ï¼Œå°†ä¼šé‡‡ç”¨æ–¹æ³•ï¼ˆ4ï¼‰é‚£æ ·çš„é«˜æ•ˆå¯¹æ¯”ã€‚falseçš„è¯ï¼Œç”¨indexOf<br><code>iteratee</code>: è‡ªå®šä¹‰å¯¹ç›®æ ‡æ•°ç»„çš„æ“ä½œ</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">unique</span>(<span class="params">array, isSorted, iteratee</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> res = [];</span><br><span class="line">    <span class="keyword">var</span> seen = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = array.length; i &lt; len; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> value = array[i];</span><br><span class="line">        <span class="keyword">var</span> computed = iteratee ? iteratee(value, i, array) : value;</span><br><span class="line">        <span class="keyword">if</span> (isSorted) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!i || seen !== computed) &#123;</span><br><span class="line">                res.push(value)</span><br><span class="line">            &#125;</span><br><span class="line">            seen = computed;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (iteratee) &#123;</span><br><span class="line">            <span class="keyword">if</span> (seen.indexOf(computed) === -<span class="number">1</span>) &#123;</span><br><span class="line">                seen.push(computed);</span><br><span class="line">                res.push(value);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (res.indexOf(value) === -<span class="number">1</span>) &#123;</span><br><span class="line">            res.push(value);</span><br><span class="line">        &#125;        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(unique(array3, <span class="literal">false</span>, <span class="function"><span class="keyword">function</span>(<span class="params">item</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">typeof</span> item == <span class="string">&#x27;string&#x27;</span> ? item.toLowerCase() : item</span><br><span class="line">&#125;)); <span class="comment">// [1, &quot;a&quot;, 2]</span></span><br></pre></td></tr></table></figure>

<p>(6) åˆ©ç”¨Objectçš„keyæ˜¯å”¯ä¸€çš„</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">distinct</span>(<span class="params">array</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> obj = &#123;&#125;;</span><br><span class="line">    <span class="keyword">return</span> array.filter(<span class="function"><span class="keyword">function</span>(<span class="params">item, index, array</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> obj.hasOwnProperty(<span class="keyword">typeof</span> item + item) </span><br><span class="line">        ? <span class="literal">false</span></span><br><span class="line">        : (obj[<span class="keyword">typeof</span> item + item] = <span class="literal">true</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>çœŸæ˜¯å¹ä¸ºè§‚æ­¢ï¼Œå¦™ï¼å¦™åœ¨å“ªï¼Ÿ</p>
<ul>
<li><code>array.filter</code>æœ¬èº«å°±å…¼èŒ<code>éå†ï¼Œè¿‡æ»¤ï¼Œè¿”å›æ–°æ•°ç»„</code>äºä¸€èº«ï¼Œå¹²å‡€åˆ©è½</li>
<li>Objectçš„<code>keyç¡®å®æ˜¯å”¯ä¸€</code>çš„ï¼Œå¦‚æœé‡å¤æ—¶å€™ï¼Œåªèƒ½æ˜¯è¦†ç›–valueçš„</li>
<li>filterè¿‡æ»¤æ¡ä»¶éœ€è¦çš„<code>trueå’Œfalse</code>å°±ç”± Objæ˜¯å¦åŒ…å«è¿™ä¸ª<code>type+value</code>ä¸ºkey  æ¥å†³å®šï¼Œ<br>å¦‚æœä¹‹å‰æ²¡å­˜è¿›objï¼Œå¯ä»¥ä»»æ„è®¾ç½®ä¸€ä¸ªvalueï¼Œå°±æ˜¯ä¸‰å…ƒè¿ç®—ç¬¦é‡Œçš„<code>obj[typeof item + item] = true</code></li>
</ul>
<hr>
<h3 id="APIè¡¥å……ï¼š"><a href="#APIè¡¥å……ï¼š" class="headerlink" title="APIè¡¥å……ï¼š"></a>APIè¡¥å……ï¼š</h3><ol>
<li><code>reduce</code></li>
</ol>
<p>å‡åºè®©æ•°ç»„æ¯ä¸€é¡¹éƒ½è°ƒç”¨ä¼ å…¥å‡½æ•°ï¼Œå¯ä»¥è®¾ç½®åˆå§‹å€¼ã€‚<br>å››ä¸ªå‚æ•°<br><code>Accumulator</code> (acc) (ç´¯è®¡å™¨)<br><code>Current Value</code> (cur) (å½“å‰å€¼)<br><code>Current Index</code> (idx) (å½“å‰ç´¢å¼•)<br><code>Source Array </code>(src) (æºæ•°ç»„)</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">arr.reduce(callback(accumulator, currentValue[, index[, array]])[, initialValue])<span class="string">``</span><span class="string">`</span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>javascript</span><br><span class="line"><span class="comment">// ç»Ÿè®¡å‡ºç°æ¬¡æ•°</span></span><br><span class="line"><span class="keyword">var</span> names = [<span class="string">&#x27;Alice&#x27;</span>, <span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Tiff&#x27;</span>, <span class="string">&#x27;Bruce&#x27;</span>, <span class="string">&#x27;Alice&#x27;</span>];</span><br><span class="line"><span class="comment">// allNamesä¸ºAccumulatorç´¯ç§¯å™¨ï¼Œnameä¸ºå½“å‰å€¼</span></span><br><span class="line"><span class="keyword">var</span> countedNames = names.reduce(<span class="function"><span class="keyword">function</span> (<span class="params">allNames, name</span>) </span>&#123; </span><br><span class="line">  <span class="keyword">if</span> (name <span class="keyword">in</span> allNames) &#123;</span><br><span class="line">    allNames[name]++;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    allNames[name] = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> allNames;</span><br><span class="line">&#125;, &#123;&#125;);</span><br><span class="line"><span class="comment">// countedNames is:</span></span><br><span class="line"><span class="comment">// &#123; &#x27;Alice&#x27;: 2, &#x27;Bob&#x27;: 1, &#x27;Tiff&#x27;: 1, &#x27;Bruce&#x27;: 1 &#125;</span></span><br></pre></td></tr></table></figure>


<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> pipe = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">// proxyç»“åˆreduceå®ç° é“¾å¼è°ƒç”¨å‡½æ•°å°è£… éœ€æ˜¯getç»“å°¾</span></span><br><span class="line">      <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123; <span class="comment">// valueæ˜¯å‚æ•° é—­åŒ…ç¼“å­˜funcStackæ•°ç»„</span></span><br><span class="line">          <span class="keyword">var</span> funcStack = [];</span><br><span class="line">          <span class="keyword">var</span> oproxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(&#123;&#125; , &#123;</span><br><span class="line">              <span class="attr">get</span> : <span class="function"><span class="keyword">function</span> (<span class="params">pipeObject, fnName</span>) </span>&#123;</span><br><span class="line">                  <span class="built_in">console</span>.log(<span class="string">&#x27;fnName is:&#x27;</span> + fnName)</span><br><span class="line">                  <span class="keyword">if</span> (fnName === <span class="string">&#x27;get&#x27;</span>) &#123;</span><br><span class="line">                      <span class="keyword">return</span> funcStack.reduce(<span class="function"><span class="keyword">function</span> (<span class="params">val, fn</span>) </span>&#123;</span><br><span class="line">                          <span class="keyword">return</span> fn(val);</span><br><span class="line">                      &#125;,value);</span><br><span class="line">                  &#125;</span><br><span class="line">                  funcStack.push(<span class="built_in">window</span>[fnName]);</span><br><span class="line">                  <span class="built_in">console</span>.log(funcStack)</span><br><span class="line">                  <span class="keyword">return</span> oproxy;</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;);</span><br><span class="line">          <span class="keyword">return</span> oproxy;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;());</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> double = <span class="function"><span class="params">n</span> =&gt;</span> n * <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">var</span> pow    = <span class="function"><span class="params">n</span> =&gt;</span> n * n;</span><br><span class="line">  <span class="keyword">var</span> reverseInt = <span class="function"><span class="params">n</span> =&gt;</span> n.toString().split(<span class="string">&quot;&quot;</span>).reverse().join(<span class="string">&quot;&quot;</span>) | <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(pipe(<span class="number">3</span>)[<span class="string">&#x27;double&#x27;</span>].pow.get);</span><br><span class="line">  <span class="comment">// pipe(3).double.pow.reverseInt.get; // 63 </span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li><p><code>slice</code><br>ç±»æ•°ç»„ =&gt; çœŸæ•°ç»„</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">list</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ä¹Ÿå¯ä»¥å†™æˆ [].slice.call(arguments) </span></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> list1 = list(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>); <span class="comment">// [1, 2, 3]</span></span><br></pre></td></tr></table></figure></li>
<li><p><code>Array.from</code><br>ä»ä¸€ä¸ªç±»ä¼¼æ•°ç»„æˆ–å¯è¿­ä»£å¯¹è±¡åˆ›å»ºä¸€ä¸ªæ–°çš„ï¼Œ<code>æµ…æ‹·è´</code>çš„æ•°ç»„å®ä¾‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Array</span>.from(arrayLike[, mapFn[, thisArg]])</span><br></pre></td></tr></table></figure>
<p><code>arrayLike</code>ï¼šæƒ³è¦è½¬æ¢æˆæ•°ç»„çš„ä¼ªæ•°ç»„å¯¹è±¡æˆ–å¯è¿­ä»£å¯¹è±¡ã€‚æ¯”å¦‚æ‹¥æœ‰ä¸€ä¸ª length å±æ€§å’Œè‹¥å¹²ç´¢å¼•å±æ€§çš„ä»»æ„å¯¹è±¡å’ŒMapã€setç­‰ã€‚<br><code>mapFn</code> å¯é€‰ï¼šå¦‚æœæŒ‡å®šäº†è¯¥å‚æ•°ï¼Œæ–°æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ä¼šæ‰§è¡Œè¯¥å›è°ƒå‡½æ•°ã€‚<br><code>thisArg</code> å¯é€‰ï¼šå¯é€‰å‚æ•°ï¼Œæ‰§è¡Œå›è°ƒå‡½æ•° mapFn æ—¶ this å¯¹è±¡ã€‚</p>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> someNumbers = &#123; <span class="string">&#x27;0&#x27;</span>: <span class="number">10</span>, <span class="string">&#x27;1&#x27;</span>: <span class="number">15</span>, <span class="attr">length</span>: <span class="number">2</span> &#125;;</span><br><span class="line"><span class="built_in">Array</span>.from(someNumbers, <span class="function"><span class="params">value</span> =&gt;</span> value * <span class="number">2</span>); <span class="comment">// =&gt; [20, 30] è¿™é‡Œåˆ©ç”¨äº†mapFnçš„èƒ½åŠ›</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sumArguments</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Array</span>.from(<span class="built_in">arguments</span>).reduce(<span class="function">(<span class="params">sum, num</span>) =&gt;</span> sum + num);</span><br><span class="line">&#125;</span><br><span class="line">sumArguments(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>); <span class="comment">// =&gt; 6 //è¿™é‡Œåˆ©ç”¨äº†è½¬åŒ–ä¼ªæ•°ç»„æˆçœŸæ•°ç»„çš„èƒ½åŠ›</span></span><br></pre></td></tr></table></figure>

<ol start="4">
<li><p><code>Array.concat()</code> ä¸ä¼ å‚æ•°çš„æ—¶å€™ï¼Œæ˜¯ä¸€ç§æµ…æ‹·è´çš„è¡Œä¸º</p>
</li>
<li><p><code>Array.filter(function()&#123;&#125;)</code>  å¦‚åï¼Œfilterï¼Œè¿‡æ»¤ï¼Œè¯¥æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„, å…¶åŒ…å«é€šè¿‡æ‰€æä¾›å‡½æ•°å®ç°çš„æµ‹è¯•çš„æ‰€æœ‰å…ƒç´ ã€‚ä¸æ”¹å˜åŸæ•°ç»„</p>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> newArray = arr.filter(callback(element[, index[, array]])[, thisArg])</span><br></pre></td></tr></table></figure>
<p><code>callback</code>: ç”¨æ¥æµ‹è¯•æ•°ç»„å…ƒç´ çš„å‡½æ•° return trueæ—¶ ä¿ç•™å…ƒç´  å¦åˆ™ä¸ä¿ç•™ã€‚<br><code>index</code>: å½“å‰å¤„ç†ç´¢å¼•<br><code>array</code>: è°ƒç”¨äº†filterçš„æ•°ç»„æœ¬èº«</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"> <span class="comment">// åˆ›å»ºäº†ä¸€ä¸ªæ–°æ•°ç»„ï¼Œè¯¥æ•°ç»„çš„å…ƒç´ ç”±åŸæ•°ç»„ä¸­å€¼å¤§äº 10 çš„å…ƒç´ ç»„æˆ</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isBigEnough</span>(<span class="params">element</span>) </span>&#123; </span><br><span class="line">  <span class="keyword">return</span> element &gt;= <span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> filtered = [<span class="number">12</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">130</span>, <span class="number">44</span>].filter(isBigEnough);</span><br></pre></td></tr></table></figure>


<h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/slice">MDN - slice</a><br><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/Reduce">MDN - reduce</a><br><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/typeof">MDN - typeof</a><br><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/from">MDN - Array.from</a><br><a href="https://juejin.im/post/5b4d35406fb9a04fd55ac064">æ˜é‡‘ reduce</a><br><a href="https://juejin.im/post/5d66b019f265da03a715e5d7">æ˜é‡‘ Array.from</a><br><a href="https://www.lagou.com/lgeduarticle/86449.html">æ‹‰é’©åšæ–‡</a><br><a href="https://github.com/mqyqingfeng/Blog/issues/27">å†´ç¾½ Arrayå»é‡ issue</a><br><a href="http://www.ruanyifeng.com/blog/2017/03/reduce_transduce.html">é˜®ä¸€å³° reduce transduce å…³äº å‡½æ•°ç¼–ç¨‹</a></p>
]]></content>
      <tags>
        <tag>Array</tag>
      </tags>
  </entry>
  <entry>
    <title>call &amp;&amp; apply &amp;&amp; bind</title>
    <url>/2020/04/09/call&amp;apply&amp;bind/</url>
    <content><![CDATA[<h4 id="1-apply"><a href="#1-apply" class="headerlink" title="1. apply"></a>1. apply</h4><p>è°ƒç”¨ä¸€ä¸ªå…·æœ‰<code>ç»™å®šthiså€¼</code>çš„å‡½æ•°ï¼Œä»¥åŠ<code>ä½œä¸ºä¸€ä¸ªæ•°ç»„ï¼ˆæˆ–ç±»ä¼¼æ•°ç»„å¯¹è±¡ï¼‰</code>æä¾›çš„å‚æ•°ã€‚<br>è¯­æ³•ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span>.apply(thisArg, [argsArray])</span><br></pre></td></tr></table></figure>

<div class="tip">
        å¦‚æœè¿™ä¸ªå‡½æ•°å¤„äºéä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œ`thisArg`æŒ‡å®šä¸º `null` æˆ– `undefined` æ—¶ä¼šè‡ªåŠ¨æ›¿æ¢ä¸º`æŒ‡å‘å…¨å±€å¯¹è±¡`ï¼ŒåŸå§‹å€¼ä¼šè¢«åŒ…è£…ï¼ï¼ï¼
</div>

<p> åŸºç¡€ç”¨æ³•</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> numbers = [<span class="number">5</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">7</span>];</span><br><span class="line"><span class="keyword">const</span> max = <span class="built_in">Math</span>.max.apply(<span class="literal">null</span>, numbers);</span><br><span class="line"><span class="built_in">console</span>.log(max);<span class="comment">// expected output: 7</span></span><br></pre></td></tr></table></figure>

<p>å°†Aæ•°ç»„é‡Œçš„å…ƒç´ éƒ½æ·»åŠ åˆ°Bæ•°ç»„ ï¼ˆapplyæœ‰ç§<code>å¾ªç¯å‚æ•°æ•°ç»„</code>çš„èƒ½åŠ›ï¼‰</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Array</span>.push.apply(BArray,AArray)</span><br><span class="line"><span class="comment">// ç­‰åŒäº</span></span><br><span class="line">BArray.push(...AArray)</span><br></pre></td></tr></table></figure>

<h4 id="2-call"><a href="#2-call" class="headerlink" title="2. call"></a>2. call</h4><p>è°ƒç”¨ä¸€ä¸ªå…·æœ‰<code>ç»™å®šthiså€¼</code>çš„å‡½æ•°ï¼Œä»¥åŠä¸€ä¸ªæˆ–å¤šä¸ªå‚æ•°ã€‚<br>è¯­æ³•ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span>.call(thisArg, arg1, arg2, ...) </span><br></pre></td></tr></table></figure>

<p>ç”¨æ¥ç»§æ‰¿</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Product</span>(<span class="params">name, price</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.name = name;</span><br><span class="line">  <span class="built_in">this</span>.price = price;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Food</span>(<span class="params">name, price</span>) </span>&#123;</span><br><span class="line">  Product.call(<span class="built_in">this</span>, name, price);</span><br><span class="line">  <span class="built_in">this</span>.category = <span class="string">&#x27;food&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">new</span> Food(<span class="string">&#x27;cheese&#x27;</span>, <span class="number">5</span>).name);</span><br><span class="line"><span class="comment">// expected output: &quot;cheese&quot;</span></span><br></pre></td></tr></table></figure>

<p>ç»‘å®šä¸Šä¸‹æ–‡</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">greet</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> reply = [<span class="built_in">this</span>.animal, <span class="string">&#x27;typically sleep between&#x27;</span>, <span class="built_in">this</span>.sleepDuration].join(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(reply);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  <span class="attr">animal</span>: <span class="string">&#x27;cats&#x27;</span>, <span class="attr">sleepDuration</span>: <span class="string">&#x27;12 and 16 hours&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">greet.call(obj);  <span class="comment">// cats typically sleep between 12 and 16 hours</span></span><br></pre></td></tr></table></figure>

<p>éä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œä¸ä¼ å€¼åˆ™é»˜è®¤ä¸Šä¸‹æ–‡æ˜¯å…¨å±€å¯¹è±¡</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> sData = <span class="string">&#x27;Wisen&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">display</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;sData value is %s &#x27;</span>, <span class="built_in">this</span>.sData);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">display.call();  <span class="comment">// sData value is Wisen   è¿™é‡Œä¸Šä¸‹æ–‡æ˜¯window</span></span><br></pre></td></tr></table></figure>

<h4 id="3-bind"><a href="#3-bind" class="headerlink" title="3.bind"></a>3.bind</h4><p>è¯¥æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œåœ¨ <code>bind() </code>è¢«è°ƒç”¨æ—¶ï¼Œè¿™ä¸ª<code>æ–°å‡½æ•°</code>çš„ <code>this è¢«æŒ‡å®šä¸º bind() çš„ç¬¬ä¸€ä¸ªå‚æ•°</code>ï¼Œè€Œå…¶ä½™å‚æ•°å°†ä½œä¸ºæ–°å‡½æ•°çš„å‚æ•°ï¼Œä¾›è°ƒç”¨æ—¶ä½¿ç”¨ã€‚<br>ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿”å›ä¸€ä¸ªåŸå‡½æ•°çš„æ‹·è´ï¼Œå¹¶æ‹¥æœ‰æŒ‡å®šçš„ this å€¼å’Œåˆå§‹å‚æ•°ã€‚<br>è¯­æ³•ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span>.bind(thisArg[, arg1[, arg2[, ...]]])</span><br></pre></td></tr></table></figure>

<div class="tip">
1 ä½¿ç”¨`new`æ„é€ å‡½æ•°æ—¶ï¼Œå¿½ç•¥`thisArg` 
---â€»---
2 åœ¨`setTimeout`ä¸­å›è°ƒå‡½æ•°ä½¿ç”¨æ—¶ï¼Œ`thisArg`çš„ä»»ä½•å€¼éƒ½å°†è½¬åŒ–æˆ`object`
---â€»---
3 å¦‚æœ`thisArg`ä¸º`nullæˆ–undefined`ï¼Œ`æ‰§è¡Œä½œç”¨åŸŸä¸­çš„this`å°†ä½œä¸ºæ–°çš„`thisArg`
</div> 


<p>åŸºç¡€ç”¨æ³•</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="built_in">module</span> = &#123;</span><br><span class="line">  <span class="attr">x</span>: <span class="number">42</span>,</span><br><span class="line">  <span class="attr">getX</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.x;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> unboundGetX = <span class="built_in">module</span>.getX;</span><br><span class="line"><span class="built_in">console</span>.log(unboundGetX());</span><br><span class="line"><span class="comment">// expected output: window.x =&gt; undefined</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> boundGetX = unboundGetX.bind(<span class="built_in">module</span>);</span><br><span class="line"><span class="built_in">console</span>.log(boundGetX());</span><br><span class="line"><span class="comment">// expected output: 42</span></span><br></pre></td></tr></table></figure>

<p>åå‡½æ•°<br>bind() çš„å¦ä¸€ä¸ªæœ€ç®€å•çš„ç”¨æ³•æ˜¯ä½¿ä¸€ä¸ªå‡½æ•°æ‹¥æœ‰é¢„è®¾çš„åˆå§‹å‚æ•°ã€‚<br>åªè¦å°†è¿™äº›å‚æ•°ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ä½œä¸º bind() çš„å‚æ•°å†™åœ¨ this åé¢ã€‚<br>å½“ç»‘å®šå‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œè¿™äº›å‚æ•°ä¼šè¢«æ’å…¥åˆ°ç›®æ ‡å‡½æ•°çš„å‚æ•°åˆ—è¡¨çš„å¼€å§‹ä½ç½®ï¼Œä¼ é€’ç»™ç»‘å®šå‡½æ•°çš„å‚æ•°ä¼šè·Ÿåœ¨å®ƒä»¬åé¢ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">list</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addArguments</span>(<span class="params">arg1, arg2</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> arg1 + arg2</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> list1 = list(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>); <span class="comment">// [1, 2, 3]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> result1 = addArguments(<span class="number">1</span>, <span class="number">2</span>); <span class="comment">// 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œå®ƒæ‹¥æœ‰é¢„è®¾å‚æ•°åˆ—è¡¨ã€‚</span></span><br><span class="line"><span class="keyword">var</span> leadingThirtysevenList = list.bind(<span class="literal">null</span>, <span class="number">37</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œå®ƒæ‹¥æœ‰é¢„è®¾çš„ç¬¬ä¸€ä¸ªå‚æ•°</span></span><br><span class="line"><span class="keyword">var</span> addThirtySeven = addArguments.bind(<span class="literal">null</span>, <span class="number">37</span>); </span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> list2 = leadingThirtysevenList(); </span><br><span class="line"><span class="comment">// [37]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> list3 = leadingThirtysevenList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>); </span><br><span class="line"><span class="comment">// [37, 1, 2, 3]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> result2 = addThirtySeven(<span class="number">5</span>); </span><br><span class="line"><span class="comment">// 37 + 5 = 42 </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> result3 = addThirtySeven(<span class="number">5</span>, <span class="number">10</span>);</span><br><span class="line"><span class="comment">// 37 + 5 = 42 ï¼Œç¬¬äºŒä¸ªå‚æ•°è¢«å¿½ç•¥</span></span><br></pre></td></tr></table></figure>

<p>æœ‰æ„æ€çš„ä»£ç </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> unboundSlice = <span class="built_in">Array</span>.prototype.slice;</span><br><span class="line"><span class="keyword">var</span> slice = <span class="built_in">Function</span>.prototype.apply.bind(unboundSlice);</span><br><span class="line"> <span class="comment">// è¿™é‡Œçš„Function.prototype.apply å…¶å®å°±æ˜¯applyå‡½æ•° </span></span><br><span class="line">slice(<span class="built_in">arguments</span>);</span><br><span class="line"><span class="comment">// ç­‰åŒäº apply.bind(unboundSlice); ä¹Ÿå°±æ˜¯slice === Array.prototype.slice</span></span><br></pre></td></tr></table></figure>


<p>å‡å¦‚ä¸æ”¯æŒ<code>bind</code>çš„æ—¶å€™</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Does not work with `new (funcA.bind(thisArg, args))`</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">Function</span>.prototype.bind) (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> slice = <span class="built_in">Array</span>.prototype.slice;</span><br><span class="line">  <span class="built_in">Function</span>.prototype.bind = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> thatFunc = <span class="built_in">this</span>, thatArg = <span class="built_in">arguments</span>[<span class="number">0</span>]; <span class="comment">// ç¼“å­˜è°ƒç”¨å‡½æ•°ï¼ŒthisæŒ‡å‘ï¼Œå…¶å®ƒå‚æ•°</span></span><br><span class="line">    <span class="keyword">var</span> args = slice.call(<span class="built_in">arguments</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> thatFunc !== <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">      <span class="comment">// closest thing possible to the ECMAScript 5</span></span><br><span class="line">      <span class="comment">// internal IsCallable function</span></span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">&#x27;Function.prototype.bind - &#x27;</span> +</span><br><span class="line">             <span class="string">&#x27;what is trying to be bound is not callable&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="keyword">var</span> funcArgs = args.concat(slice.call(<span class="built_in">arguments</span>)) <span class="comment">// å…¶å®ƒå‚æ•°åˆå¹¶ä¼ å…¥å‚æ•°ï¼Œå¹¶æˆç»Ÿä¸€çš„å‡½å‚</span></span><br><span class="line">      <span class="keyword">return</span> thatFunc.apply(thatArg, funcArgs);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

<h4 id="4-ä¸‰è€…åŒå¦"><a href="#4-ä¸‰è€…åŒå¦" class="headerlink" title="4. ä¸‰è€…åŒå¦"></a>4. ä¸‰è€…åŒå¦</h4><ul>
<li>applyæ˜¯ä¼ å‚æ•°æ•°ç»„(å‚æ•°ä¸ç¡®å®š)ï¼Œcallæ˜¯ä¼ å‚æ•°(å‚æ•°ç¡®å®š)</li>
<li>applyã€callã€bind ä¸‰è€…éƒ½æ˜¯ä¸ºäº†<code>æ”¹å˜ä¸Šä¸‹æ–‡</code>ï¼Œæ”¹å˜å‡½æ•°<code>å†…éƒ¨this</code>çš„æŒ‡å‘</li>
<li>é€šè¿‡applyè¿™ç§æ–¹å¼ï¼Œæ‚¨å°†é¢ä¸´è¶…è¿‡JavaScriptå¼•æ“çš„å‚æ•°é•¿åº¦é™åˆ¶çš„é£é™©</li>
<li>å¤šæ¬¡bindä¹Ÿåªæ˜¯bindç¬¬ä¸€æ¬¡ç»‘å®šçš„å€¼</li>
</ul>
<p>å‚è€ƒé“¾æ¥ï¼š<br><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function/apply">MDN å…³äº apply</a><br><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function/bind">MDN å…³äº bind</a><br><a href="https://www.cnblogs.com/coco1s/p/4833199.html">ChokCocoblog</a><br><a href="https://muyiy.cn/blog/3/3.3.html#call-%E5%92%8C-apply">æ¨¡æ‹Ÿå®ç°</a></p>
]]></content>
      <tags>
        <tag>é¢è¯• JS</tag>
      </tags>
  </entry>
  <entry>
    <title>nginx</title>
    <url>/2018/06/17/nginx%E7%A7%91%E6%99%AE%E7%AB%A0/</url>
    <content><![CDATA[<h4 id="nginx-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#nginx-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="nginx æ˜¯ä»€ä¹ˆï¼Ÿ"></a>nginx æ˜¯ä»€ä¹ˆï¼Ÿ</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">é™æ€èµ„æºHTTP æœåŠ¡å™¨ã€‚é€šè¿‡httpåè®®å°†é™æ€èµ„æºè·¯å¾„æš´éœ²ç»™å®¢æˆ·ç«¯ã€‚</span><br><span class="line">åå‘ä»£ç†æœåŠ¡å™¨ã€‚ä»‹ä¹å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨çš„ä¸­é—´å±‚ï¼Œå¯ä»¥åšè™šæ‹Ÿä¸»æœºï¼Œå’Œè´Ÿè½½å‡è¡¡</span><br></pre></td></tr></table></figure>

<h4 id="è™šæ‹Ÿä¸»æœº-æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆç½‘ç«™è®¿é—®é‡å°çš„æƒ…å†µï¼‰"><a href="#è™šæ‹Ÿä¸»æœº-æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆç½‘ç«™è®¿é—®é‡å°çš„æƒ…å†µï¼‰" class="headerlink" title="è™šæ‹Ÿä¸»æœº æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆç½‘ç«™è®¿é—®é‡å°çš„æƒ…å†µï¼‰"></a>è™šæ‹Ÿä¸»æœº æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆç½‘ç«™è®¿é—®é‡å°çš„æƒ…å†µï¼‰</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å¤šåŸŸåå¯¹åº”åŒä¸€æœåŠ¡å™¨ï¼Œå¯¹åº”åŒä¸€ipï¼Œå´å¯ä»¥æ‰“å¼€ä¸åŒç½‘ç«™ã€‚ä»¿ä½›å°±åƒä¸¤ä¸ªæœåŠ¡å™¨ï¼Œæ‰€ä»¥ç§°ä¸ºè™šæ‹Ÿä¸»æœºï¼Œä¹Ÿå¯ä»¥ç§°ä¸ºå¤šå¼€ã€‚</span><br></pre></td></tr></table></figure>

<h4 id="è´Ÿè½½å‡è¡¡-æ˜¯ä»€ä¹ˆ-ï¼ˆç½‘ç«™è®¿é—®é‡å¤§çš„æƒ…å†µï¼‰"><a href="#è´Ÿè½½å‡è¡¡-æ˜¯ä»€ä¹ˆ-ï¼ˆç½‘ç«™è®¿é—®é‡å¤§çš„æƒ…å†µï¼‰" class="headerlink" title="è´Ÿè½½å‡è¡¡ æ˜¯ä»€ä¹ˆ? ï¼ˆç½‘ç«™è®¿é—®é‡å¤§çš„æƒ…å†µï¼‰"></a>è´Ÿè½½å‡è¡¡ æ˜¯ä»€ä¹ˆ? ï¼ˆç½‘ç«™è®¿é—®é‡å¤§çš„æƒ…å†µï¼‰</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">é€šè¿‡åå‘ä»£ç†çš„èº«ä»½ï¼ŒæŠŠè‡ªå·±å†™çš„åº”ç”¨éƒ¨ç½²åœ¨å¤šä¸ªæœåŠ¡å™¨ä¸Šã€‚å…¶å®è¯´ç™½äº†ï¼Œå°±æ˜¯ä¸€ä»½nginxé…ç½®ï¼Œä¸Šé¢å¾ˆå¤šipåœ°å€ï¼Œä¼šè‡ªåŠ¨è½®è¯¢ipåœ°å€ï¼Œå¹¶æ ¹æ®weightçš„å€¼æ¥åˆ¤æ–­åˆ†é…ç»™æŒ‡å®šipçš„æœåŠ¡å™¨çš„æƒé‡ã€‚</span><br></pre></td></tr></table></figure>

<h4 id="nginx-æ€ä¹ˆé…ç½®ï¼Ÿ"><a href="#nginx-æ€ä¹ˆé…ç½®ï¼Ÿ" class="headerlink" title="nginx æ€ä¹ˆé…ç½®ï¼Ÿ"></a>nginx æ€ä¹ˆé…ç½®ï¼Ÿ</h4><p><a href="https://blog.csdn.net/lihang_1994/article/details/72598955">å…·ä½“å‚è€ƒé“¾æ¥</a></p>
]]></content>
      <tags>
        <tag>nginx</tag>
      </tags>
  </entry>
  <entry>
    <title>proxy</title>
    <url>/2020/06/14/proxy/</url>
    <content><![CDATA[<p><code>vue</code>æºç çš„renderéƒ¨åˆ†ï¼Œæ›¾ç”¨åˆ°<code>proxy</code>æ¥ä»£ç†vueçš„å®ä¾‹ã€‚</p>
<h3 id="1-æ¦‚å¿µï¼š"><a href="#1-æ¦‚å¿µï¼š" class="headerlink" title="1 æ¦‚å¿µï¼š"></a>1 æ¦‚å¿µï¼š</h3><p><code>proxy</code> åŸæ„å°±æœ‰ä»£ç†çš„æ„æ€ã€‚å®ƒæ˜¯å¤–ç•Œè®¿é—®å¯¹è±¡çš„ä¸€å±‚<code>ä»£ç†æ§åˆ¶</code>ï¼Œä¹Ÿæ˜¯å¯¹è®¿é—®çš„ä¸€ç§<code>æ”¹å†™å’Œè¿‡æ»¤</code>ã€‚å±äºä¸€ç§<code>å…ƒç¼–ç¨‹</code>ã€‚</p>
<h3 id="2-ä½œç”¨ï¼š"><a href="#2-ä½œç”¨ï¼š" class="headerlink" title="2 ä½œç”¨ï¼š"></a>2 ä½œç”¨ï¼š</h3><p>å¯ä»¥ä»è·å–å’Œè®¾ç½®ä¸¤ç§æ—¶æœºå»ä»£ç†æŒ‡å®šå¯¹è±¡</p>
<h3 id="3-ä»£ç ç»“æ„ï¼š"><a href="#3-ä»£ç ç»“æ„ï¼š" class="headerlink" title="3 ä»£ç ç»“æ„ï¼š"></a>3 ä»£ç ç»“æ„ï¼š</h3><p>æ ‡å‡†ç»“æ„ï¼š</p>
<blockquote>
<p>var proxy = new Proxy (target, handler);  // targetæ˜¯æ‹¦æˆªçš„ç›®æ ‡  handleræ˜¯æ‹¦æˆªè¡Œä¸º</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = <span class="keyword">new</span> <span class="built_in">Proxy</span>(&#123;</span><br><span class="line">    <span class="attr">get</span>: <span class="function"><span class="keyword">function</span>(<span class="params">target, key, receiver</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`getting <span class="subst">$&#123;key&#125;</span>`</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Reflect</span>.get(target, key, receiver)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">set</span>: <span class="function"><span class="keyword">function</span>(<span class="params">target, key, value, receiver</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`setting <span class="subst">$&#123;key&#125;</span>`</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Reflect</span>.set(target, key, value, receiver)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">obj <span class="comment">// é»˜è®¤æ˜¯&#123;&#125;    </span></span><br><span class="line">obj.a = <span class="number">1</span> <span class="comment">// setting a</span></span><br><span class="line">obj.a = <span class="number">2</span> <span class="comment">// setting a</span></span><br><span class="line"><span class="built_in">console</span>.log(obj.a) <span class="comment">// getting a</span></span><br></pre></td></tr></table></figure>

<h3 id="4-è¦æ³¨æ„çš„ç‚¹ï¼š"><a href="#4-è¦æ³¨æ„çš„ç‚¹ï¼š" class="headerlink" title="4. è¦æ³¨æ„çš„ç‚¹ï¼š"></a>4. è¦æ³¨æ„çš„ç‚¹ï¼š</h3><ul>
<li><p>è¦ä½¿proxyèµ·ä½œç”¨ï¼Œéœ€å¯¹proxyçš„å®ä¾‹ è¿›è¡Œæ“ä½œï¼Œè€Œä¸æ˜¯é’ˆå¯¹åŸç›®æ ‡å¯¹è±¡ã€‚</p>
</li>
<li><p>ä¸åŸå‹çš„åº”ç”¨ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(&#123;&#125;, &#123;</span><br><span class="line">    <span class="attr">get</span>: <span class="function"><span class="keyword">function</span>(<span class="params">target, property</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">35</span></span><br><span class="line">    &#125;,</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">let</span> _obj = <span class="built_in">Object</span>.create(proxy)</span><br><span class="line">_obj.time <span class="comment">// 35</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// proxyå¯¹è±¡æ˜¯_objçš„åŸå‹ï¼Œ_objä¸Šæ²¡æœ‰timeè¿™ä¸ªå±æ€§ï¼Œå°±é¡ºç€åŸå‹é“¾æ‰¾åˆ°proxyï¼Œproxyä¸Šçš„ä»»ä½•å±æ€§éƒ½ä¼šè¿”å›35</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="5-proxyè¿˜æ”¯æŒgetã€setä¹‹å¤–çš„apiè¡¥å……"><a href="#5-proxyè¿˜æ”¯æŒgetã€setä¹‹å¤–çš„apiè¡¥å……" class="headerlink" title="5. proxyè¿˜æ”¯æŒgetã€setä¹‹å¤–çš„apiè¡¥å……"></a>5. proxyè¿˜æ”¯æŒgetã€setä¹‹å¤–çš„apiè¡¥å……</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> handler = &#123;</span><br><span class="line">  <span class="attr">get</span>: <span class="function"><span class="keyword">function</span>(<span class="params">target, name</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (name === <span class="string">&#x27;prototype&#x27;</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">Object</span>.prototype;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello, &#x27;</span> + name;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="attr">apply</span>: <span class="function"><span class="keyword">function</span>(<span class="params">target, thisBinding, args</span>) </span>&#123; <span class="comment">// proxyå®ä¾‹ä½œä¸ºå‡½æ•°è°ƒç”¨æ—¶è§¦å‘</span></span><br><span class="line">    <span class="keyword">return</span> args[<span class="number">0</span>];</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="attr">construct</span>: <span class="function"><span class="keyword">function</span>(<span class="params">target, args</span>) </span>&#123; <span class="comment">// proxyä½œä¸ºæ„é€ å‡½æ•°æ—¶è§¦å‘</span></span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="attr">value</span>: args[<span class="number">1</span>]&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> fproxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(<span class="function"><span class="keyword">function</span>(<span class="params">x, y</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;, handler);</span><br><span class="line"></span><br><span class="line">fproxy(<span class="number">1</span>, <span class="number">2</span>) <span class="comment">// 1</span></span><br><span class="line"><span class="keyword">new</span> fproxy(<span class="number">1</span>, <span class="number">2</span>) <span class="comment">// &#123;value: 2&#125;</span></span><br><span class="line">fproxy.prototype === <span class="built_in">Object</span>.prototype <span class="comment">// true</span></span><br><span class="line">fproxy.foo === <span class="string">&quot;Hello, foo&quot;</span> <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// get æ‹¦æˆª è´Ÿæ•°ç´¢å¼•</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createArray</span>(<span class="params">...elements</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> handler = &#123;</span><br><span class="line">     <span class="attr">get</span>: <span class="function"><span class="keyword">function</span>(<span class="params">target, property, receiver</span>) </span>&#123; </span><br><span class="line">         <span class="keyword">let</span> index = <span class="built_in">Number</span>(property) <span class="comment">// -1 ä¼šä½œä¸ºå±æ€§ä¼ è¿›æ¥</span></span><br><span class="line">         <span class="keyword">if</span> (index &lt; <span class="number">0</span>) &#123;</span><br><span class="line">             property = <span class="built_in">String</span>(target.length + index) <span class="comment">// property\target æ˜¯å¯ä»¥ä¿®æ”¹çš„ å¥‡æ€ª...</span></span><br><span class="line">         &#125;</span><br><span class="line">         <span class="keyword">return</span> <span class="built_in">Reflect</span>.get(target, property, receiver) <span class="comment">// Reflect is what</span></span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">let</span> target = []</span><br><span class="line"> target.push(...elements)</span><br><span class="line"> <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, handler)</span><br><span class="line">&#125;</span><br><span class="line">arr = createArray(<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>)</span><br><span class="line">arr[-<span class="number">1</span>] <span class="comment">// &#x27;c&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="6-å±æ€§éœ€å¯é…ç½®ï¼Œconfiguable-å’Œ-å¯å†™writableï¼Œå¦åˆ™proxyå®ä¾‹è®¿é—®ä»£ç†è¿™ä¸ªå±æ€§ä¼šæŠ¥é”™-ä¹Ÿæ˜¯ä¸€æ¡å¯ä»¥é˜»æ­¢proxyçš„æ³•å­"><a href="#6-å±æ€§éœ€å¯é…ç½®ï¼Œconfiguable-å’Œ-å¯å†™writableï¼Œå¦åˆ™proxyå®ä¾‹è®¿é—®ä»£ç†è¿™ä¸ªå±æ€§ä¼šæŠ¥é”™-ä¹Ÿæ˜¯ä¸€æ¡å¯ä»¥é˜»æ­¢proxyçš„æ³•å­" class="headerlink" title="6. å±æ€§éœ€å¯é…ç½®ï¼Œconfiguable å’Œ å¯å†™writableï¼Œå¦åˆ™proxyå®ä¾‹è®¿é—®ä»£ç†è¿™ä¸ªå±æ€§ä¼šæŠ¥é”™ (ä¹Ÿæ˜¯ä¸€æ¡å¯ä»¥é˜»æ­¢proxyçš„æ³•å­)"></a>6. å±æ€§éœ€å¯é…ç½®ï¼Œconfiguable å’Œ å¯å†™writableï¼Œå¦åˆ™proxyå®ä¾‹è®¿é—®ä»£ç†è¿™ä¸ªå±æ€§ä¼šæŠ¥é”™ (ä¹Ÿæ˜¯ä¸€æ¡å¯ä»¥é˜»æ­¢proxyçš„æ³•å­)</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> target = <span class="built_in">Object</span>.defineProperties(&#123;&#125;, &#123;</span><br><span class="line">  <span class="attr">foo</span>: &#123;</span><br><span class="line">    <span class="attr">value</span>: <span class="number">123</span>,</span><br><span class="line">    <span class="attr">writable</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">configurable</span>: <span class="literal">false</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> handler = &#123;</span><br><span class="line">  <span class="function"><span class="title">get</span>(<span class="params">target, propKey</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;abc&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, handler);</span><br><span class="line"></span><br><span class="line">proxy.foo</span><br><span class="line"><span class="comment">// Uncaught TypeError: &#x27;get&#x27; on proxy: property &#x27;foo&#x27; is a read-only and non-configurable data property on the proxy target but the proxy did not return its actual value (expected &#x27;123&#x27; but got &#x27;abc&#x27;)</span></span><br></pre></td></tr></table></figure>

<hr>
<p>å¼•ç”³äº†è§£ï¼š</p>
<ul>
<li>å…ƒç¼–ç¨‹çš„æ¦‚å¿µ</li>
<li>proxyçš„getå’Œsetï¼Œä¸ Object.defineProperty ç›¸æ¯”ï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«<ul>
<li>ç­”ï¼š<a href="https://juejin.im/post/5be4f7cfe51d453339084530">jueim</a> proxyçš„åº”ç”¨åœºæ™¯æ›´å¤šï¼Œä½†æ˜¯defineçš„å…¼å®¹æ€§æ›´å¥½</li>
<li>ç­”ï¼š<a href="https://github.com/YvetteLau/Blog/issues/25">issue</a></li>
<li>ç­”ï¼š<a href="https://juejin.im/post/5acd0c8a6fb9a028da7cdfaf">ä¸¤è€…å®ç°åŒå‘ç»‘å®šå·®å¼‚</a></li>
</ul>
</li>
</ul>
<hr>
<p>å‚è€ƒæ–‡ç« ï¼š<br><a href="https://es6.ruanyifeng.com/#docs/proxy">é˜®ä¸€å³°es6 proxyç« èŠ‚</a><br><a href="https://www.infoq.cn/article/es6-in-depth-proxies-and-reflect">æ·±å…¥æµ…å‡ºes6ç³»åˆ—</a><br><a href="https://www.infoq.cn/article/es6-in-depth-proxies-and-reflect">segmentFault</a><br><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Meta_programming">å…ƒç¼–ç¨‹</a></p>
]]></content>
      <tags>
        <tag>ES6</tag>
      </tags>
  </entry>
  <entry>
    <title>sql</title>
    <url>/2018/05/02/sql/</url>
    <content><![CDATA[<h4 id="ä¸ºäº†æ–°é¡¹ç›®çš„sqlå­˜å‚¨ï¼Œæˆ‘è§‰å¾—è¿˜æ˜¯å¾ˆæœ‰å¿…è¦å­¦ä¸‹sql"><a href="#ä¸ºäº†æ–°é¡¹ç›®çš„sqlå­˜å‚¨ï¼Œæˆ‘è§‰å¾—è¿˜æ˜¯å¾ˆæœ‰å¿…è¦å­¦ä¸‹sql" class="headerlink" title="ä¸ºäº†æ–°é¡¹ç›®çš„sqlå­˜å‚¨ï¼Œæˆ‘è§‰å¾—è¿˜æ˜¯å¾ˆæœ‰å¿…è¦å­¦ä¸‹sql"></a>ä¸ºäº†æ–°é¡¹ç›®çš„sqlå­˜å‚¨ï¼Œæˆ‘è§‰å¾—è¿˜æ˜¯å¾ˆæœ‰å¿…è¦å­¦ä¸‹sql</h4><pre><code>soï½ï½ å¼€å§‹ï¼

åˆšå¼€å§‹å°±æŠ¥äº†é”™ï¼ŒAccess denied for user &#39;root&#39;@&#39;localhost&#39; (using password: NO)
ç”¨è¿™ä¸ªå‘½ä»¤(ç™»å½•MYSQLçš„æ„æ€)ï¼Œmysql -uroot -p
ç„¶åé‡æ–°è¾“ä¸€éå¯†ç 
</code></pre>
<h4 id="è¯­æ³•"><a href="#è¯­æ³•" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h4><pre><code>(1) sqlå‘½ä»¤å¿…é¡»å¸¦;åˆ†å·ï¼Œå¦åˆ™æç¤ºsqlè¯­å¥é”™è¯¯ã€‚
(2) é€€å‡ºmysqlï¼š exit;
(3) MYSQLåˆ é™¤è¡¨ è¯­æ³•ï¼šdrop table &#39;table_name&#39;;
(4) åˆ›å»ºæ•°æ®åº“ï¼š create database databaseNname;
(5) show databases;  æ˜¯ç”¨æ¥çœ‹ç™»é™†åçš„ç”¨æˆ·æœ‰å¤šå°‘å…³è”çš„æ•°æ®åº“
(6) use database&#39;s name; è¿›å…¥è¯¥æ•°æ®åº“
(7) show tables; æŸ¥çœ‹è¯¥æ•°æ®åº“çš„è¡¨æ ¼
(8) desc table&#39;s name; æŸ¥çœ‹è¯¥è¡¨çš„ç»“æ„
</code></pre>
<h4 id="è°ƒè¯•æ–¹æ¡ˆï¼ˆåŸºäºmac-osï¼‰"><a href="#è°ƒè¯•æ–¹æ¡ˆï¼ˆåŸºäºmac-osï¼‰" class="headerlink" title="è°ƒè¯•æ–¹æ¡ˆï¼ˆåŸºäºmac osï¼‰"></a>è°ƒè¯•æ–¹æ¡ˆï¼ˆåŸºäºmac osï¼‰</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql <span class="operator">-</span>u root <span class="operator">-</span>p</span><br><span class="line"><span class="keyword">create</span> database name;</span><br><span class="line">use name;</span><br></pre></td></tr></table></figure>
<pre><code>    ä¹‹åï¼Œå¯ä»¥åœ¨å‘½ä»¤è¡Œ source (å°†sqlæ–‡ä»¶æ‹–æ‹½è¿›æ¥ï¼Œå»æ‰file://)
    æ‰€ä»¥ä½ å¯ä»¥æœ¬åœ°å†™å¥½sqlæ–‡ä»¶ï¼Œåœ¨å‘½ä»¤è¡Œæ‰§è¡Œå¹¶æ£€éªŒ
</code></pre>
<p>(2) ç”¨sequel proå·¥å…·æ¥æŸ¥çœ‹sqlå›¾å½¢åŒ–è¡¨æ ¼ï¼Œå¯¹ç…§çœ‹åœ¨å‘½ä»¤è¡Œå†™çš„sqlæ˜¯å¦èµ·æ•ˆ</p>
<h4 id="æ•°æ®ç±»å‹"><a href="#æ•°æ®ç±»å‹" class="headerlink" title="æ•°æ®ç±»å‹"></a>æ•°æ®ç±»å‹</h4><img src='./package.png' style="width:50%;height:60%;">
å‚è€ƒé“¾æ¥ http://www.runoob.com/mysql/mysql-data-types.html

<h4 id="å¸¸è§„æ“ä½œ"><a href="#å¸¸è§„æ“ä½œ" class="headerlink" title="å¸¸è§„æ“ä½œ"></a>å¸¸è§„æ“ä½œ</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> `movie` (</span><br><span class="line">    `id` <span class="type">INT</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>  AUTO_INCREMENT,</span><br><span class="line">    `movie_name` <span class="type">CHAR</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    `high_image` <span class="type">CHAR</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    `content` <span class="type">CHAR</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT <span class="operator">=</span> <span class="number">3</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8;</span><br></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯å¢åˆ æ”¹æŸ¥ï¼Œæœ€é‡è¦çš„éƒ¨åˆ†ï¼š</p>
<h3 id="å¢åŠ ï¼Œæ‰¹é‡"><a href="#å¢åŠ ï¼Œæ‰¹é‡" class="headerlink" title="å¢åŠ ï¼Œæ‰¹é‡"></a>å¢åŠ ï¼Œæ‰¹é‡</h3><figure class="highlight sql"><figcaption><span>(ç»“æ„ï¼šINSERT INTO è¡¨å ï¼ˆè¦å¢åŠ çš„åˆ—åï¼‰VALUES ï¼ˆå¯¹åº”çš„å€¼ï¼‰)</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> movie (movie_name,high_image,content) <span class="keyword">VALUES</span></span><br><span class="line">    (<span class="string">&#x27;å¤´å·ç©å®¶&#x27;</span>,<span class="string">&#x27;www.baidu.com/a.jpg&#x27;</span>,<span class="string">&#x27;VRé«˜çº§æ¨¡æ‹Ÿç°å®æ¸¸æˆ&#x27;</span>),</span><br><span class="line">    (<span class="string">&#x27;æ–—ç ´è‹ç©¹&#x27;</span>,<span class="string">&#x27;www.baidu.com/b.jpg&#x27;</span>,<span class="string">&#x27;çƒ­è¡€å›½æ¼«&#x27;</span>),</span><br><span class="line">    (<span class="string">&#x27;ä»™å‰‘å¥‡ä¾ ä¼ &#x27;</span>,<span class="string">&#x27;www.baidu.com/c.jpg&#x27;</span>,<span class="string">&#x27;è‰¯å¿ƒå›½äº§ä»™ä¾ &#x27;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="æ”¹-ç»“æ„ï¼šUPDATE-è¡¨å-SET-è¦ä¿®æ”¹çš„åˆ—-é€—å·éš”å¼€-WHERE-åŒ¹é…æ¡ä»¶"><a href="#æ”¹-ç»“æ„ï¼šUPDATE-è¡¨å-SET-è¦ä¿®æ”¹çš„åˆ—-é€—å·éš”å¼€-WHERE-åŒ¹é…æ¡ä»¶" class="headerlink" title="æ”¹ (ç»“æ„ï¼šUPDATE è¡¨å SET è¦ä¿®æ”¹çš„åˆ—,é€—å·éš”å¼€ WHERE åŒ¹é…æ¡ä»¶ )"></a>æ”¹ (ç»“æ„ï¼šUPDATE è¡¨å SET è¦ä¿®æ”¹çš„åˆ—,é€—å·éš”å¼€ WHERE åŒ¹é…æ¡ä»¶ )</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">UPDATE movie <span class="keyword">SET</span> high_image<span class="operator">=</span><span class="string">&#x27;www.touhaowanjia.com/1.jpg&#x27;</span> <span class="keyword">WHERE</span> movie_name<span class="operator">=</span><span class="string">&#x27;å¤´å·ç©å®¶&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="åˆ -ç»“æ„ï¼šDELETE-FROM-è¡¨å-WHERE-åŒ¹é…æ¡ä»¶"><a href="#åˆ -ç»“æ„ï¼šDELETE-FROM-è¡¨å-WHERE-åŒ¹é…æ¡ä»¶" class="headerlink" title="åˆ  (ç»“æ„ï¼šDELETE FROM è¡¨å WHERE åŒ¹é…æ¡ä»¶  )"></a>åˆ  (ç»“æ„ï¼šDELETE FROM è¡¨å WHERE åŒ¹é…æ¡ä»¶  )</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> movie <span class="keyword">WHERE</span> id<span class="operator">=</span><span class="number">9</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="æŸ¥-ç»“æ„ï¼šSELECT-åˆ—-FROM-è¡¨å-WHERE-åŒ¹é…æ¡ä»¶"><a href="#æŸ¥-ç»“æ„ï¼šSELECT-åˆ—-FROM-è¡¨å-WHERE-åŒ¹é…æ¡ä»¶" class="headerlink" title="æŸ¥ (ç»“æ„ï¼šSELECT åˆ— FROM è¡¨å WHERE åŒ¹é…æ¡ä»¶  )"></a>æŸ¥ (ç»“æ„ï¼šSELECT åˆ— FROM è¡¨å WHERE åŒ¹é…æ¡ä»¶  )</h3><p>ï¼ˆ1ï¼‰æŸ¥è¯¢æ‰€æœ‰åˆ—</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> movie;</span><br></pre></td></tr></table></figure>
<p>ï¼ˆ2ï¼‰æŸ¥è¯¢æŒ‡å®šåˆ—</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> content <span class="keyword">FROM</span> movie;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="æŠ¥é”™å¤„ç†ï¼š"><a href="#æŠ¥é”™å¤„ç†ï¼š" class="headerlink" title="æŠ¥é”™å¤„ç†ï¼š"></a>æŠ¥é”™å¤„ç†ï¼š</h3><pre><code>å…·ä½“å°±çœ‹æŠ¥é”™è¯­å¥ï¼Œæç¤ºåœ¨å“ªé‡Œé™„è¿‘æŠ¥é”™ï¼Œç¬¬å‡ è¡Œï¼Œnear ä»€ä¹ˆ
</code></pre>
]]></content>
      <tags>
        <tag>sql</tag>
      </tags>
  </entry>
  <entry>
    <title>uploadä¹‹åˆæ¢</title>
    <url>/2018/01/04/upload/</url>
    <content><![CDATA[<h4 id="æ¥ç”±"><a href="#æ¥ç”±" class="headerlink" title="æ¥ç”±"></a>æ¥ç”±</h4><blockquote>
<p>äº§å“æœ‰åšèƒ½å¤šé€‰çš„ä¸Šä¼ è¿™ä¸ªåŠŸèƒ½ï¼Œå¼€å§‹å€’è…¾ã€‚äº‹å®ä¹Ÿè¸©äº†ä¸å°‘å‘ã€‚ç°å°±å¼€å§‹æ¢³ç†ä»Šå¤©çš„æ€è·¯ã€‚</p>
</blockquote>
<h4 id="æ¡†æ¶é€‰å–"><a href="#æ¡†æ¶é€‰å–" class="headerlink" title="æ¡†æ¶é€‰å–"></a>æ¡†æ¶é€‰å–</h4><ul>
<li>å¾®ä¿¡ä¸Šä¼ æ¥å£:<br>å…ˆä¸Šå›¾ : æˆ‘ä»¬å¯ä»¥çœ‹åˆ°çš„æ˜¯ï¼Œå®ƒçš„æ¥å£ chooseImage ç¡®æ˜¯æœ‰è¿™ç•ªä½œç”¨ã€‚ç›´æ¥æŠŠæœ‹å‹åœˆå‘ç…§ç‰‡çš„æµç¨‹ç»™è°ƒå‡ºæ¥ã€‚å¯ä»¥é¢„è§ˆï¼Œå¯ä»¥åŸå›¾ï¼Œå¾ˆå…¨é¢äº†ã€‚ç„¶è€Œï¼Œå®ƒéœ€è¦ä¼ åˆ°å¾®ä¿¡æœåŠ¡å™¨èµ°ä¸€é­ï¼Œè¿™æ˜¯æœ€è®©äººéš¾å—çš„</li>
</ul>
<blockquote>
<p>å¼ƒç”¨åŸå› ï¼šæœ¬èº«æˆ‘é¡¹ç›®çš„å›¾ç‰‡å­˜å‚¨æ˜¯æ”¾åœ¨é˜¿é‡Œäº‘ossé‡Œï¼Œå¦‚ä»Šè¿˜å¾—å†ç»è¿‡å¾®ä¿¡æœåŠ¡å™¨ä¸Šä¼ ä¸‹è½½ï¼Œå°±æŠŠè¿™äº‹æéº»çƒ¦äº†â€¦</p>
</blockquote>
<p><img src='/upload/1.png' style="width:50%;height:60%;"><img src='/upload/2.png' style="width:50%;height:60%;"></p>
<ul>
<li>eleme-UI<br>è¿˜æ˜¯å…ˆä¸Šå›¾ï¼šå®ƒä¹Ÿæ˜¯æå¥½çš„ï¼Œä»UIç¾è§‚è§’åº¦çœ‹ï¼Œæˆ–æ˜¯å®ƒçš„åŠŸèƒ½æ€§ï¼Œéƒ½å¾ˆæ¥è¿‘ç†æƒ³äº†ã€‚å¯æƒœï¼Œå®ƒçš„ä¸Šä¼ åªæœ‰ä¸€æ¬¡ï¼Œå°±æ˜¯å®ƒçš„è¯·æ±‚æœåŠ¡å™¨Urlåªæœ‰ä¸€ä¸ªï¼Œè€Œä¸”æ˜¯åœ¨vueçš„htmlé‡Œæ¸²æŸ“ï¼Œè¿™å°±æ›´ä¸å¥½æ”¹äº†<blockquote>
<p> å¼ƒç”¨åŸå› : è¿˜æ˜¯å› ä¸ºossé‡Œçš„åˆ¤æ–­ï¼Œæœ‰å¼•è¿›äº†ä¸¤æ¬¡è¯·æ±‚ï¼Œç¬¬ä¸€æ¬¡æ˜¯è¯·æ±‚ ä¸‹æ¬¡è¯·æ±‚è¦ç”¨ä¸Šçš„åœ°å€å’Œid ç¬¬äºŒæ¬¡åˆ™æ˜¯çœŸæ­£å’Œossè¯·æ±‚ä¸Šä¼ å›¾ã€‚</p>
<img src='/upload/3.png' style="width:50%;height:60%;"></blockquote>
</li>
<li>plupload<br>è¿˜åœ¨ç ”ç©¶ä¸­â€¦æ˜¯åå°åŒäº‹æ¨èçš„ä¸€ä¸ªæ’ä»¶ï¼Œæ®è¯´osså°±æ˜¯å®˜æ–¹æ”¯æŒè¿™ä¸ªï¼Œå¤§å–œä¹‹ä½™å°±çœ‹çœ‹å®ƒæ–‡æ¡£ã€‚<h4 id="å—¯ã€‚åŠ æ²¹ï¼Œæ˜å¤©ç»§ç»­å€’è…¾ï¼"><a href="#å—¯ã€‚åŠ æ²¹ï¼Œæ˜å¤©ç»§ç»­å€’è…¾ï¼" class="headerlink" title="å—¯ã€‚åŠ æ²¹ï¼Œæ˜å¤©ç»§ç»­å€’è…¾ï¼^_^"></a>å—¯ã€‚åŠ æ²¹ï¼Œæ˜å¤©ç»§ç»­å€’è…¾ï¼^_^</h4></li>
</ul>
]]></content>
      <tags>
        <tag>upload</tag>
      </tags>
  </entry>
  <entry>
    <title>vueæºç åˆ†æ</title>
    <url>/2020/04/27/vue%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/</url>
    <content><![CDATA[<p>ç½‘å€ï¼š<br><a href="https://jiongks.name/blog/vue-code-review/">å‹¾ä¸‰è‚¡å››</a><br><a href="https://github.com/HcySunYang/vue-design">æˆä¹‹ä»¥æ¸”</a><br><a href="https://ustbhuangyi.github.io/vue-analysis/v2/data-driven/update.html#%E6%80%BB%E7%BB%93">vueå¤§æ¦‚è®²è§£</a><br><a href="https://github.com/answershuto/learnVue">æŸ“é™Œç”µå­ä¹¦</a><br><a href="https://www.cnblogs.com/QH-Jimmy/p/7210363.html">patchåŸç†</a><br><a href="https://github.com/aooy/blog/issues/2">victual dom diff</a><br><a href="https://www.bookstack.cn/books/5865c0921b69e6006b3145a1">ä¹¦æ ˆç½‘</a><br><a href="http://caibaojian.com/vue-design/art/81vue-lexical-analysis.html">vueä¸­çš„AST</a></p>
]]></content>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>webpackçš„åèŠ±å›­</title>
    <url>/2019/12/11/webpack/</url>
    <content><![CDATA[<h3 id="1-webpackåº•å±‚"><a href="#1-webpackåº•å±‚" class="headerlink" title="1.webpackåº•å±‚"></a>1.webpackåº•å±‚</h3><pre><code>å®ƒæ˜¯ä¸€ä¸ªæ‰“åŒ…å·¥å…·ã€‚
webpackæœ¬èº«ï¼Œåœ¨ä¸å€ŸåŠ©loaderçš„æƒ…å†µä¸‹ï¼Œåªä¼šæ‰“åŒ…jsã€‚

ï¼ˆå¼•ç”¨ï¼‰webpackå¤„ç†åº”ç”¨ç¨‹åºæ—¶ï¼Œä¼šé€’å½’çš„æ„å»ºä¸€ä¸ªä¾èµ–å…³ç³»å›¾ï¼Œå…¶ä¸­åŒ…æ‹¬åº”ç”¨ç¨‹åºéœ€è¦çš„æ¯ä¸ªæ¨¡å—ï¼Œç„¶åæŠŠæ‰€æœ‰æ¨¡å—æ‰“åŒ…æˆä¸€ä¸ªæˆ–å¤šä¸ªbundleã€‚
</code></pre>
<h3 id="2-å‡ ä¸ªæ ¸å¿ƒæ¦‚å¿µ"><a href="#2-å‡ ä¸ªæ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="2.å‡ ä¸ªæ ¸å¿ƒæ¦‚å¿µ"></a>2.å‡ ä¸ªæ ¸å¿ƒæ¦‚å¿µ</h3><ul>
<li>å…¥å£</li>
<li>å‡ºå£<ul>
<li>å…¥å£å’Œå‡ºå£å¾ˆå¥½ç†è§£ï¼Œå…¥å£å°±æ˜¯æ‰“åŒ…è°ï¼Œå‡ºå£å°±æ˜¯è¦è¾“å‡ºçš„æ–‡ä»¶ã€‚<br>entry:<br>output:{ path, filename }</li>
</ul>
</li>
<li>loader<ul>
<li>å¸®åŠ©webpackè¯†åˆ«éjsæ–‡ä»¶ï¼ŒåŒ…æ‹¬cssï¼Œå›¾ç‰‡ç­‰ã€‚</li>
<li>ç¤ºä¾‹ï¼š<br>  test: ä½œç”¨ç­‰åŒäºæ­£åˆ™é‡Œé¢çš„åŒ¹é…<br>  use: ä½¿ç”¨loader<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">rules: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">test</span>: <span class="regexp">/\.js$/</span>,</span><br><span class="line">            use: [</span><br><span class="line">                <span class="string">&#x27;babel-loader&#x27;</span>,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">loader</span>: <span class="string">&#x27;eslint-loader&#x27;</span>,</span><br><span class="line">                    <span class="attr">options</span>: &#123;</span><br><span class="line">                        <span class="attr">emitWarning</span>: <span class="literal">true</span>,</span><br><span class="line">                        <span class="attr">emitError</span>: <span class="literal">true</span>,</span><br><span class="line">                        <span class="attr">failOnError</span>: <span class="literal">true</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">test</span>: <span class="regexp">/\.css$/</span>, use: [<span class="string">&quot;style-loader&quot;</span>,<span class="string">&quot;css-loader&quot;</span>]</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">test</span>: <span class="regexp">/\.(png|jpg)$/</span>,</span><br><span class="line">            loader: <span class="string">&#x27;url-loader?limit=8192&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">test</span>: <span class="regexp">/\.vue$/</span>,</span><br><span class="line">            use:[</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">loader</span>: <span class="string">&#x27;vue-loader&#x27;</span>,</span><br><span class="line">                    <span class="attr">options</span>: &#123;</span><br><span class="line">                        <span class="attr">cssSourceMap</span>:<span class="literal">false</span>,</span><br><span class="line">                        <span class="attr">transformToRequire</span>:&#123;&#125;,</span><br><span class="line">                    &#125;,</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">loader</span>: <span class="string">&#x27;eslint-loader&#x27;</span>,</span><br><span class="line">                    <span class="attr">options</span>: &#123;</span><br><span class="line">                        <span class="attr">emitWarning</span>: <span class="literal">true</span>,</span><br><span class="line">                        <span class="attr">emitError</span>: <span class="literal">true</span>,</span><br><span class="line">                        <span class="attr">failOnError</span>: <span class="literal">true</span>,</span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span></span><br><span class="line">        &#125;,</span><br><span class="line">    ]</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>plugins<br>æˆ‘è¿˜æ²¡è®¤çœŸå¼„æ‡‚pluginsï¼Œå®ƒå¥½åƒæœ‰å¾ˆå¤šå¥½ç”¨çš„åŠŸèƒ½ã€‚æ¯”å¦‚å‹ç¼©jsæˆ–è€…ç”Ÿæˆå¥½çš„é™æ€èµ„æºå¢åŠ ç‰ˆæœ¬å·ã€‚å¾…ç ”ç©¶ <em><strong>@todo</strong></em></li>
</ul>
<hr>
<p>å¸¸è§é—®é¢˜ï¼š<br>1ã€webpackæ‰“åŒ…åŸç†ï¼Ÿ<br>2ã€loaderï¼Œpluginsåˆ†åˆ«æ˜¯ï¼Ÿ<br>3ã€çƒ­æ›´æ–°åŸç†æ˜¯ï¼Ÿ<br>4ã€webpackæ€§èƒ½ä¼˜åŒ–çš„æ–¹æ³•ï¼Ÿ</p>
<hr>
<ul>
<li><p>webpackçš„æ‰“åŒ…åŸç†ï¼š(æ ‘çŠ¶ä¾èµ–)</p>
<ul>
<li>åˆ©ç”¨babelå®Œæˆä»£ç è½¬æ¢,å¹¶ç”Ÿæˆå•ä¸ªæ–‡ä»¶çš„ä¾èµ–.</li>
<li>ä»å…¥å£å¼€å§‹é€’å½’åˆ†æï¼Œå¹¶ç”Ÿæˆä¾èµ–å›¾è°±</li>
<li>å°†å„ä¸ªå¼•ç”¨æ¨¡å—æ‰“åŒ…ä¸ºä¸€ä¸ª<code>ç«‹å³æ‰§è¡Œ</code>å‡½æ•°</li>
<li>å°†æœ€ç»ˆçš„bundleæ–‡ä»¶å†™å…¥bundle.jsä¸­</li>
</ul>
</li>
<li><p>loaderå…¶å®å°±æ˜¯ä¸€ä¸ª<code>Node.js</code> æ¨¡å—ï¼Œè¿™ä¸ªæ¨¡å—éœ€è¦å¯¼å‡ºä¸€ä¸ªå‡½æ•°</p>
</li>
</ul>
]]></content>
      <tags>
        <tag>å·¥å…· webpack</tag>
      </tags>
  </entry>
  <entry>
    <title>äº‹ä»¶</title>
    <url>/2018/07/27/%E4%BA%8B%E4%BB%B6/</url>
    <content><![CDATA[<p>ä»‹ç»ä¸‹äº‹ä»¶æµï¼š<br>ä¸‰ä¸ªé˜¶æ®µï¼šæ•è·ã€ç›®æ ‡ã€å†’æ³¡<br><img src="/%E4%BA%8B%E4%BB%B6/%E4%BA%8B%E4%BB%B6%E6%B5%81.jpg" alt="äº‹ä»¶æµ"></p>
<p>å†’æ³¡ï¼Œå­—é¢ä¸Šç†è§£ï¼Œå°±æ˜¯ä»ä¸‹å¾€ä¸Šå†’æ³¡ï¼Œå’•å™œå’•å™œï½å¯ä»¥ç†è§£æˆä»å…·ä½“èŠ‚ç‚¹åˆ°ä¸å…·ä½“èŠ‚ç‚¹çš„äº‹ä»¶æµï¼ˆ<code>addEventListener</code>é»˜è®¤ç›‘å¬é€‰é¡¹ï¼‰</p>
<p>æ•è·ï¼Œä¸å†’æ³¡ç›¸åï¼Œå°±æ˜¯ä»å¤§èŠ‚ç‚¹ä¸€ç›´å¾€ä¸‹è·å–äº‹ä»¶æµï¼Œç›´åˆ°å…·ä½“èŠ‚ç‚¹</p>
<h3 id="äº‹ä»¶å§”æ‰˜"><a href="#äº‹ä»¶å§”æ‰˜" class="headerlink" title="äº‹ä»¶å§”æ‰˜"></a>äº‹ä»¶å§”æ‰˜</h3><p>å¤–çº§å…ƒç´ è¢«å§”æ‰˜ï¼Œå½“å­çº§å…ƒç´ è¢«è§¦å‘äº‹ä»¶æ—¶ï¼Œç”±å¤–çº§å…ƒç´ ç»Ÿä¸€å»å¤„ç†äº‹ä»¶ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// jq</span></span><br><span class="line">$(<span class="string">&#x27;.top_wrapper a&#x27;</span>).each(<span class="function"><span class="keyword">function</span> (<span class="params">index,item</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> aLink = $(item).attr(<span class="string">&#x27;href&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (!aLink.includes(<span class="string">&#x27;?&#x27;</span>)) &#123;</span><br><span class="line">        aLink += <span class="string">&#x27;?&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (coupon) &#123;</span><br><span class="line">        aLink +=<span class="string">`&amp;coupon=<span class="subst">$&#123;coupon&#125;</span>`</span>;</span><br><span class="line">        $(item).attr(<span class="string">&#x27;href&#x27;</span>,aLink );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (qd) &#123;</span><br><span class="line">        aLink +=<span class="string">`&amp;qd=<span class="subst">$&#123;qd&#125;</span>`</span>;</span><br><span class="line">        $(item).attr(<span class="string">&#x27;href&#x27;</span>,aLink );</span><br><span class="line">    &#125;</span><br><span class="line">    $(item).attr(<span class="string">&#x27;href&#x27;</span>, aLink);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"> <span class="comment">// åŸç”Ÿ</span></span><br><span class="line">    &lt;ul id=<span class="string">&quot;list&quot;</span>&gt;</span><br><span class="line">        <span class="xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">        <span class="xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">        <span class="xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">        <span class="xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>4<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line">    <span class="keyword">var</span> list = <span class="built_in">document</span>.querySelector(<span class="string">&#x27;#list&#x27;</span>)</span><br><span class="line">    list.addEventListener(<span class="string">&#x27;click&#x27;</span>,<span class="function"><span class="keyword">function</span> (<span class="params">e</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(e.target.tagName === <span class="string">&#x27;LI&#x27;</span>)&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;å½“å‰å…ƒç´ äº‹ä»¶è§¦å‘æˆåŠŸ&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="äº‹ä»¶ç›‘å¬"><a href="#äº‹ä»¶ç›‘å¬" class="headerlink" title="äº‹ä»¶ç›‘å¬"></a>äº‹ä»¶ç›‘å¬</h3><p><code>addEventListener(eventName,function,bool)</code> // eventNameäº‹ä»¶å functionæ˜¯è§¦å‘çš„å‡½æ•° boolä¸ºtrueæ—¶æ˜¯æ•è· é»˜è®¤æ˜¯falseå†’æ³¡</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;ul id=<span class="string">&quot;list&quot;</span>&gt;</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>div<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>4<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line">&lt;/ul&gt;</span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">var</span> list = <span class="built_in">document</span>.querySelector(<span class="string">&#x27;#list&#x27;</span>)</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    list.addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">// elem.closest(selector) æ–¹æ³•è¿”å›ä¸ selector åŒ¹é…çš„æœ€è¿‘çš„ç¥–å…ˆã€‚&#x27;</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">// åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä»æºå…ƒç´ å¼€å§‹å‘ä¸Šå¯»æ‰¾ &lt;li&gt;ã€‚</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="comment">// é™å®šä¸è¶…å‡ºul#listçš„èŒƒå›´</span></span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="keyword">let</span> li = e.target.closest(<span class="string">&#x27;li&#x27;</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="keyword">if</span> (!li) <span class="keyword">return</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="keyword">if</span>(!list.contains(li)) <span class="keyword">return</span>;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">        <span class="built_in">console</span>.log(li)</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;)</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<h3 id="äº‹ä»¶ç»‘å®š"><a href="#äº‹ä»¶ç»‘å®š" class="headerlink" title="äº‹ä»¶ç»‘å®š"></a>äº‹ä»¶ç»‘å®š</h3><p>(1) å†…è” (ä¼˜å…ˆçº§æœ€é«˜)</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;æŒ‰é’®&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;alert(1);&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>(2) å¯¹è±¡.äº‹ä»¶</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;input type=<span class="string">&quot;button&quot;</span> value=<span class="string">&quot;æŒ‰é’®&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> bt = <span class="built_in">document</span>.getElementsBytagname(<span class="string">&quot;input&quot;</span>)[<span class="number">0</span>]</span><br><span class="line">bt.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    alert(<span class="number">2</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<div class="tip">ä»¥ä¸Šä¸¤ç§æ–¹å¼åªèƒ½ç»‘å®šä¸€ä¸ªäº‹ä»¶</div>

<p>(3) addEventListener</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;input type=<span class="string">&quot;button&quot;</span> value=<span class="string">&quot;æŒ‰é’®&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> bt = <span class="built_in">document</span>.getElementsBytagname(<span class="string">&quot;input&quot;</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">bt.addEventListener(<span class="string">&#x27;click&#x27;</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>event.stopPropagation: é˜»æ­¢æ•è·å’Œå†’æ³¡é˜¶æ®µä¸­å½“å‰äº‹ä»¶çš„è¿›ä¸€æ­¥ä¼ æ’­ã€‚<br>event.preventDefault: é˜»æ­¢é»˜è®¤è¡Œä¸º,è°ƒç”¨äº†åå°±ä¼šå–æ¶ˆäº‹ä»¶çš„æ‰§è¡Œã€‚</p>
<hr>
<p>å‚è€ƒï¼š<br><a href="https://segmentfault.com/a/1190000013434835">segment</a><br><a href="https://zh.javascript.info/event-delegation">javascript.info</a><br><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Event/stopPropagation">event.stopPropogation</a></p>
]]></content>
      <tags>
        <tag>äº‹ä»¶ JS</tag>
      </tags>
  </entry>
  <entry>
    <title>åå‡½æ•°</title>
    <url>/2020/07/02/%E5%81%8F%E5%87%BD%E6%95%B0/</url>
    <content><![CDATA[<p>æˆ‘çš„ç†è§£æ˜¯ï¼Œä¼ å…¥å¹¶ç¼“å­˜å›ºå®šçš„å‚æ•°ï¼Œè¿”å›æŒ‡å®šçš„å‡½æ•°ã€‚<br>è€Œä¸”æ˜¯ä¸€ç§ç‰¹åˆ«çš„æŸ¯é‡ŒåŒ–ã€‚<br>æŸ¯é‡ŒåŒ–æ˜¯ä¸€å‚å˜å¤šå‚ã€‚<br>åå‡½æ•°æ˜¯å‰é¢çš„å‚æ•°ä¼šå¯¼è‡´åæ¥returnçš„å‡½æ•°ä¸ä¸€æ ·ã€‚ä¹¦é¢ç‚¹è®²ï¼Œå°±æ˜¯æŒ‡å®šéƒ¨åˆ†å‚æ•°ï¼Œæ¥äº§ç”Ÿä¸€ä¸ªæ–°çš„å®šåˆ¶å‡½æ•°ã€‚</p>
<p>å‚è€ƒï¼š<br><a href="https://blog.csdn.net/qq_15241071/article/details/80036346">blog</a></p>
]]></content>
      <tags>
        <tag>JS</tag>
      </tags>
  </entry>
  <entry>
    <title>å…‹éš†å¯¹è±¡&amp;&amp;æ•°ç»„ï¼ˆä¸€ï¼‰</title>
    <url>/2020/07/13/%E5%85%8B%E9%9A%86%E5%AF%B9%E8%B1%A1&amp;&amp;%E6%95%B0%E7%BB%84%EF%BC%88%E4%B8%80%EF%BC%89/</url>
    <content><![CDATA[<h4 id="1-ä»æ•°æ®ç±»å‹è¯´èµ·"><a href="#1-ä»æ•°æ®ç±»å‹è¯´èµ·" class="headerlink" title="1 ä»æ•°æ®ç±»å‹è¯´èµ·"></a>1 ä»æ•°æ®ç±»å‹è¯´èµ·</h4><p><code>JavaScript</code>çš„æ•°æ®ç±»å‹ï¼š</p>
<ul>
<li>åŸºæœ¬ç±»å‹ï¼š <code>Nullï¼Œundefinedï¼Œnumberï¼Œstringï¼ŒBoolean</code> å­˜æ”¾åœ¨<code>æ ˆå†…å­˜</code>çš„ç®€å•æ•°æ®ï¼Œå¯ä»¥ç›´æ¥è®¿é—®</li>
<li>å¼•ç”¨ç±»å‹ï¼š<code>Arrayï¼ŒObjectï¼ŒFunction</code> å­˜æ”¾åœ¨<code>å †å†…å­˜</code>ï¼Œå­˜æ”¾çš„æ˜¯è¯¥å¯¹è±¡çš„<code>åœ°å€æŒ‡é’ˆ</code></li>
</ul>
<h4 id="2-æ·±æµ…æ‹·è´ç”±æ¥"><a href="#2-æ·±æµ…æ‹·è´ç”±æ¥" class="headerlink" title="2 æ·±æµ…æ‹·è´ç”±æ¥"></a>2 æ·±æµ…æ‹·è´ç”±æ¥</h4><p>å¼•ç”¨ç±»å‹çš„æ•°æ®ï¼Œå› ä¸ºæŒ‡å‘æŒ‡é’ˆçš„é—®é¢˜ï¼Œ<code>æµ…æ‹·è´</code>å°±ä¼šå¯¼è‡´æŒ‡å‘åŒä¸€å¤„ï¼Œé‚£ä¹ˆä¿®æ”¹æ‹·è´çš„ä»»ä¸€è€…ï¼Œéƒ½ä¼š<code>å¯¼è‡´å…¨éƒ¨éƒ½æ”¹</code>äº†ã€‚<br>è¿™æ—¶å€™ï¼Œå°±éœ€è¦<code>æ·±æ‹·è´</code>ï¼Œå®ƒå¯ä»¥å¼€è¾Ÿæ–°çš„å†…å­˜åœ°å€ï¼Œè®©æ‹·è´çš„å¯¹è±¡ä»¬æŒ‡å‘ä¸åŒï¼Œè¿™æ ·å°±<code>ä¸ä¼šäº’ç›¸å½±å“</code>äº†ã€‚</p>
<h4 id="3-æµ…æ‹·è´CODE"><a href="#3-æµ…æ‹·è´CODE" class="headerlink" title="3 æµ…æ‹·è´CODE"></a>3 æµ…æ‹·è´CODE</h4><p><code>æµ…æ‹·è´</code>å°±æ˜¯æ‹·è´<code>ç¬¬ä¸€å±‚çš„åŸºæœ¬ç±»å‹å€¼</code>ï¼Œä»¥åŠ<code>ç¬¬ä¸€å±‚çš„å¼•ç”¨ç±»å‹åœ°å€</code>ã€‚<br>ï¼ˆ1ï¼‰forâ€¦inâ€¦éå†å±æ€§</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">shallowClone</span>(<span class="params">copyObj</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> obj = &#123;&#125;;</span><br><span class="line">  <span class="keyword">for</span> ( <span class="keyword">var</span> i <span class="keyword">in</span> copyObj) &#123;</span><br><span class="line">    obj[i] = copyObj[i];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> obj;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> x = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">b</span>: &#123; <span class="attr">f</span>: &#123; <span class="attr">g</span>: <span class="number">1</span> &#125; &#125;,</span><br><span class="line">  <span class="attr">c</span>: [ <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ]</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> y = shallowClone(x);</span><br><span class="line"><span class="built_in">console</span>.log(y.b.f === x.b.f);     <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>ï¼ˆ2ï¼‰Object.assign()<br>å°†æ‰€æœ‰å¯æšä¸¾å±æ€§çš„å€¼ä»ä¸€ä¸ªæˆ–å¤šä¸ªæºå¯¹è±¡å¤åˆ¶åˆ°ç›®æ ‡å¯¹è±¡ã€‚å®ƒå°†è¿”å›ç›®æ ‡å¯¹è±¡ã€‚åªéå†ä¸€å±‚<br>åŸºç¡€ç”¨æ³•</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> target = &#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span> &#125;;</span><br><span class="line"><span class="keyword">const</span> source = &#123; <span class="attr">b</span>: <span class="number">4</span>, <span class="attr">c</span>: <span class="number">5</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> returnedTarget = <span class="built_in">Object</span>.assign(target, source);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(target);</span><br><span class="line"><span class="comment">// expected output: Object &#123; a: 1, b: 4, c: 5 &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(returnedTarget);</span><br><span class="line"><span class="comment">// expected output: Object &#123; a: 1, b: 4, c: 5 &#125;</span></span><br></pre></td></tr></table></figure>

<p>å¤åˆ¶å¯¹è±¡ï¼ˆæµ…ï¼‰</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123; <span class="attr">a</span>: <span class="number">1</span> &#125;;</span><br><span class="line"><span class="keyword">const</span> copy = <span class="built_in">Object</span>.assign(&#123;&#125;, obj);</span><br><span class="line"><span class="built_in">console</span>.log(copy); <span class="comment">// &#123; a: 1 &#125;</span></span><br></pre></td></tr></table></figure>

<p>(3) <code>Array</code>çš„<code>slice&amp;concat</code>æ–¹æ³•<br>å®ƒä»¬è™½ç„¶åœ¨demoé‡Œçœ‹èµ·æ¥åƒæ·±ï¼Œå…¶å®ä¹Ÿæ˜¯æµ…æ‹·è´</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> array = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]; </span><br><span class="line"><span class="keyword">var</span> array_shallow = array; </span><br><span class="line"><span class="keyword">var</span> array_concat = array.concat(); </span><br><span class="line"><span class="keyword">var</span> array_slice = array.slice(<span class="number">0</span>); </span><br><span class="line"><span class="built_in">console</span>.log(array === array_shallow); <span class="comment">//true </span></span><br><span class="line"><span class="built_in">console</span>.log(array === array_slice); <span class="comment">//falseï¼Œâ€œçœ‹èµ·æ¥â€åƒæ·±æ‹·è´</span></span><br><span class="line"><span class="built_in">console</span>.log(array === array_concat); <span class="comment">//falseï¼Œâ€œçœ‹èµ·æ¥â€åƒæ·±æ‹·è´</span></span><br></pre></td></tr></table></figure>

<p>(4) å±•å¼€è¯­æ³•<code>...</code><br>å¯¹æ•°ç»„å’Œå¯¹è±¡çš„æµ…æ‹·è´ï¼Œç±»ä¼¼Object.assignçš„åŠŸèƒ½ã€‚åªèƒ½ç”¨äºå¯è¿­ä»£å¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ•°ç»„</span></span><br><span class="line"><span class="keyword">var</span> arr1 = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>];</span><br><span class="line"><span class="keyword">var</span> arr2 = [<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line">arr1 = [...arr2, ...arr1]; <span class="comment">// arr1 ç°åœ¨ä¸º [3, 4, 5, 0, 1, 2]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¹è±¡</span></span><br><span class="line"><span class="keyword">var</span> obj1 = &#123; <span class="attr">foo</span>: <span class="string">&#x27;bar&#x27;</span>, <span class="attr">x</span>: <span class="number">42</span> &#125;;</span><br><span class="line"><span class="keyword">var</span> obj2 = &#123; <span class="attr">foo</span>: <span class="string">&#x27;baz&#x27;</span>, <span class="attr">y</span>: <span class="number">13</span> &#125;;</span><br><span class="line"><span class="keyword">var</span> clonedObj = &#123; ...obj1 &#125;;</span><br><span class="line"><span class="comment">// å…‹éš†åçš„å¯¹è±¡: &#123; foo: &quot;bar&quot;, x: 42 &#125;</span></span><br><span class="line"><span class="keyword">var</span> mergedObj = &#123; ...obj1, ...obj2 &#125;;</span><br><span class="line"><span class="comment">// åˆå¹¶åçš„å¯¹è±¡: &#123; foo: &quot;baz&quot;, x: 42, y: 13 &#125;</span></span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>JS æ‹·è´</tag>
      </tags>
  </entry>
  <entry>
    <title>å…‹éš†å¯¹è±¡&amp;&amp;æ•°ç»„ï¼ˆäºŒï¼‰</title>
    <url>/2020/07/13/%E5%85%8B%E9%9A%86%E5%AF%B9%E8%B1%A1&amp;&amp;%E6%95%B0%E7%BB%84%EF%BC%88%E4%BA%8C%EF%BC%89/</url>
    <content><![CDATA[<h4 id="4-æ·±æ‹·è´CODE"><a href="#4-æ·±æ‹·è´CODE" class="headerlink" title="4. æ·±æ‹·è´CODE"></a>4. æ·±æ‹·è´CODE</h4><p><code>æ·±æ‹·è´ = æµ…æ‹·è´ + é‡åˆ°å¯¹è±¡æ—¶é€’å½’æ‹·è´</code><br>ï¼ˆ1ï¼‰æœ€ç®€å•è«è¿‡äºå­—ç¬¦åºåˆ—åŒ–ï¼Œå†parseååºåˆ—åŒ–<br>è¯­æ³•ï¼šJSON.parse(JSON.stringify) </p>
<div class="tip">
åç«¯ä¼ å›çš„å˜é‡ä¸€èˆ¬ç”¨å®ƒæ¥æ‹·è´è¶³ä»¥åº”å¯¹ã€‚åªæ˜¯ï¼Œ
1ã€ä¼šå¿½ç•¥ undefined
                      
<p>2ã€ä¼šå¿½ç•¥ symbol</p>
<p>3ã€ä¸èƒ½åºåˆ—åŒ–å‡½æ•°</p>
<p>4ã€ä¸èƒ½è§£å†³å¾ªç¯å¼•ç”¨çš„å¯¹è±¡</p>
<p>5ã€ä¸èƒ½æ­£ç¡®å¤„ç†new Date()</p>
<p>6ã€ä¸èƒ½å¤„ç†æ­£åˆ™</p>
<p>undefinedã€symbol å’Œå‡½æ•°è¿™ä¸‰ç§æƒ…å†µï¼Œä¼šç›´æ¥å¿½ç•¥ã€‚æ‹·è´å‡½æ•°ä¼šundefinedï¼Œæ‹·è´æ­£åˆ™ä¼šObject{}ï¼Œæ²¡æ‹·å®Œæ•´ã€‚</p>
</div>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// undefined symbol å‡½æ•°ç¤ºä¾‹</span></span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;muyiy&#x27;</span>,</span><br><span class="line">    <span class="attr">a</span>: <span class="literal">undefined</span>,</span><br><span class="line">    <span class="attr">b</span>: <span class="built_in">Symbol</span>(<span class="string">&#x27;muyiy&#x27;</span>),</span><br><span class="line">    <span class="attr">c</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(obj);</span><br><span class="line"><span class="comment">// &#123;</span></span><br><span class="line"><span class="comment">// 	name: &quot;muyiy&quot;, </span></span><br><span class="line"><span class="comment">// 	a: undefined, </span></span><br><span class="line"><span class="comment">//  b: Symbol(muyiy), </span></span><br><span class="line"><span class="comment">//  c: Æ’ ()</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> b = <span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(obj));</span><br><span class="line"><span class="built_in">console</span>.log(b);</span><br><span class="line"><span class="comment">// &#123;name: &quot;muyiy&quot;&#125;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å¾ªç¯å¼•ç”¨</span></span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    <span class="attr">a</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">b</span>: &#123;</span><br><span class="line">        <span class="attr">c</span>: <span class="number">2</span>,</span><br><span class="line">   		<span class="attr">d</span>: <span class="number">3</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">obj.a = obj.b;</span><br><span class="line">obj.b.c = obj.a;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> b = <span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(obj));</span><br><span class="line"><span class="comment">// Uncaught TypeError: Converting circular structure to JSON</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// new Dateè½¬åŒ–ç»“æœä¸æ­£ç¡® ç»“æœæ–¹æ¡ˆæ˜¯è½¬ä¸ºæ—¶é—´æˆ³</span></span><br><span class="line"><span class="keyword">let</span> date = (<span class="keyword">new</span> <span class="built_in">Date</span>()).valueOf();</span><br><span class="line"><span class="built_in">JSON</span>.stringify(date); </span><br><span class="line"><span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(date)); <span class="comment">// å’Œä¸Šé¢çš„è¾“å‡ºæ˜¯åŒä¸€ä¸ªå€¼</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ­£åˆ™</span></span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;muyiy&quot;</span>,</span><br><span class="line">    <span class="attr">a</span>: <span class="regexp">/&#x27;123&#x27;/</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(obj);</span><br><span class="line"><span class="comment">// &#123;name: &quot;muyiy&quot;, a: /&#x27;123&#x27;/&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> b = <span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(obj));</span><br><span class="line"><span class="built_in">console</span>.log(b); <span class="comment">// &#123;name: &quot;muyiy&quot;, a: &#123;&#125;&#125;</span></span><br></pre></td></tr></table></figure>

<p>(2) ç®€æ˜“æ·±æ‹·è´</p>
<p>ç¬¬ä¸€ç‰ˆ</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è¿™ä¸ªè™½ç„¶èƒ½ç®€å•å®ç° å´æœ‰ä»¥ä¸‹é—®é¢˜</span></span><br><span class="line"><span class="comment">// 1ã€æ²¡æœ‰å¯¹ä¼ å…¥å‚æ•°è¿›è¡Œæ ¡éªŒï¼Œä¼ å…¥ null æ—¶åº”è¯¥è¿”å› null è€Œä¸æ˜¯ &#123;&#125;</span></span><br><span class="line"><span class="comment">// 2ã€å¯¹äºå¯¹è±¡çš„åˆ¤æ–­é€»è¾‘ä¸ä¸¥è°¨ï¼Œå› ä¸º typeof null === &#x27;object&#x27;</span></span><br><span class="line"><span class="comment">// 3ã€æ²¡æœ‰è€ƒè™‘æ•°ç»„çš„å…¼å®¹</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cloneDeep1</span>(<span class="params">source</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> target = &#123;&#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> source) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">Object</span>.prototype.hasOwnProperty.call(source, key)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">typeof</span> source[key] === <span class="string">&#x27;object&#x27;</span>) &#123;</span><br><span class="line">                target[key] = cloneDeep1(source[key]); <span class="comment">// æ³¨æ„è¿™é‡Œ å¦‚æœæ˜¯å¯¹è±¡çš„æ—¶å€™é€’å½’è°ƒç”¨</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                target[key] = source[key];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> target;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç¬¬äºŒç‰ˆ ï¼ˆéå¯¹è±¡çš„è¿”å›è‡ªèº«ä»¥åŠæ•°ç»„çš„æ”¯æŒï¼‰</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isObject</span>(<span class="params">obj</span>) </span>&#123;<span class="comment">// éå¯¹è±¡è¿”å›è‡ªèº«</span></span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">typeof</span> obj === <span class="string">&#x27;object&#x27;</span> &amp;&amp; obj != <span class="literal">null</span>; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cloneDeep2</span>(<span class="params">source</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!isObject(source)) <span class="keyword">return</span> source; <span class="comment">// éå¯¹è±¡è¿”å›è‡ªèº«</span></span><br><span class="line">    <span class="keyword">var</span> target = <span class="built_in">Array</span>.isArray(source) ? [] : &#123;&#125;; <span class="comment">// åˆå§‹å€¼ä¸ºç©ºæ•°ç»„æˆ–ç©ºå¯¹è±¡</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> source) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">Object</span>.prototype.hasOwnProperty.call(source, key)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (isObject(source[key])) &#123;</span><br><span class="line">                target[key] = cloneDeep2(source[key]); <span class="comment">// æ³¨æ„è¿™é‡Œ</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                target[key] = source[key];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> target;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ä¸Šé¢æµ‹è¯•ç”¨ä¾‹æµ‹è¯•ä¸€ä¸‹</span></span><br><span class="line"><span class="keyword">var</span> b = cloneDeep2(a);</span><br><span class="line"><span class="built_in">console</span>.log(b);</span><br><span class="line"><span class="comment">// &#123; </span></span><br><span class="line"><span class="comment">//   name: &#x27;muyiy&#x27;, </span></span><br><span class="line"><span class="comment">//   book: &#123; title: &#x27;You Don\&#x27;t Know JS&#x27;, price: &#x27;45&#x27; &#125;,</span></span><br><span class="line"><span class="comment">//   a1: undefined,</span></span><br><span class="line"><span class="comment">//   a2: null,</span></span><br><span class="line"><span class="comment">//   a3: 123</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br></pre></td></tr></table></figure>

<p>ç¬¬ä¸‰ç‰ˆ ï¼ˆæ”¯æŒå¯¹è±¡å¾ªç¯å¼•ç”¨ï¼‰</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cloneDeep3</span>(<span class="params">source, hash = <span class="keyword">new</span> <span class="built_in">WeakMap</span>()</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!isObject(source)) <span class="keyword">return</span> source; </span><br><span class="line">    <span class="keyword">if</span> (hash.has(source)) <span class="keyword">return</span> hash.get(source); <span class="comment">// æ–°å¢ä»£ç ï¼ŒæŸ¥å“ˆå¸Œè¡¨</span></span><br><span class="line">      </span><br><span class="line">    <span class="keyword">var</span> target = <span class="built_in">Array</span>.isArray(source) ? [] : &#123;&#125;;</span><br><span class="line">    hash.set(source, target); <span class="comment">// æ–°å¢ä»£ç ï¼Œå“ˆå¸Œè¡¨è®¾å€¼</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> source) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">Object</span>.prototype.hasOwnProperty.call(source, key)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (isObject(source[key])) &#123;</span><br><span class="line">                target[key] = cloneDeep3(source[key], hash); <span class="comment">// æ–°å¢ä»£ç ï¼Œä¼ å…¥å“ˆå¸Œè¡¨</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                target[key] = source[key];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> target;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> a = &#123;</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&quot;muyiy&quot;</span>,</span><br><span class="line">        <span class="attr">a1</span>: <span class="literal">undefined</span>,</span><br><span class="line">        <span class="attr">a2</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">a3</span>: <span class="number">123</span>,</span><br><span class="line">        <span class="attr">book</span>: &#123;<span class="attr">title</span>: <span class="string">&quot;You Don&#x27;t Know JS&quot;</span>, <span class="attr">price</span>: <span class="string">&quot;45&quot;</span>&#125;,</span><br><span class="line">    &#125;</span><br><span class="line">    a.circleRef = a <span class="comment">// circleRefæ˜¯ä¸ªå¾ˆå¥‡ç‰¹çš„å±æ€§ï¼Œå®ƒèƒ½åœ¨è‡ªèº«å­˜è‡ªå·±ï¼Œå¹¶æ°¸ä¹…å¾ªç¯ï¼Œ</span></span><br><span class="line">    <span class="keyword">var</span> b = cloneDeep3(a)</span><br><span class="line">    <span class="built_in">console</span>.log(b)</span><br></pre></td></tr></table></figure>

<p>ç¬¬å››ç‰ˆ ï¼ˆä¿å­˜å¼•ç”¨å…³ç³»ï¼‰</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ•°ç»„ç‰ˆ</span></span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">cloneDeep3</span>(<span class="params">source, uniqueList</span>) </span>&#123;</span><br><span class="line">     <span class="keyword">if</span> (!isObject(source)) <span class="keyword">return</span> source</span><br><span class="line">     <span class="keyword">if</span> (!uniqueList) uniqueList = []</span><br><span class="line"></span><br><span class="line">     <span class="keyword">var</span> target = <span class="built_in">Array</span>.isArray(source) ? [] : &#123;&#125;</span><br><span class="line"></span><br><span class="line">     <span class="keyword">var</span> uniqueData = find(uniqueList, source)</span><br><span class="line">     </span><br><span class="line">     <span class="comment">// æ•°æ®å·²ç»å­˜åœ¨ï¼Œè¿”å›ä¿å­˜çš„æ•°æ® å¦‚æœreturnè¿™ä¸€æ­¥ï¼Œä¼šè·³åˆ°ä¸‹æ–¹çš„return target</span></span><br><span class="line">     <span class="keyword">if</span>(uniqueData) &#123;</span><br><span class="line">         <span class="keyword">return</span> uniqueData.target</span><br><span class="line">     &#125;</span><br><span class="line">     </span><br><span class="line">     <span class="comment">// æ•°æ®ä¸å­˜åœ¨ï¼Œä¿å­˜æºæ•°æ®ï¼Œä»¥åŠå¯¹åº”çš„å¼•ç”¨</span></span><br><span class="line">     uniqueList.push(&#123; <span class="comment">// ç”¨æ•°ç»„å­˜å‚¨é”®å€¼å¯¹</span></span><br><span class="line">         <span class="attr">source</span>: source,</span><br><span class="line">         <span class="attr">target</span>: target</span><br><span class="line">     &#125;)</span><br><span class="line"></span><br><span class="line">     <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> source) &#123;</span><br><span class="line">         <span class="keyword">if</span>(<span class="built_in">Object</span>.prototype.hasOwnProperty.call(source,key)) &#123;</span><br><span class="line">             <span class="keyword">if</span> (isObject(source[key])) &#123;</span><br><span class="line">                 target[key] = cloneDeep3(source[key], uniqueList)</span><br><span class="line">             &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                 target[key] = source[key]</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">return</span> target <span class="comment">// targetå¾ˆå€¼å¾—ç©å‘³ï¼Œé€’å½’å®Œäº†åçš„callStackè®©äººæƒŠå¥‡</span></span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">var</span> obj1 = &#123;&#125;;</span><br><span class="line"> <span class="keyword">var</span> obj2 = &#123;<span class="attr">a</span>: obj1, <span class="attr">b</span>: obj1&#125;;</span><br><span class="line"></span><br><span class="line"> <span class="built_in">console</span>.log(obj2.a === obj2.b);</span><br><span class="line"> <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"> <span class="keyword">var</span> obj3 = cloneDeep3(obj2);</span><br><span class="line"> <span class="built_in">console</span>.log(obj3.a === obj3.b)</span><br><span class="line"> <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<p>ç¬¬äº”ç‰ˆ ï¼ˆæ‹·è´Symbolç±»å‹ï¼‰<br>æ€è·¯å°±æ˜¯å…ˆæŸ¥æ‰¾æœ‰æ²¡æœ‰ Symbol å±æ€§ï¼Œå¦‚æœæŸ¥æ‰¾åˆ°åˆ™å…ˆéå†å¤„ç† Symbol æƒ…å†µï¼Œç„¶åå†å¤„ç†æ­£å¸¸æƒ…å†µï¼Œ</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// é€»è¾‘ä»£ç </span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cloneDeep4</span>(<span class="params">source, hash = <span class="keyword">new</span> <span class="built_in">WeakMap</span>()</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!isObject(source)) <span class="keyword">return</span> source; </span><br><span class="line">    <span class="keyword">if</span> (hash.has(source)) <span class="keyword">return</span> hash.get(source); </span><br><span class="line">      </span><br><span class="line">    <span class="keyword">let</span> target = <span class="built_in">Array</span>.isArray(source) ? [] : &#123;&#125;;</span><br><span class="line">    hash.set(source, target);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ============= æ–°å¢ä»£ç </span></span><br><span class="line">    <span class="keyword">let</span> symKeys = <span class="built_in">Object</span>.getOwnPropertySymbols(source); <span class="comment">// æŸ¥æ‰¾ </span></span><br><span class="line">    <span class="keyword">if</span> (symKeys.length) &#123; <span class="comment">// æŸ¥æ‰¾æˆåŠŸ	</span></span><br><span class="line">        symKeys.forEach(<span class="function"><span class="params">symKey</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (isObject(source[symKey])) &#123;</span><br><span class="line">                target[symKey] = cloneDeep4(source[symKey], hash); </span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                target[symKey] = source[symKey];</span><br><span class="line">            &#125;    </span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// =============</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> key <span class="keyword">in</span> source) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">Object</span>.prototype.hasOwnProperty.call(source, key)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (isObject(source[key])) &#123;</span><br><span class="line">                target[key] = cloneDeep4(source[key], hash); </span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                target[key] = source[key];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> target;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æµ‹è¯• å¯ä»¥çœ‹åˆ°æˆåŠŸæ‹·è´äº†Symbolç±»å‹</span></span><br><span class="line"><span class="keyword">var</span> sym1 = <span class="built_in">Symbol</span>(<span class="string">&quot;a&quot;</span>); <span class="comment">// åˆ›å»ºæ–°çš„symbolç±»å‹</span></span><br><span class="line"><span class="keyword">var</span> sym2 = <span class="built_in">Symbol</span>.for(<span class="string">&quot;b&quot;</span>); <span class="comment">// ä»å…¨å±€çš„symbolæ³¨å†Œ?è¡¨è®¾ç½®å’Œå–å¾—symbol</span></span><br><span class="line"></span><br><span class="line">a[sym1] = <span class="string">&quot;localSymbol&quot;</span>;</span><br><span class="line">a[sym2] = <span class="string">&quot;globalSymbol&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> b = cloneDeep4(a);</span><br><span class="line"><span class="built_in">console</span>.log(b);</span><br><span class="line"><span class="comment">// &#123;</span></span><br><span class="line"><span class="comment">// 	name: &quot;muyiy&quot;,</span></span><br><span class="line"><span class="comment">// 	a1: undefined,</span></span><br><span class="line"><span class="comment">//	a2: null,</span></span><br><span class="line"><span class="comment">// 	a3: 123,</span></span><br><span class="line"><span class="comment">// 	book: &#123;title: &quot;You Don&#x27;t Know JS&quot;, price: &quot;45&quot;&#125;,</span></span><br><span class="line"><span class="comment">// 	circleRef: &#123;name: &quot;muyiy&quot;, book: &#123;â€¦&#125;, a1: undefined, a2: null, a3: 123, â€¦&#125;,</span></span><br><span class="line"><span class="comment">//  [Symbol(a)]: &#x27;localSymbol&#x27;,</span></span><br><span class="line"><span class="comment">//  [Symbol(b)]: &#x27;globalSymbol&#x27;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br></pre></td></tr></table></figure>


<p>ç¬¬å…­ç‰ˆ ç ´è§£é€’å½’çˆ†æ ˆ (å¾…ç ”ç©¶@todo)</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cloneDeep5</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> root = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ ˆ</span></span><br><span class="line">    <span class="keyword">const</span> loopList = [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">parent</span>: root,</span><br><span class="line">            <span class="attr">key</span>: <span class="literal">undefined</span>,</span><br><span class="line">            <span class="attr">data</span>: x,</span><br><span class="line">        &#125;</span><br><span class="line">    ];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(loopList.length) &#123;</span><br><span class="line">        <span class="comment">// å¹¿åº¦ä¼˜å…ˆ</span></span><br><span class="line">        <span class="keyword">const</span> node = loopList.pop();</span><br><span class="line">        <span class="keyword">const</span> parent = node.parent;</span><br><span class="line">        <span class="keyword">const</span> key = node.key;</span><br><span class="line">        <span class="keyword">const</span> data = node.data;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆå§‹åŒ–èµ‹å€¼ç›®æ ‡ï¼Œkeyä¸ºundefinedåˆ™æ‹·è´åˆ°çˆ¶å…ƒç´ ï¼Œå¦åˆ™æ‹·è´åˆ°å­å…ƒç´ </span></span><br><span class="line">        <span class="keyword">let</span> res = parent;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> key !== <span class="string">&#x27;undefined&#x27;</span>) &#123;</span><br><span class="line">            res = parent[key] = &#123;&#125;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> k <span class="keyword">in</span> data) &#123;</span><br><span class="line">            <span class="keyword">if</span> (data.hasOwnProperty(k)) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">typeof</span> data[k] === <span class="string">&#x27;object&#x27;</span>) &#123;</span><br><span class="line">                    <span class="comment">// ä¸‹ä¸€æ¬¡å¾ªç¯</span></span><br><span class="line">                    loopList.push(&#123;</span><br><span class="line">                        <span class="attr">parent</span>: res,</span><br><span class="line">                        <span class="attr">key</span>: k,</span><br><span class="line">                        <span class="attr">data</span>: data[k],</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    res[k] = data[k];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> root;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="å°è¯­æ³•ï¼š"><a href="#å°è¯­æ³•ï¼š" class="headerlink" title="å°è¯­æ³•ï¼š"></a>å°è¯­æ³•ï¼š</h4><p>1 Object.keys(..) è¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«æ‰€æœ‰å¯æšä¸¾å±æ€§<br>2 Object.getOwnPropertyNames(..) è¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«æ‰€æœ‰å±æ€§ï¼Œæ— è®ºå®ƒä»¬æ˜¯å¦å¯æšä¸¾<br>3 Object.getOwnPropertyDescriptor() ä¼šè¿”å›å¯¹è±¡çš„å±æ€§çš„æŒ‡å®šæè¿°<br>4 in &amp;&amp; hasOwnProperty</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> anotherObject = &#123;</span><br><span class="line">    <span class="attr">a</span>: <span class="number">1</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ªå…³è”åˆ° anotherObject çš„å¯¹è±¡</span></span><br><span class="line"><span class="keyword">var</span> myObject = <span class="built_in">Object</span>.create( anotherObject );</span><br><span class="line">myObject.b = <span class="number">2</span>;</span><br><span class="line">(<span class="string">&quot;a&quot;</span> <span class="keyword">in</span> myObject); <span class="comment">// true</span></span><br><span class="line">(<span class="string">&quot;b&quot;</span> <span class="keyword">in</span> myObject); <span class="comment">// true</span></span><br><span class="line">myObject.hasOwnProperty( <span class="string">&quot;a&quot;</span> ); <span class="comment">// false</span></span><br><span class="line">myObject.hasOwnProperty( <span class="string">&quot;b&quot;</span> ); <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// (1) in æ“ä½œç¬¦ä¼šæ£€æŸ¥å±æ€§æ˜¯å¦åœ¨å¯¹è±¡åŠå…¶ [[Prototype]] åŸå‹é“¾ä¸­ã€‚</span></span><br><span class="line"><span class="comment">// (2) hasOwnProperty(..) åªä¼šæ£€æŸ¥å±æ€§æ˜¯å¦åœ¨ myObject å¯¹è±¡ä¸­ï¼Œä¸ä¼šæ£€æŸ¥ [[Prototype]] åŸå‹é“¾ã€‚</span></span><br></pre></td></tr></table></figure>
<p>5 WeakMap<br>ç‰¹ç‚¹ï¼šå¼±å¼•ç”¨ï¼Œéœ€ä»¥å¯¹è±¡ä½œä¸ºkeyï¼Œä¸æ‰“æ‰°åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œå¯ä»¥é€šè¿‡setï¼Œgetæ¥å–å€¼</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> wm1 = <span class="keyword">new</span> <span class="built_in">WeakMap</span>(),</span><br><span class="line">      wm2 = <span class="keyword">new</span> <span class="built_in">WeakMap</span>(),</span><br><span class="line">      wm3 = <span class="keyword">new</span> <span class="built_in">WeakMap</span>();</span><br><span class="line"><span class="keyword">const</span> o1 = &#123;&#125;,</span><br><span class="line">      o2 = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,</span><br><span class="line">      o3 = <span class="built_in">window</span>;</span><br><span class="line"></span><br><span class="line">wm1.set(o1, <span class="number">37</span>);</span><br><span class="line">wm1.set(o2, <span class="string">&quot;azerty&quot;</span>);</span><br><span class="line">wm2.set(o1, o2); <span class="comment">// valueå¯ä»¥æ˜¯ä»»æ„å€¼,åŒ…æ‹¬ä¸€ä¸ªå¯¹è±¡æˆ–ä¸€ä¸ªå‡½æ•°</span></span><br><span class="line">wm2.set(o3, <span class="literal">undefined</span>);</span><br><span class="line">wm2.set(wm1, wm2); <span class="comment">// é”®å’Œå€¼å¯ä»¥æ˜¯ä»»æ„å¯¹è±¡,ç”šè‡³å¦å¤–ä¸€ä¸ªWeakMapå¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">wm1.get(o2); <span class="comment">// &quot;azerty&quot;</span></span><br><span class="line">wm2.get(o2); <span class="comment">// undefined,wm2ä¸­æ²¡æœ‰o2è¿™ä¸ªé”®</span></span><br><span class="line">wm2.get(o3); <span class="comment">// undefined,å€¼å°±æ˜¯undefined</span></span><br><span class="line"></span><br><span class="line">wm1.has(o2); <span class="comment">// true</span></span><br><span class="line">wm2.has(o2); <span class="comment">// false</span></span><br><span class="line">wm2.has(o3); <span class="comment">// true (å³ä½¿å€¼æ˜¯undefined)</span></span><br><span class="line"></span><br><span class="line">wm3.set(o1, <span class="number">37</span>);</span><br><span class="line">wm3.get(o1); <span class="comment">// 37</span></span><br><span class="line"></span><br><span class="line">wm1.has(o1);   <span class="comment">// true</span></span><br><span class="line">wm1.delete(o1);</span><br><span class="line">wm1.has(o1);   <span class="comment">// false</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>å‚è€ƒ<br><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/assign">MDN Object.assign</a><br><a href="https://github.com/wengjq/Blog/issues/3">wengjq issue</a><br><a href="https://github.com/yygmind/blog/issues/25">yygmind issue</a><br><a href="https://github.com/yygmind/blog/labels/%E6%B7%B1%E6%B5%85%E6%8B%B7%E8%B4%9D%E5%8E%9F%E7%90%86">yygmind æ·±æµ…æ‹·è´æ±‡æ€»</a><br><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/Spread_syntax">å±•å¼€è¯­æ³•</a><br><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/getOwnPropertyDescriptor">MDN Object.getOwnPropertyDescription</a><br><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/WeakMap">MDN WeakMap</a><br><a href="https://www.codenong.com/29413222/">ç¥å¥‡çš„weakmapç§‘æ™®è´´</a><br><a href="https://segmentfault.com/a/1190000016672263">é¢œæµ·é•œ</a></p>
]]></content>
      <tags>
        <tag>JS æ‹·è´</tag>
      </tags>
  </entry>
  <entry>
    <title>å‡½æ•°æŸ¯é‡ŒåŒ–</title>
    <url>/2020/05/27/%E5%87%BD%E6%95%B0%E6%9F%AF%E9%87%8C%E5%8C%96/</url>
    <content><![CDATA[<h3 id="1-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1. æ˜¯ä»€ä¹ˆï¼Ÿ"></a>1. æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>æŸ¯é‡ŒåŒ–æ˜¯ä¸€ç§å°†ä½¿ç”¨<code>å¤šä¸ªå‚æ•°</code>çš„ä¸€ä¸ªå‡½æ•°<code>è½¬æ¢æˆ</code>ä¸€ç³»åˆ—ä½¿ç”¨<code>ä¸€ä¸ªå‚æ•°</code>çš„å‡½æ•°çš„ç¼–ç¨‹æŠ€æœ¯ã€‚<br>ç®€å•ç¤ºä¾‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">a, b</span>) </span>&#123; <span class="keyword">return</span> a + b; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‰§è¡Œ add å‡½æ•°ï¼Œä¸€æ¬¡ä¼ å…¥ä¸¤ä¸ªå‚æ•°å³å¯</span></span><br><span class="line">add(<span class="number">1</span>, <span class="number">2</span>) <span class="comment">// 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡è®¾æœ‰ä¸€ä¸ª curry å‡½æ•°å¯ä»¥åšåˆ°æŸ¯é‡ŒåŒ–</span></span><br><span class="line"><span class="keyword">var</span> addCurry = curry(add);</span><br><span class="line"></span><br><span class="line">addCurry(<span class="number">1</span>)(<span class="number">2</span>) <span class="comment">// è°ƒç”¨è·Ÿ add (1ï¼Œ2)æ˜¯ä¸€æ ·çš„</span></span><br></pre></td></tr></table></figure>

<h3 id="2-curryå‡½æ•°çš„ç¼–å†™"><a href="#2-curryå‡½æ•°çš„ç¼–å†™" class="headerlink" title="2. curryå‡½æ•°çš„ç¼–å†™"></a>2. curryå‡½æ•°çš„ç¼–å†™</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"><span class="doctag">@feature </span>æ™®é€šcurryå‡½æ•°çš„ç¼–å†™</span></span><br><span class="line"><span class="comment"> arguments å¯¹è±¡æ˜¯å†…éƒ¨å‡½æ•°çš„ã€‚</span></span><br><span class="line"><span class="comment"> å½“è°ƒç”¨(è¿”å›çš„å‡½æ•°)æ—¶ï¼Œå®ƒä¼šåœ¨ç»™å®šç¯å¢ƒä¸­æ‰§è¡Œè¢«ä¼ å…¥çš„å‡½æ•°å¹¶ç»™å‡ºæ‰€æœ‰å‚æ•°ã€‚</span></span><br><span class="line"><span class="comment"> argumentsä¼šè§†ä¸ºæ¯æ¬¡ä¼ çš„å‚æ•°è€Œå®š</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">curry</span>(<span class="params">fn, args</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> length = fn.length;</span><br><span class="line">    args = args || []; <span class="comment">// ç›´åˆ°è¿™ä¸ªæ—¶å€™çš„argumentséƒ½æ˜¯ç±»æ•°ç»„ï¼Œarguments[0] = function(a,b,c)</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> _args = args.slice(<span class="number">0</span>),</span><br><span class="line">            arg, i;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="built_in">arguments</span>.length; i++) &#123;</span><br><span class="line">            arg = <span class="built_in">arguments</span>[i];</span><br><span class="line">            _args.push(arg);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (_args.length &lt; length) &#123; <span class="comment">// è¿™ä¸ªif elseæ˜¯å…³é”®ï¼Œè®©curryå‡½æ•°ä¸€ç›´å¾ªç¯åˆ°ï¼Œå®å‚æ•°æ»¡è¶³å½¢å‚çš„ä¸ªæ•°</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="built_in">this</span>)</span><br><span class="line">            <span class="keyword">return</span> curry.call(<span class="built_in">this</span>, fn, _args);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> fn.apply(<span class="built_in">this</span>, _args);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> fn = curry(<span class="function"><span class="keyword">function</span>(<span class="params">a, b, c</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log([a, b, c]);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">fn(<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>)</span><br><span class="line">fn(<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>)(<span class="string">&quot;c&quot;</span>)</span><br><span class="line">fn(<span class="string">&quot;a&quot;</span>)(<span class="string">&quot;b&quot;</span>)(<span class="string">&quot;c&quot;</span>)</span><br><span class="line">fn(<span class="string">&quot;a&quot;</span>)(<span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸Šé¢å››ç§éƒ½ä¼šå¾—å‡ºè¿™æ ·çš„ç»“æœï¼š [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æå‰è¿”å›çš„ä¾‹å­</span></span><br><span class="line"><span class="keyword">var</span> addEvent = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">window</span>.addEventListener) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">el, type, fn, capture</span>) </span>&#123; <span class="comment">// æå‰è¿”å›</span></span><br><span class="line">            el.addEventListener(type, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">                fn.call(el, e);</span><br><span class="line">            &#125;, capture);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">ele, type, fn</span>) </span>&#123; <span class="comment">// æå‰è¿”å›</span></span><br><span class="line">            el.attachEvent(<span class="string">&#x27;on&#x27;</span> + type, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123; </span><br><span class="line">                fn.call(el, e);</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure>

<h3 id="3-curryå‡½æ•°å†™æ³•çš„å¼•ç”³æ€è€ƒ"><a href="#3-curryå‡½æ•°å†™æ³•çš„å¼•ç”³æ€è€ƒ" class="headerlink" title="3. curryå‡½æ•°å†™æ³•çš„å¼•ç”³æ€è€ƒ"></a>3. curryå‡½æ•°å†™æ³•çš„å¼•ç”³æ€è€ƒ</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç®€æ˜“ç‰ˆï¼Œç†è§£ fn1 ä¸­ return fn2çš„æ‰§è¡Œ</span></span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">testFn</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++ ) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(i)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">123</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> k = testFn()</span><br><span class="line">    <span class="built_in">console</span>.log(k())</span><br><span class="line">    <span class="built_in">console</span>.log(k())</span><br><span class="line">    <span class="built_in">console</span>.log(k())</span><br><span class="line">    <span class="comment">// kå‡½æ•°è¡¨è¾¾å¼çš„æ‰§è¡Œï¼Œä»…ä»…åªæœ‰ç¬¬ä¸€æ¬¡ä¼šæ‰§è¡ŒtestFné‡Œçš„forå¾ªç¯ï¼Œå…¶ä»–æ¬¡æ•°éƒ½å·²ç»è§£ææˆé‡Œé¢return 123 çš„å‡½æ•°äº†</span></span><br></pre></td></tr></table></figure>


<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// vue è¯†åˆ«htmlæ ‡ç­¾çš„å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">makeMap</span>(<span class="params">tagStr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> tagArr = tagStr.split(<span class="string">&#x27;,&#x27;</span>);</span><br><span class="line">  <span class="keyword">const</span> tagObj = &#123;&#125;;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> tag <span class="keyword">of</span> tagArr) &#123;</span><br><span class="line">    tagObj[tag] = <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">tagName</span>) </span>&#123; <span class="comment">// æ­¤å¤„è¿˜è¿ç”¨äº†é—­åŒ…å»å­˜å‚¨tagObjï¼Œä»…è¿è¡Œä¸€æ¬¡å°±ç¼“å­˜å¥½tagObjï¼Œé™ä½äº†éå†å¸¦æ¥çš„æ€§èƒ½æ¶ˆè€—</span></span><br><span class="line">    <span class="keyword">return</span> !!tagObj[tagName];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> isHTMLTag = makeMap(<span class="string">&#x27;div,p,span,h1&#x27;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(isHTMLTag(<span class="string">&#x27;div&#x27;</span>)); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<h3 id="4-curryå‡½æ•°çš„ç‰¹ç‚¹ä¸ä½œç”¨"><a href="#4-curryå‡½æ•°çš„ç‰¹ç‚¹ä¸ä½œç”¨" class="headerlink" title="4. curryå‡½æ•°çš„ç‰¹ç‚¹ä¸ä½œç”¨"></a>4. curryå‡½æ•°çš„ç‰¹ç‚¹ä¸ä½œç”¨</h3><ul>
<li>å‚æ•°å¤ç”¨ï¼Œæå‰å›ºå®šå‚æ•°</li>
<li>æå‰è¿”å›</li>
</ul>
<hr>
<p>å‚è€ƒæ–‡ç« ï¼š<br><a href="https://zh.javascript.info/currying-partials">javascript.Info</a><br><a href="https://github.com/mqyqingfeng/Blog/issues/42">å†´ç¾½githubæ–‡ç« </a><br><a href="https://my.oschina.net/u/4400687/blog/3660259"><code>arguments</code>å’Œ<code>function.length</code>çš„åŒºåˆ«</a><br><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function/length">Function.length</a><br><a href="https://github.com/YvetteLau/Step-By-Step/issues/24">githubé—­åŒ…è®ºå›</a></p>
]]></content>
      <tags>
        <tag>JS</tag>
      </tags>
  </entry>
  <entry>
    <title>åˆ¤æ–­å¯¹è±¡æ˜¯å¦æ˜¯ä¸ªç©ºå¯¹è±¡</title>
    <url>/2020/07/27/%E5%88%A4%E6%96%AD%E5%AF%B9%E8%B1%A1%E6%98%AF%E5%90%A6%E4%B8%BA%E7%A9%BA/</url>
    <content><![CDATA[<h4 id="1-éå†ï¼Œæ ¹æ®æ˜¯å¦æœ‰å€¼"><a href="#1-éå†ï¼Œæ ¹æ®æ˜¯å¦æœ‰å€¼" class="headerlink" title="1. éå†ï¼Œæ ¹æ®æ˜¯å¦æœ‰å€¼"></a>1. éå†ï¼Œæ ¹æ®æ˜¯å¦æœ‰å€¼</h4><p><code>for...in...</code></p>
<h4 id="2-æ•´ä¸ªå¯¹è±¡è½¬æ¢ä¸ºæ•°ç»„"><a href="#2-æ•´ä¸ªå¯¹è±¡è½¬æ¢ä¸ºæ•°ç»„" class="headerlink" title="2. æ•´ä¸ªå¯¹è±¡è½¬æ¢ä¸ºæ•°ç»„"></a>2. æ•´ä¸ªå¯¹è±¡è½¬æ¢ä¸ºæ•°ç»„</h4><p><code>Object.entries </code></p>
<h4 id="3-è½¬ä¸ºJSONå­—ç¬¦ä¸²"><a href="#3-è½¬ä¸ºJSONå­—ç¬¦ä¸²" class="headerlink" title="3. è½¬ä¸ºJSONå­—ç¬¦ä¸²"></a>3. è½¬ä¸ºJSONå­—ç¬¦ä¸²</h4><p><code>JSON.stringify()</code></p>
<h4 id="4-è·å–å¯¹è±¡çš„å±æ€§åå¹¶ä»¥æ•°ç»„å½¢å¼è¿”å›"><a href="#4-è·å–å¯¹è±¡çš„å±æ€§åå¹¶ä»¥æ•°ç»„å½¢å¼è¿”å›" class="headerlink" title="4. è·å–å¯¹è±¡çš„å±æ€§åå¹¶ä»¥æ•°ç»„å½¢å¼è¿”å›"></a>4. è·å–å¯¹è±¡çš„å±æ€§åå¹¶ä»¥æ•°ç»„å½¢å¼è¿”å›</h4><p><code>Object.getOwnPropertyNames()</code> / <code>Object.keys()</code></p>
<hr>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// for...in...</span></span><br><span class="line"><span class="keyword">let</span> obj = &#123;&#125;</span><br><span class="line"><span class="keyword">let</span> isEmpty = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i <span class="keyword">in</span> obj) &#123;</span><br><span class="line">   isEmpty = <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(isEmpty)</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// keyçš„éå† ï¼š Object.getOwnPropertyNames</span></span><br><span class="line"><span class="keyword">let</span> obj = &#123;&#125;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.getOwnPropertyNames(obj))</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// keyçš„éå†ï¼š Object.keys è·å–keyçš„æ•°ç»„</span></span><br><span class="line"><span class="keyword">let</span> obj = &#123;&#125;</span><br><span class="line"><span class="keyword">let</span> isEmpty = <span class="built_in">Object</span>.keys(obj).length === <span class="number">0</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å¯¹è±¡è½¬åŒ–ä¸ºæ•°ç»„çš„éå†ï¼š Object.entries</span></span><br><span class="line"><span class="keyword">let</span> obj = &#123;&#125;</span><br><span class="line"><span class="keyword">let</span> isEmpty;</span><br><span class="line">isEmpty = (<span class="built_in">Object</span>.entries(obj).length === <span class="number">0</span>) &amp;&amp; (<span class="keyword">typeof</span> obj === <span class="string">&#x27;object&#x27;</span>)</span><br><span class="line"><span class="built_in">console</span>.log(isEmpty)</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// JSONå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="keyword">let</span> obj = &#123;&#125;</span><br><span class="line"><span class="keyword">let</span> isEmpty;</span><br><span class="line">isEmpty = <span class="built_in">JSON</span>.stringify(obj) === <span class="string">&#x27;&#123;&#125;&#x27;</span></span><br><span class="line"><span class="built_in">console</span>.log(isEmpty)</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>é¢è¯• JS å¯¹è±¡</tag>
      </tags>
  </entry>
  <entry>
    <title>åˆå¹¶å¯¹è±¡</title>
    <url>/2020/07/27/%E5%90%88%E5%B9%B6%E5%AF%B9%E8%B1%A1/</url>
    <content><![CDATA[<p>1 <code>Object.assign</code></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> obj1 = &#123;<span class="attr">a</span>:[<span class="number">1</span>], <span class="attr">b</span>:[<span class="number">1</span>,<span class="number">23</span>,<span class="number">4</span>]&#125;</span><br><span class="line"><span class="keyword">let</span> obj2 = &#123;<span class="attr">a</span>:[<span class="number">1</span>,<span class="number">2</span>], <span class="attr">c</span>:<span class="number">5</span> , <span class="attr">d</span>:<span class="number">1</span>&#125;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.assign(obj1,obj2))</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>â€¦è¿ç®—ç¬¦</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> obj1 = &#123;<span class="attr">a</span>:[<span class="number">1</span>], <span class="attr">b</span>:[<span class="number">1</span>,<span class="number">23</span>,<span class="number">4</span>]&#125;</span><br><span class="line"><span class="keyword">let</span> obj2 = &#123;<span class="attr">a</span>:[<span class="number">1</span>,<span class="number">2</span>], <span class="attr">c</span>:<span class="number">5</span> , <span class="attr">d</span>:<span class="number">1</span>&#125;</span><br><span class="line"><span class="built_in">console</span>.log(&#123;...obj1, ...obj2&#125;)</span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>å¯¹è±¡ JS</tag>
      </tags>
  </entry>
  <entry>
    <title>åˆæˆå›¾ç‰‡</title>
    <url>/2019/02/15/%E5%90%88%E6%88%90%E5%9B%BE%E7%89%87/</url>
    <content><![CDATA[<h6 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h6><pre><code>H5çš„åˆ†äº«æµ·æŠ¥ï¼Œéœ€è¦ä»åå°è·å–æ•°æ®ï¼Œç»˜åˆ¶DOMï¼Œå¹¶ä¸”å¯ä»¥é•¿æŒ‰ä¿å­˜ã€‚ä¹Ÿå°±æ˜¯è¦æ±‚æ‰€æœ‰DOMéƒ½è¦è½¬ä¸ºimageå…ƒç´ ã€‚
</code></pre>
<h6 id="éœ€è¦å¼•ç”¨çš„åº“"><a href="#éœ€è¦å¼•ç”¨çš„åº“" class="headerlink" title="éœ€è¦å¼•ç”¨çš„åº“"></a>éœ€è¦å¼•ç”¨çš„åº“</h6><pre><code>html2Canvas: Screenshots with JavaScript ç­‰äºæ˜¯ç”¨jså»è½¬æ¢æŒ‡å®šçš„DOMæˆä¸ºimageã€‚
</code></pre>
<h6 id="éœ€è¦æ³¨æ„çš„åœ°æ–¹"><a href="#éœ€è¦æ³¨æ„çš„åœ°æ–¹" class="headerlink" title="éœ€è¦æ³¨æ„çš„åœ°æ–¹"></a>éœ€è¦æ³¨æ„çš„åœ°æ–¹</h6><pre><code>html2Canvasæ‰§è¡Œæ¸²æŸ“æ—¶ ï¼Œéœ€ç­‰å¾…DOMæœ¬èº«è·å–åå°æ•°æ®çš„æ¸²æŸ“å®Œæˆã€‚å¦åˆ™ä¼šå‡ºç°é»‘èƒŒæ™¯
</code></pre>
<h6 id="ç¤ºä¾‹ä»£ç "><a href="#ç¤ºä¾‹ä»£ç " class="headerlink" title="ç¤ºä¾‹ä»£ç "></a>ç¤ºä¾‹ä»£ç </h6><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">$(<span class="built_in">window</span>).load(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="comment">// å…³é”®åœ¨è¿™é‡Œï¼Œå»¶æ—¶è¿›è¡Œhtml2Canvasæ“ä½œ</span></span><br><span class="line">        drawCanvas(<span class="string">&#x27;#sharePoster_bg_img&#x27;</span>).then(<span class="function"><span class="params">canvas</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> img = <span class="keyword">new</span> Image();</span><br><span class="line">            img.style.display = <span class="string">&quot;block&quot;</span>;</span><br><span class="line">            <span class="comment">// å°† canvas å¯¼å‡ºæˆ base64</span></span><br><span class="line">            img.src = canvas.toDataURL(<span class="string">&#x27;image/jpeg&#x27;</span>, <span class="number">0.92</span>);</span><br><span class="line">            img.crossOrigin = <span class="string">&quot;Anonymous&quot;</span>;</span><br><span class="line">            <span class="comment">// æ·»åŠ å›¾ç‰‡åˆ°é¢„è§ˆ</span></span><br><span class="line">            $(<span class="string">&#x27;#sharePoster_bg_img&#x27;</span>).html(img); <span class="comment">// ç”Ÿæˆçš„base64å›¾ç‰‡å¡«å……åˆ°domé‡Œ</span></span><br><span class="line">            $(<span class="string">&#x27;.save_text&#x27;</span>).show();</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,<span class="number">500</span>)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<hr>
<h6 id="ä¼˜åŒ–ç»†èŠ‚-ä»¥åŠ-è¦ç”¨åˆ°çš„å·¥å…·å‡½æ•°"><a href="#ä¼˜åŒ–ç»†èŠ‚-ä»¥åŠ-è¦ç”¨åˆ°çš„å·¥å…·å‡½æ•°" class="headerlink" title="ä¼˜åŒ–ç»†èŠ‚ ä»¥åŠ è¦ç”¨åˆ°çš„å·¥å…·å‡½æ•°"></a>ä¼˜åŒ–ç»†èŠ‚ ä»¥åŠ è¦ç”¨åˆ°çš„å·¥å…·å‡½æ•°</h6><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* æ ¹æ®åƒç´ æ¯”ç»˜åˆ¶canvasï¼Œä½¿ç”Ÿæˆå›¾ç‰‡æ›´åŠ é«˜æ¸…ã€‚</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param <span class="variable">DomSelector</span></span></span></span><br><span class="line"><span class="comment">* <span class="doctag">@returns <span class="variable">html2Canvas</span></span></span></span><br><span class="line"><span class="comment">**/</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">drawCanvas</span>(<span class="params">selector</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// è·å–æƒ³è¦è½¬æ¢çš„ DOM èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">const</span> dom = <span class="built_in">document</span>.querySelector(selector);</span><br><span class="line">    <span class="keyword">const</span> box = <span class="built_in">window</span>.getComputedStyle(dom);</span><br><span class="line">    <span class="comment">// DOM èŠ‚ç‚¹è®¡ç®—åå®½é«˜</span></span><br><span class="line">    <span class="keyword">const</span> width = parseValue(box.width);</span><br><span class="line">    <span class="keyword">const</span> height = parseValue(box.height);</span><br><span class="line">    <span class="comment">// è·å–åƒç´ æ¯”</span></span><br><span class="line">    <span class="keyword">const</span> scaleBy = DPR();</span><br><span class="line">    <span class="comment">// åˆ›å»ºè‡ªå®šä¹‰ canvas å…ƒç´ </span></span><br><span class="line">    <span class="keyword">const</span> canvas = <span class="built_in">document</span>.createElement(<span class="string">&#x27;canvas&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¾å®š canvas å…ƒç´ å±æ€§å®½é«˜ä¸º DOM èŠ‚ç‚¹å®½é«˜ * åƒç´ æ¯”</span></span><br><span class="line">    canvas.width = width * scaleBy;</span><br><span class="line">    canvas.height = height * scaleBy;</span><br><span class="line">    <span class="comment">// è®¾å®š canvas csså®½é«˜ä¸º DOM èŠ‚ç‚¹å®½é«˜</span></span><br><span class="line">    canvas.style.width = <span class="string">`<span class="subst">$&#123;width&#125;</span>px`</span>;</span><br><span class="line">    canvas.style.height = <span class="string">`<span class="subst">$&#123;height&#125;</span>px`</span>;</span><br><span class="line">    <span class="comment">// è·å–ç”»ç¬”</span></span><br><span class="line">    <span class="keyword">const</span> context = canvas.getContext(<span class="string">&#x27;2d&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†æ‰€æœ‰ç»˜åˆ¶å†…å®¹æ”¾å¤§åƒç´ æ¯”å€ </span></span><br><span class="line">    context.scale(scaleBy, scaleBy);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†è‡ªå®šä¹‰ canvas ä½œä¸ºé…ç½®é¡¹ä¼ å…¥ï¼Œå¼€å§‹ç»˜åˆ¶</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">await</span> html2canvas(dom, &#123;canvas,</span><br><span class="line">        <span class="attr">allowTaint</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">useCORS</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">async</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">width</span>: width,</span><br><span class="line">        <span class="attr">height</span>: height</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* æ ¹æ®window.devicePixelRatioè·å–åƒç´ æ¯”</span></span><br><span class="line"><span class="comment">* <span class="doctag">@returns </span>åƒç´ æ¯”</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">DPR</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">window</span>.devicePixelRatio &amp;&amp; <span class="built_in">window</span>.devicePixelRatio &gt; <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">window</span>.devicePixelRatio;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">*  å°†ä¼ å…¥å€¼è½¬ä¸ºæ•´æ•°</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param <span class="variable">value</span></span></span></span><br><span class="line"><span class="comment">* <span class="doctag">@returns <span class="type">&#123;number&#125;</span></span></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">parseValue</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">parseInt</span>(value, <span class="number">10</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="æ³¨æ„ç»†èŠ‚ï¼š"><a href="#æ³¨æ„ç»†èŠ‚ï¼š" class="headerlink" title="æ³¨æ„ç»†èŠ‚ï¼š"></a>æ³¨æ„ç»†èŠ‚ï¼š</h6><pre><code>éœ€ç»˜åˆ¶çš„DOMæ‰€ç”¨åˆ°çš„csså±æ€§å€¼æœ€å¥½ä¸ç”¨æœ€æ–°çš„å±æ€§ï¼Œhtml2Canvasä¸æ”¯æŒæœ€æ–°çš„csså±æ€§è§£æï¼Œä¼šé€ æˆç”Ÿæˆçš„å›¾ç‰‡æœ‰é»‘è‰²èƒŒæ™¯ã€‚
</code></pre>
<h6 id="å‚è€ƒé“¾æ¥ï¼š"><a href="#å‚è€ƒé“¾æ¥ï¼š" class="headerlink" title="å‚è€ƒé“¾æ¥ï¼š"></a>å‚è€ƒé“¾æ¥ï¼š</h6><p>   <a href="https://html2canvas.hertzen.com/">html2Canvaså®˜ç½‘</a><br>   <a href="http://cdn.huodongxing.com/Content/v2.0/plugin/html2canvas/html2canvas.min.js">jsèµ„æº</a></p>
]]></content>
      <tags>
        <tag>JS</tag>
      </tags>
  </entry>
  <entry>
    <title>å¤åˆ¶å†…å®¹</title>
    <url>/2019/03/02/%E5%A4%8D%E5%88%B6%E5%86%85%E5%AE%B9/</url>
    <content><![CDATA[<h6 id="å¸¸ç”¨åœºæ™¯ï¼š"><a href="#å¸¸ç”¨åœºæ™¯ï¼š" class="headerlink" title="å¸¸ç”¨åœºæ™¯ï¼š"></a>å¸¸ç”¨åœºæ™¯ï¼š</h6><p>æœ‰æ—¶å€™éœ€è¦å¤åˆ¶å†…å®¹ï¼Œæ¯”å¦‚å¤åˆ¶é“¾æ¥ï¼Œéœ€è¦ç”¨jså®ç°ï¼Œé‚£ä¹ˆï¼Œå¯ä»¥è¿™ä¹ˆè§£å†³</p>
<h6 id="æ ¸å¿ƒåŸç†ï¼š"><a href="#æ ¸å¿ƒåŸç†ï¼š" class="headerlink" title="æ ¸å¿ƒåŸç†ï¼š"></a>æ ¸å¿ƒåŸç†ï¼š</h6><p>åˆ©ç”¨inputçš„<code>é€‰æ‹©å±æ€§</code>ï¼Œè·å–inputçš„å€¼ï¼Œé€‰æ‹©å®ƒï¼Œå¹¶ä¸”æ‰§è¡Œ<code>document.execCommand(&quot;Copy&quot;)</code> ã€‚è€Œä¸”å› ä¸ºå¾€å¾€å€¼æ˜¯éšè—çš„ï¼Œæ‰€ä»¥è¿™ä¸ªinputä¹Ÿæ˜¯ä¸å¤–éœ²çš„ã€‚</p>
<h6 id="ä¸Šäº›ä»£ç ï¼š"><a href="#ä¸Šäº›ä»£ç ï¼š" class="headerlink" title="ä¸Šäº›ä»£ç ï¼š"></a>ä¸Šäº›ä»£ç ï¼š</h6><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;inviteHideInput&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span> <span class="attr">style</span>=<span class="string">&quot;height: 1px;width: 1px;&quot;</span>&gt;</span> <span class="comment">&lt;!-- è¿™æ˜¯éšè—çš„input --&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;å¤åˆ¶é‚€è¯·å‡½é“¾æ¥&quot;</span> <span class="attr">class</span>=<span class="string">&quot;copyInviteUrl&quot;</span> /&gt;</span> <span class="comment">&lt;!-- è¿™æ˜¯è§¦å‘çš„Dom --&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"> $(<span class="string">&#x27;.copyInviteUrl&#x27;</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> eid = getQueryString(<span class="string">&#x27;id&#x27;</span>);</span><br><span class="line">        <span class="keyword">var</span> newUrl = location.host + <span class="string">&#x27;/invitation?eid=&#x27;</span> + eid;</span><br><span class="line">        $(<span class="string">&#x27;#inviteHideInput&#x27;</span>).attr(<span class="string">&#x27;value&#x27;</span>, newUrl);</span><br><span class="line">        $(<span class="string">&#x27;#inviteHideInput&#x27;</span>).select();</span><br><span class="line">        <span class="built_in">document</span>.execCommand(<span class="string">&quot;Copy&quot;</span>); <span class="comment">// æ‰§è¡Œæµè§ˆå™¨å¤åˆ¶å‘½ä»¤</span></span><br><span class="line">        PopupMessage(<span class="number">0</span>, <span class="string">&quot;å·²å¤åˆ¶ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨Ctrl+Vç²˜è´´ã€‚&quot;</span>, <span class="number">1000</span>)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>JS</tag>
      </tags>
  </entry>
  <entry>
    <title>å°ç¨‹åºå…¥é—¨</title>
    <url>/2019/08/05/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%85%A5%E9%97%A8%E7%AF%87/</url>
    <content><![CDATA[<ul>
<li>ç›®å½•ç»“æ„</li>
<li>é¡µé¢ç»“æ„</li>
</ul>
<h3 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h3><p>ç›®å½•ç»“æ„å¦‚å›¾ï¼š<br> <img src="https://raw.githubusercontent.com/jonnzer/saveImgForYun/master/a646ddf246beb349e404ba97e137473.png" alt="image"></p>
<hr>
<p>1.<code>componentsæ–‡ä»¶å¤¹</code>ï¼šå­˜æ”¾è‡ªå®šä¹‰çš„ç»„ä»¶ã€å°è£…çš„ç»„ä»¶ã€‚</p>
<p>2.<code>custom-tab-bar</code>: å¦‚åï¼Œå®ƒå°±æ˜¯è‡ªå®šä¹‰çš„tab-barã€‚</p>
<p>3.<code>img</code>ï¼šå¦‚å, å®ƒå°±æ˜¯å­˜æ”¾å›¾ç‰‡çš„ã€‚  </p>
<p>4.<code>pages</code>ï¼šæœ€æ ¸å¿ƒçš„ï¼Œæ˜¯å­˜æ”¾æˆ‘ä»¬çš„é¡µé¢ã€‚</p>
<p><img src="https://raw.githubusercontent.com/jonnzer/saveImgForYun/master/6237ce1f0d8810a3bcf79d5c3ff65eb.png" alt="image"></p>
<p>å¦‚å›¾ ï¼Œindexæ–‡ä»¶å¤¹ä¸­ï¼Œå°±åŒ…å«å››ä¸ªè¿™æ ·åå­—çš„js,json,wxml,wxss å…¶ä¸­çš„jsonæ˜¯å®šä¹‰é¡µé¢çš„è‡ªå®šä¹‰ä¿¡æ¯ï¼ŒåŒ…å«é¡µé¢æ ‡é¢˜ï¼Œå¼•ç”¨ç»„ä»¶ï¼ŒèƒŒæ™¯é¢œè‰²ç­‰ç­‰</p>
<p>5.<code>service</code>: å­˜æ”¾äº†å·¥å…·å‡½æ•°ï¼Œå¦‚å…¨å±€å­˜å‚¨ï¼Œç™»å½•å°è£…ï¼Œapiç›¸å…³åœ°å€ä»¥åŠè¯·æ±‚å°è£…ï¼Œè¿˜æœ‰ä¸€äº›æ ¹æ®ä¸šåŠ¡çš„å¤„ç†å­—ç¬¦ä¸²æˆ–è€…å¯¹è±¡çš„æ–¹æ³•ï¼ˆåŒ…æ‹¬æ­£åˆ™ï¼‰ã€‚</p>
<p>6.<code>app.json</code>ï¼šå…¨å±€çš„é…ç½®,æ ‡é¢˜ï¼ŒèƒŒæ™¯ï¼Œåº•éƒ¨tabBarï¼Œé¡µé¢è·¯ç”±ï¼Œå®šä½å…è®¸ï¼Œappidæˆæƒï¼ˆç®€å•ç†è§£ï¼Œå°±æ˜¯ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼‰</p>
<p>7.<code>app.js</code>: æ¯ä¸ªå°ç¨‹åºéƒ½éœ€è¦åœ¨ app.js ä¸­è°ƒç”¨ App æ–¹æ³•æ³¨å†Œå°ç¨‹åºç¤ºä¾‹ï¼Œç»‘å®šç”Ÿå‘½å‘¨æœŸå›è°ƒå‡½æ•°ã€‚</p>
<p>8.<code>project.config.json</code>: å°ç¨‹åºå¼€å‘å·¥å…·çš„é¡¶ä¸Šçš„ç¼–è¯‘å…¥å£æ–‡ä»¶ï¼Œå¯ä»¥åœ¨é‡Œé¢å®šä¹‰å¥½è·¯å¾„ï¼Œåˆ·æ–°ä¹Ÿåªæ˜¯åˆ·æ–°æŒ‡å®šé¡µé¢ï¼Œå‡å°‘è°ƒè¯•æ­¥éª¤ã€‚</p>
<hr>
<p>é¡µé¢ç»“æ„</p>
<ul>
<li>1.<code>wxml</code>: <ul>
<li>å¸¸ç”¨æ ‡ç­¾ç•¥å¾®æœ‰ç‚¹ä¸ä¸€æ ·ï¼Œwebå¼€å‘å¸¸ç”¨çš„divï¼Œæ¢æˆå®ƒçš„<strong><strong>view</strong></strong>æ ‡ç­¾ã€‚spanæ¢æˆå®ƒçš„<strong>text</strong>æ ‡ç­¾ã€‚<br>å›¾ç‰‡æ ‡ç­¾æ¢æˆ<strong>image</strong>æ ‡ç­¾ï¼Œå±æ€§ä¸€æ ·ï¼Œç”¨æ³•ä¸€æ ·ã€‚</li>
<li>è°ˆä¸‹<strong>cover-view</strong>è¿™ä¸ªæ ‡ç­¾ï¼Œå®ƒæ˜¯å¯ä»¥åœ¨<code>map</code>ã€<code>video</code>ã€<code>canvas</code>ã€<code>camera</code>ã€<code>live-player</code>ã€<code>live-pusher</code>ç­‰ç­‰ä¹‹ä¸Šçš„æ¸²æŸ“çš„æ ‡ç­¾ã€‚è¿™æ—¶å€™<strong>view</strong>æ ‡ç­¾è¡¨ç¤ºæ— èƒ½ä¸ºåŠ›çš„ã€‚</li>
</ul>
</li>
<li>2.<code>wxss</code>:<ul>
<li>å•ä½ï¼špxå•ä½æ¢æˆrpx,é€‚é…è®¾å¤‡çš„å•ä½ï¼Œè¿™ä¸ªæ˜¯çœŸé¦™ï¼Œä¸ç”¨å†æ¢ç®—ã€‚</li>
<li>flexå¸ƒå±€æ”¯æŒã€‚</li>
</ul>
</li>
<li>3.<code>js</code>:<ul>
<li>é¡µé¢ç»„ä»¶çš„jsç»“æ„ï¼š<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"> <span class="comment">// import utils</span></span><br><span class="line">  Page(&#123;</span><br><span class="line">   <span class="attr">data</span>: &#123; <span class="comment">// é¡µé¢æ‰€éœ€å˜é‡</span></span><br><span class="line"> 	&#125;,</span><br><span class="line">   <span class="attr">onShow</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">   </span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="attr">onLoad</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// fetch data</span></span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="attr">customEvent</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="comment">// è‡ªå·±å®šä¹‰çš„è§¦å‘å‡½æ•°</span></span><br><span class="line">   </span><br><span class="line">   &#125;,</span><br><span class="line">&#125;)       </span><br></pre></td></tr></table></figure></li>
<li>â€“ </li>
<li>è‡ªå®šä¹‰ç»„ä»¶çš„jsç»“æ„ï¼š <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// import utils</span></span><br><span class="line">Component(&#123;</span><br><span class="line">    <span class="attr">properties</span>: &#123;</span><br><span class="line">  	<span class="attr">something</span>: &#123; <span class="comment">// çˆ¶ç»„ä»¶ä¼ è¿‡æ¥çš„</span></span><br><span class="line">	    	<span class="attr">type</span>: <span class="built_in">String</span>,</span><br><span class="line">    	&#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">data</span>:&#123;</span><br><span class="line">  	</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">ready</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">  	</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">attached</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">  	</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">methods</span>: &#123;</span><br><span class="line">  	<span class="attr">methods1</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	  </span><br><span class="line">	    &#125;,</span><br><span class="line">   <span class="attr">methods2</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">   </span><br><span class="line">     &#125;,</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<a href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/Component.html">å®˜æ–¹API</a><br><a href="https://juejin.im/entry/5a676b3ff265da3e4f0a5215">å°ç¨‹åºç»„ä»¶åŒ–APIä»‹ç»</a></li>
</ul>
</li>
<li>4.<code>json</code></li>
</ul>
]]></content>
      <tags>
        <tag>å°ç¨‹åº</tag>
      </tags>
  </entry>
  <entry>
    <title>æ•°ç»„å»é‡</title>
    <url>/2019/02/25/%E6%95%B0%E7%BB%84%E5%8E%BB%E9%87%8D/</url>
    <content><![CDATA[<blockquote>
<p>æˆ‘ä»¬æ—¶å¸¸é‡è§æ•°ç»„å»é‡çš„éœ€æ±‚ï¼Œæˆ–æ˜¯åå°ç»™çš„æ•°æ®é‡äº†ï¼Œæˆ–æ˜¯å‰ç«¯ç”Ÿæˆæ•°æ®çš„æ—¶å€™é‡äº†ï¼Œè¿™æ—¶å€™å¾€å¾€éœ€è¦å¤„ç†ä¸‹ï¼Œé‚£ä¸‹é¢æˆ‘å½’çº³ä¸‹å„ç§è§£å†³æ–¹æ¡ˆå§ğŸ§ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å…ˆç»™å‡ºå‡ ç»„æµ‹è¯•æ•°ç»„</span></span><br><span class="line"><span class="keyword">let</span> includeObjArr = [ <span class="comment">// å¾…æ£€æµ‹æ•°ç»„ï¼ˆå«å¯¹è±¡ï¼‰</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">id</span>: <span class="number">11</span>,</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;wang&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">id</span>: <span class="number">11</span>,</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;wang&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">id</span>:<span class="number">12</span>,</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;zhong&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">id</span>: <span class="number">11</span>,</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;zhong&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">];</span><br><span class="line"><span class="keyword">let</span> includeNumArr =  [<span class="number">3</span>, <span class="number">62</span>, <span class="number">3</span>, <span class="number">38</span>, <span class="number">20</span>, <span class="number">42</span>, <span class="number">14</span>, <span class="number">5</span>, <span class="number">38</span>, <span class="number">29</span>, <span class="number">42</span>]; <span class="comment">// åªå«æ•°å­—çš„ç®€å•æ•°ç»„</span></span><br></pre></td></tr></table></figure>

<h3 id="1-åˆ©ç”¨ES6çš„API-Setå’Œ-Array"><a href="#1-åˆ©ç”¨ES6çš„API-Setå’Œ-Array" class="headerlink" title="1. åˆ©ç”¨ES6çš„API Setå’Œ Array"></a>1. åˆ©ç”¨ES6çš„API Setå’Œ Array</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* es6 apiçš„è§£å†³æ–¹æ¡ˆ</span></span><br><span class="line"><span class="comment">* @param targetArr</span></span><br><span class="line"><span class="comment">* @returns &#123;any[]&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">uniqueArray</span>(<span class="params">targetArr</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Array</span>.from(<span class="keyword">new</span> <span class="built_in">Set</span>(targetArr));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="ç»“è®ºï¼šåªèƒ½ç”¨äºåŒ…å«ç®€å•æ•°å­—çš„æ•°ç»„å»é‡"><a href="#ç»“è®ºï¼šåªèƒ½ç”¨äºåŒ…å«ç®€å•æ•°å­—çš„æ•°ç»„å»é‡" class="headerlink" title="ç»“è®ºï¼šåªèƒ½ç”¨äºåŒ…å«ç®€å•æ•°å­—çš„æ•°ç»„å»é‡"></a>ç»“è®ºï¼šåªèƒ½ç”¨äºåŒ…å«ç®€å•æ•°å­—çš„æ•°ç»„å»é‡</h6><h3 id="2-åˆ©ç”¨array-splice"><a href="#2-åˆ©ç”¨array-splice" class="headerlink" title="2. åˆ©ç”¨array.splice"></a>2. åˆ©ç”¨array.splice</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* es6 apiçš„è§£å†³æ–¹æ¡ˆ</span></span><br><span class="line"><span class="comment">* @param arr</span></span><br><span class="line"><span class="comment">* @returns &#123;any[]&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">uniqueArray</span>(<span class="params">arr</span>)</span>&#123; </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.length - <span class="number">1</span>; i++)&#123; </span><br><span class="line">      <span class="keyword">for</span>(<span class="keyword">var</span> j = i + <span class="number">1</span>; j &lt; arr.length; j++)&#123; </span><br><span class="line">            <span class="keyword">if</span>(arr[j] === arr[i])&#123; </span><br><span class="line">                arr.splice(j--, <span class="number">1</span>); </span><br><span class="line">                &#125; </span><br><span class="line">              &#125; </span><br><span class="line">            &#125; </span><br><span class="line">          <span class="keyword">return</span> arr;</span><br><span class="line">         &#125;</span><br></pre></td></tr></table></figure>
<h6 id="ç»“è®ºï¼šåªèƒ½ç”¨äºåŒ…å«ç®€å•æ•°å­—çš„æ•°ç»„å»é‡-1"><a href="#ç»“è®ºï¼šåªèƒ½ç”¨äºåŒ…å«ç®€å•æ•°å­—çš„æ•°ç»„å»é‡-1" class="headerlink" title="ç»“è®ºï¼šåªèƒ½ç”¨äºåŒ…å«ç®€å•æ•°å­—çš„æ•°ç»„å»é‡"></a>ç»“è®ºï¼šåªèƒ½ç”¨äºåŒ…å«ç®€å•æ•°å­—çš„æ•°ç»„å»é‡</h6><h3 id="3-åˆ©ç”¨å“ˆå¸Œè¡¨"><a href="#3-åˆ©ç”¨å“ˆå¸Œè¡¨" class="headerlink" title="3. åˆ©ç”¨å“ˆå¸Œè¡¨"></a>3. åˆ©ç”¨å“ˆå¸Œè¡¨</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* å¯¹è±¡å­˜å‚¨çš„æ˜¯å¼•ç”¨è€ŒåŸå§‹å˜é‡å­˜å‚¨çš„æ˜¯å€¼ã€‚</span></span><br><span class="line"><span class="comment">* å› ä¸ºå“ˆå¸Œè¡¨åœ¨Javascripté‡Œæ˜¯ä¸€ä¸ªç®€å•çš„Objectï¼Œå®ƒçš„keyæ°¸è¿œæ˜¯Stringç±»å‹ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬ä¸èƒ½åŒºåˆ†å­—ç¬¦ä¸²å’Œæ•°å­—è¡¨ç¤ºçš„ç›¸åŒçš„å€¼ï¼Œå¦‚1å’Œ&#x27;1&#x27;ã€‚</span></span><br><span class="line"><span class="comment">* ç„¶è€Œï¼Œå› ä¸ºæˆ‘ä»¬ä½¿ç”¨çš„JSON.stringifyï¼ŒStringç±»å‹çš„key å°†ä¼šè¢«å­˜å‚¨ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²å€¼ï¼Œè¿™æ ·hashTableçš„keyå°±å”¯ä¸€äº†ã€‚</span></span><br><span class="line"><span class="comment">* è¿™æ„å‘³ç€ç›¸åŒçš„å€¼ï¼Œä½†ä¸åŒç±»å‹çš„å…ƒç´ ï¼Œå°†ä»¥åŸæ¥çš„æ ¼å¼ä¿ç•™ã€‚</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param <span class="variable">arr</span></span></span></span><br><span class="line"><span class="comment">* <span class="doctag">@returns <span class="type">&#123;Array&#125;</span></span></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dedup</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> hashTable = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> arr.filter(<span class="function"><span class="keyword">function</span> (<span class="params">el</span>) </span>&#123;</span><br><span class="line">		<span class="keyword">var</span> key = <span class="built_in">JSON</span>.stringify(el);</span><br><span class="line">		<span class="keyword">var</span> match = <span class="built_in">Boolean</span>(hashTable[key]);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> (match ? <span class="literal">false</span> : hashTable[key] = <span class="literal">true</span>);</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h6 id="ç»“è®ºï¼šå¯ç”¨äºåŒ…å«å¤æ‚ç±»å‹çš„æ•°ç»„å»é‡"><a href="#ç»“è®ºï¼šå¯ç”¨äºåŒ…å«å¤æ‚ç±»å‹çš„æ•°ç»„å»é‡" class="headerlink" title="ç»“è®ºï¼šå¯ç”¨äºåŒ…å«å¤æ‚ç±»å‹çš„æ•°ç»„å»é‡"></a>ç»“è®ºï¼šå¯ç”¨äºåŒ…å«å¤æ‚ç±»å‹çš„æ•°ç»„å»é‡</h6><hr>
<h3 id="4-åˆ©ç”¨å¯¹è±¡ä¸­keyçš„å”¯ä¸€"><a href="#4-åˆ©ç”¨å¯¹è±¡ä¸­keyçš„å”¯ä¸€" class="headerlink" title="4. åˆ©ç”¨å¯¹è±¡ä¸­keyçš„å”¯ä¸€"></a>4. åˆ©ç”¨å¯¹è±¡ä¸­keyçš„å”¯ä¸€</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">unique</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> ret = [];</span><br><span class="line">    <span class="keyword">var</span> len = arr.length;</span><br><span class="line">    <span class="keyword">var</span> tmp = &#123;&#125;;</span><br><span class="line">    <span class="keyword">var</span> tmpKey;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;len; i++)&#123;</span><br><span class="line">        tmpKey = <span class="keyword">typeof</span> arr[i] + <span class="built_in">JSON</span>.stringify(arr[i]);</span><br><span class="line">        <span class="keyword">if</span>(!tmp[tmpKey])&#123;</span><br><span class="line">            tmp[tmpKey] = <span class="number">1</span>;</span><br><span class="line">            ret.push(arr[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="ç»“è®ºï¼šå¯ç”¨äºåŒ…å«å¤æ‚ç±»å‹çš„æ•°ç»„å»é‡-1"><a href="#ç»“è®ºï¼šå¯ç”¨äºåŒ…å«å¤æ‚ç±»å‹çš„æ•°ç»„å»é‡-1" class="headerlink" title="ç»“è®ºï¼šå¯ç”¨äºåŒ…å«å¤æ‚ç±»å‹çš„æ•°ç»„å»é‡"></a>ç»“è®ºï¼šå¯ç”¨äºåŒ…å«å¤æ‚ç±»å‹çš„æ•°ç»„å»é‡</h6><h6 id="å‚è€ƒé“¾æ¥ï¼š"><a href="#å‚è€ƒé“¾æ¥ï¼š" class="headerlink" title="å‚è€ƒé“¾æ¥ï¼š"></a>å‚è€ƒé“¾æ¥ï¼š</h6><p><a href="http://www.jstips.co/zh_cn/javascript/deduplicate-an-array/">jstips</a><br><a href="https://github.com/lifesinger/blog/issues/113">blog</a><br><a href="https://github.com/hanzichi/underscore-analysis/issues/9">blog</a></p>
]]></content>
      <tags>
        <tag>Array</tag>
      </tags>
  </entry>
  <entry>
    <title>æµè§ˆå™¨-è¾“å…¥urlç³»åˆ—</title>
    <url>/2020/03/13/%E6%B5%8F%E8%A7%88%E5%99%A8-%E8%BE%93%E5%85%A5url%E6%93%8D%E4%BD%9C%E7%AF%87/</url>
    <content><![CDATA[<blockquote>
<p>å…±æ˜¯äº”ä¸ªæ­¥éª¤</p>
</blockquote>
<h3 id="1-æµè§ˆå™¨çš„æœç´¢æ¡†"><a href="#1-æµè§ˆå™¨çš„æœç´¢æ¡†" class="headerlink" title="1 æµè§ˆå™¨çš„æœç´¢æ¡†"></a>1 æµè§ˆå™¨çš„æœç´¢æ¡†</h3><p>æµè§ˆå™¨ä¼šæ ¹æ®è¾“å…¥çš„å†…å®¹ï¼Œå»åŒ¹é…æ˜¯ç”¨å¯¹åº”çš„å¼•æ“æœç´¢å†…å®¹ï¼Œè¿˜æ˜¯ç›´æ¥è·³è½¬urlã€‚<br>è¯¦ç»†çš„è®²ï¼Œå°±æ˜¯</p>
<ul>
<li>æœç´¢å†…å®¹+é»˜è®¤æœç´¢å¼•æ“ï¼Œå½¢æˆæ–°çš„URL</li>
<li>ç¬¦åˆURLè§„åˆ™çš„è¯ï¼Œåœ¨è¾“å…¥å†…å®¹åŸºç¡€ä¸ŠåŠ ä¸Šåè®®ï¼Œå½¢æˆæ–°çš„URL</li>
</ul>
<h3 id="2-dnsè§£æ"><a href="#2-dnsè§£æ" class="headerlink" title="2 dnsè§£æ"></a>2 dnsè§£æ</h3><ul>
<li>è‡ªå·±çš„ç†è§£ï¼šè·¯ç”±è§£æï¼Œæ‰¾åˆ°èƒŒåçš„ipåœ°å€ï¼Œè·¯ç”±ç¼“å­˜ï¼ŒåŸŸåç¼“å­˜ï¼Œä¸ºä»€ä¹ˆç¬¬äºŒæ¬¡åŠ è½½ä¼šæ›´å¿«ï¼Œè·Ÿè¿™ä¸ªæœ‰å…³ã€‚</li>
<li>dnsï¼šä¸€ä¸ªåŸŸåä¸ipåœ°å€ç›¸äº’æ˜ å°„çš„åˆ†å¸ƒå¼æ•°æ®åº“</li>
<li>æˆ‘ä»¬æ— æ³•è®°ä½çš„ipï¼Œé‚£ä¸€ä¸ªä¸ªé•¿ç›¸å¹³å‡¡ä½†æ˜¯å †ç§¯åœ¨ä¸€èµ·å°±æ˜¯è®°ä¸ä½çš„å‡ ä¸ªæ•°å­—ï¼Œæ˜¯çš„ï¼Œdnså¸®æˆ‘ä»¬è®°ä½äº†ã€‚ä»–ä»¥ç”µè¯ç°¿çš„å½¢å¼ï¼Œè®°ä½äº†è®¸è®¸å¤šå¤šçš„ipåœ°å€ï¼Œæ˜ å°„åˆ°äº†æ‰€æœ‰ç½‘ç«™ä¸Šã€‚</li>
<li>åœ¨å®¢æˆ·ç«¯è¾“å…¥ URL åï¼Œä¼šæœ‰ä¸€ä¸ªé€’å½’æŸ¥æ‰¾çš„è¿‡ç¨‹ï¼Œä»æµè§ˆå™¨ç¼“å­˜ä¸­æŸ¥æ‰¾-&gt;æœ¬åœ°çš„hostsæ–‡ä»¶æŸ¥æ‰¾-&gt;æ‰¾æœ¬åœ°DNSè§£æå™¨ç¼“å­˜æŸ¥æ‰¾-&gt;æœ¬åœ°DNSæœåŠ¡å™¨æŸ¥æ‰¾ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­ä»»ä½•ä¸€æ­¥æ‰¾åˆ°äº†éƒ½ä¼šç»“æŸæŸ¥æ‰¾æµç¨‹ã€‚</li>
<li>æœ¬åœ°dnsæœåŠ¡å™¨æ‰¾ä¸åˆ°çš„æ—¶å€™ï¼Œå»æŸ¥è¯¢å…¶ä»–æ ¹dnsæœåŠ¡å™¨ï¼Œé¡¶çº§åŸŸæœåŠ¡å™¨ï¼Œæƒå¨dnsæœåŠ¡å™¨</li>
<li>æŸ¥æ‰¾çš„è¿‡ç¨‹æ˜¯æœ‰ä¼˜åŒ–çš„åœ°æ–¹ï¼š<ul>
<li>DNSå­˜åœ¨ç€å¤šçº§ç¼“å­˜ï¼Œä»ç¦»æµè§ˆå™¨çš„è·ç¦»æ’åºçš„è¯ï¼Œæœ‰ä»¥ä¸‹å‡ ç§: æµè§ˆå™¨ç¼“å­˜ï¼Œç³»ç»Ÿç¼“å­˜ï¼Œè·¯ç”±å™¨ç¼“å­˜ï¼ŒIPSæœåŠ¡å™¨ç¼“å­˜ï¼Œæ ¹åŸŸåæœåŠ¡å™¨ç¼“å­˜ï¼Œé¡¶çº§åŸŸåæœåŠ¡å™¨ç¼“å­˜ï¼Œä¸»åŸŸåæœåŠ¡å™¨ç¼“å­˜ã€‚ </li>
<li>åœ¨åŸŸåå’Œ IP çš„æ˜ å°„è¿‡ç¨‹ä¸­ï¼Œç»™äº†åº”ç”¨åŸºäºåŸŸååšè´Ÿè½½å‡è¡¡çš„æœºä¼šï¼Œå¯ä»¥æ˜¯ç®€å•çš„è´Ÿè½½å‡è¡¡ï¼Œä¹Ÿå¯ä»¥æ ¹æ®åœ°å€å’Œè¿è¥å•†åšå…¨å±€çš„è´Ÿè½½å‡è¡¡ã€‚</li>
<li>è¡¥å……ï¼šåŸŸåä¸ipä¹‹é—´æœ‰æ˜ å°„å…³ç³»ï¼Œä½†æ˜¯å¤§å¤šæ•°æƒ…å†µä¸‹å´ä¸æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œæˆ‘ä»¬å¯ä»¥å°†å¤šä¸ªipæ˜ å°„åˆ°åŒä¸€ä¸ªåŸŸåï¼Œå› ä¸ºç”¨æˆ·æ˜¯é€šè¿‡åŸŸåå»è¿›è¡Œè®¿é—®çš„ï¼Œå…·ä½“è®¿é—®å“ªä¸ªåœ°å€ï¼Œåˆ™æœ‰DNSæœåŠ¡å™¨çš„æ˜ å°„è®°å½•å’Œä¸€å®šçš„è´Ÿè½½å‡è¡¡ç®—æ³•æ¥å†³å®šï¼Œç”¨æˆ·æ‹¿åˆ°å…·ä½“ipåå†å»è®¿é—®ï¼Œè€Œè¿™ä¸ªè¿‡ç¨‹å¯¹ç”¨æˆ·æ¥è¯´å®Œå…¨æ˜¯é€æ˜çš„ï¼Œé€šè¿‡DNSåˆ†æµå®Œæˆäº†ç¬¬ä¸€æ­¥çš„è´Ÿè½½å‡è¡¡ï¼š</li>
</ul>
</li>
</ul>
<h3 id="3-Httpsï¼Œsslåè®®ï¼ŒTcpå»ºç«‹è¿æ¥"><a href="#3-Httpsï¼Œsslåè®®ï¼ŒTcpå»ºç«‹è¿æ¥" class="headerlink" title="3 Httpsï¼Œsslåè®®ï¼ŒTcpå»ºç«‹è¿æ¥"></a>3 Httpsï¼Œsslåè®®ï¼ŒTcpå»ºç«‹è¿æ¥</h3><p>æµè§ˆå™¨é€šè¿‡http/httpsåè®®ï¼Œå»ºç«‹tcpè¿æ¥ï¼Œä¸‰æ¬¡æ¡æ‰‹å»ºç«‹è¯·æ±‚ï¼Œä¼ è¾“è¿æ¥å»ºç«‹å®Œæ¯•ã€‚</p>
<h3 id="4-æœåŠ¡å™¨å¤„ç†è¯·æ±‚ï¼Œè¿”å›ç»“æœ"><a href="#4-æœåŠ¡å™¨å¤„ç†è¯·æ±‚ï¼Œè¿”å›ç»“æœ" class="headerlink" title="4 æœåŠ¡å™¨å¤„ç†è¯·æ±‚ï¼Œè¿”å›ç»“æœ"></a>4 æœåŠ¡å™¨å¤„ç†è¯·æ±‚ï¼Œè¿”å›ç»“æœ</h3><p>æœåŠ¡å™¨ï¼Œè§£æè¯·æ±‚å¤´ï¼Œå¯¹æ¯”æ˜¯å¦è¿‡æœŸå­—æ®µï¼Œç¼“å­˜å­—æ®µï¼Œè¿”å›å¯¹åº”çš„çŠ¶æ€ç å’Œå†…å®¹ã€‚è¿”å›æ‰€æœ‰å†…å®¹åï¼Œå¯ä»¥å…³é—­è¿æ¥äº†äº²ã€‚</p>
<h3 id="5-æµè§ˆå™¨è§£æ-æ¸²æŸ“"><a href="#5-æµè§ˆå™¨è§£æ-æ¸²æŸ“" class="headerlink" title="5 æµè§ˆå™¨è§£æ/æ¸²æŸ“"></a>5 æµè§ˆå™¨è§£æ/æ¸²æŸ“</h3><p>domæ ‘è§£æï¼Œè½¬æ¢csså•ä½æˆé€šç”¨å•ä½ï¼Œcssdomè§£æï¼Œç»˜åˆ¶ã€‚ä¼˜å…ˆè§†å£ã€‚</p>
<ul>
<li>æ„å»º DOM æ ‘ã€æ ·å¼è®¡ç®—ã€å¸ƒå±€é˜¶æ®µã€åˆ†å±‚ã€æ …æ ¼åŒ–å’Œæ˜¾ç¤º<ul>
<li>æ„å»ºDOMæ ‘ï¼šhtmlå†…å®¹è§£ææˆDOMæ ‘ï¼ˆè¿™é‡Œé¢ç”¨åˆ°HTMLçš„parserï¼‰</li>
<li>cssæ ·å¼è¡¨ï¼Œè½¬ä¸ºæµè§ˆå™¨å¯ä»¥è¯»æ‡‚çš„CSSè§„åˆ™æ ‘</li>
<li>ç”±DOMæ ‘å’ŒCSSè§„åˆ™æ ‘ï¼Œåˆ›å»ºrenderæ ‘ï¼Œè®¡ç®—å¸ƒå±€ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ‰€æœ‰å…ƒç´ çš„å°ºå¯¸ã€ä½ç½®ã€è¿˜æœ‰positionã€z-indexã€overflow</li>
<li>ç»˜åˆ¶renderæ ‘ï¼Œç»˜åˆ¶é¡µé¢åƒç´ </li>
<li>GPUç»˜åˆ¶ï¼Œæ˜¾ç¤ºåˆ°æ˜¾ç¤ºå±</li>
</ul>
</li>
</ul>
<p>å°çŸ¥è¯†ç‚¹ï¼š</p>
<ul>
<li>HTMLçš„parserï¼š<ul>
<li>è½¬æ¢ï¼šHTMLç¼–ç æˆå­—ç¬¦</li>
<li>åˆ†è¯ï¼šç»™å­—ç¬¦ä»¬æ‰“ä¸Šæ ‡è®°Tokens</li>
<li>è¯æ³•ï¼štokensè½¬æ¢æˆåŒ…å«å±æ€§å’Œè§„åˆ™çš„å¯¹è±¡</li>
<li>DOMæ ‘åˆ›å»º</li>
</ul>
</li>
</ul>
<p>å‚è€ƒï¼š</p>
<ul>
<li><a href="https://mp.weixin.qq.com/s/DLq_GIkdnuOayThfi3jI0A">æ–‡ç« </a></li>
<li><a href="https://segmentfault.com/a/1190000012196642">https</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/26682342">https</a></li>
<li><a href="https://blog.csdn.net/weixin_34050389/article/details/93027673">è´Ÿè½½å‡è¡¡</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/If-Unmodified-Since">If-Unmodified-Since</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/If-Modified-Since">If-Modified-Since</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Expires">Expires</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Cache-Control">Cache-Control</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzI0MzIyMDM5Ng==&mid=2649825731&idx=1&sn=2c0835cebfee3a44e82d9efeb54f6e43&chksm=f175eb00c602621649fd46d7c9de87f7f08a4cdaa9e08808b938948584ca6977e24a5f5336ce&scene=21#wechat_redirect">æµè§ˆå™¨ç›¸å…³</a></li>
<li><a href="https://segmentfault.com/a/1190000013662126">å…¨é¢</a></li>
<li><a href="https://segmentfault.com/a/1190000012925872">æµè§ˆå™¨è¿›ç¨‹/çº¿ç¨‹</a></li>
</ul>
]]></content>
      <tags>
        <tag>æµè§ˆå™¨</tag>
      </tags>
  </entry>
  <entry>
    <title>æµè§ˆå™¨å¼‚æ­¥ï¼ˆä¸€ï¼‰</title>
    <url>/2020/07/17/%E6%B5%8F%E8%A7%88%E5%99%A8%E5%BC%82%E6%AD%A5%EF%BC%88%E4%B8%80%EF%BC%89/</url>
    <content><![CDATA[<blockquote>
<p>æ³¨ï¼š è½¬è½½ç“¶å­å›æ–‡ç«  <a href="https://github.com/sisterAn/blog/issues/11">è¯¦ç»†è¿æ¥</a></p>
</blockquote>
<p>å·²çŸ¥ï¼ŒJavaScript æ˜¯å•çº¿ç¨‹çš„ï¼Œå¤©ç”Ÿå¼‚æ­¥ï¼Œé€‚åˆ IO å¯†é›†å‹ï¼Œä¸é€‚åˆ CPU å¯†é›†å‹ï¼Œä½†æ˜¯ï¼Œä¸ºä»€ä¹ˆæ˜¯å¼‚æ­¥çš„ï¼Œå¼‚æ­¥ç”±ä½•è€Œæ¥çš„ï¼Œæˆ‘ä»¬å°†åœ¨è¿™é‡Œé€æ¸è®¨è®ºå®ç°ã€‚</p>
<h3 id="ä¸€ã€è¿›ç¨‹ä¸çº¿ç¨‹"><a href="#ä¸€ã€è¿›ç¨‹ä¸çº¿ç¨‹" class="headerlink" title="ä¸€ã€è¿›ç¨‹ä¸çº¿ç¨‹"></a>ä¸€ã€è¿›ç¨‹ä¸çº¿ç¨‹</h3><h4 id="1-æµè§ˆå™¨æ˜¯å¤šè¿›ç¨‹çš„"><a href="#1-æµè§ˆå™¨æ˜¯å¤šè¿›ç¨‹çš„" class="headerlink" title="1. æµè§ˆå™¨æ˜¯å¤šè¿›ç¨‹çš„"></a>1. æµè§ˆå™¨æ˜¯å¤šè¿›ç¨‹çš„</h4><p>å®ƒä¸»è¦åŒ…æ‹¬ä»¥ä¸‹è¿›ç¨‹ï¼š</p>
<ul>
<li>Browser è¿›ç¨‹ï¼šæµè§ˆå™¨çš„ä¸»è¿›ç¨‹ï¼Œå”¯ä¸€ï¼Œè´Ÿè´£åˆ›å»ºå’Œé”€æ¯å…¶å®ƒè¿›ç¨‹ã€ç½‘ç»œèµ„æºçš„ä¸‹è½½ä¸ç®¡ç†ã€æµè§ˆå™¨ç•Œé¢çš„å±•ç¤ºã€å‰è¿›åé€€ç­‰ã€‚</li>
<li>GPU è¿›ç¨‹ï¼šç”¨äº 3D ç»˜åˆ¶ç­‰ï¼Œæœ€å¤šä¸€ä¸ªã€‚</li>
<li>ç¬¬ä¸‰æ–¹æ’ä»¶è¿›ç¨‹ï¼šæ¯ç§ç±»å‹çš„æ’ä»¶å¯¹åº”ä¸€ä¸ªè¿›ç¨‹ï¼Œä»…å½“ä½¿ç”¨è¯¥æ’ä»¶æ—¶æ‰åˆ›å»ºã€‚</li>
<li>æµè§ˆå™¨æ¸²æŸ“è¿›ç¨‹ï¼ˆæµè§ˆå™¨å†…æ ¸ï¼‰ï¼šå†…éƒ¨æ˜¯å¤šçº¿ç¨‹çš„ï¼Œæ¯æ‰“å¼€ä¸€ä¸ªæ–°ç½‘é¡µå°±ä¼šåˆ›å»ºä¸€ä¸ªè¿›ç¨‹ï¼Œä¸»è¦ç”¨äºé¡µé¢æ¸²æŸ“ï¼Œè„šæœ¬æ‰§è¡Œï¼Œäº‹ä»¶å¤„ç†ç­‰ã€‚</li>
</ul>
<h4 id="2-æ¸²æŸ“è¿›ç¨‹ï¼ˆæµè§ˆå™¨å†…æ ¸ï¼‰"><a href="#2-æ¸²æŸ“è¿›ç¨‹ï¼ˆæµè§ˆå™¨å†…æ ¸ï¼‰" class="headerlink" title="2. æ¸²æŸ“è¿›ç¨‹ï¼ˆæµè§ˆå™¨å†…æ ¸ï¼‰"></a>2. æ¸²æŸ“è¿›ç¨‹ï¼ˆæµè§ˆå™¨å†…æ ¸ï¼‰</h4><p>æµè§ˆå™¨çš„æ¸²æŸ“è¿›ç¨‹æ˜¯å¤šçº¿ç¨‹çš„ï¼Œé¡µé¢çš„æ¸²æŸ“ï¼ŒJavaScript çš„æ‰§è¡Œï¼Œäº‹ä»¶çš„å¾ªç¯ï¼Œéƒ½åœ¨è¿™ä¸ªè¿›ç¨‹å†…è¿›è¡Œï¼š</p>
<ul>
<li>GUI æ¸²æŸ“çº¿ç¨‹ï¼šè´Ÿè´£æ¸²æŸ“æµè§ˆå™¨ç•Œé¢ï¼Œå½“ç•Œé¢éœ€è¦é‡ç»˜ï¼ˆRepaintï¼‰æˆ–ç”±äºæŸç§æ“ä½œå¼•å‘å›æµ(Reflow)æ—¶ï¼Œè¯¥çº¿ç¨‹å°±ä¼šæ‰§è¡Œã€‚</li>
<li>JavaScript å¼•æ“çº¿ç¨‹ï¼šä¹Ÿç§°ä¸º JavaScript å†…æ ¸ï¼Œè´Ÿè´£å¤„ç† Javascript è„šæœ¬ç¨‹åºã€è§£æ Javascript è„šæœ¬ã€è¿è¡Œä»£ç ç­‰ã€‚ï¼ˆä¾‹å¦‚ V8 å¼•æ“ï¼‰</li>
<li>äº‹ä»¶è§¦å‘çº¿ç¨‹ï¼šç”¨æ¥æ§åˆ¶æµè§ˆå™¨äº‹ä»¶å¾ªç¯ï¼Œæ³¨æ„è¿™ä¸å½’ JavaScript å¼•æ“çº¿ç¨‹ç®¡ï¼Œå½“äº‹ä»¶è¢«è§¦å‘æ—¶ï¼Œè¯¥çº¿ç¨‹ä¼šæŠŠäº‹ä»¶æ·»åŠ åˆ°å¾…å¤„ç†é˜Ÿåˆ—çš„é˜Ÿå°¾ï¼Œç­‰å¾… JavaScript å¼•æ“çš„å¤„ç†ã€‚</li>
<li>å®šæ—¶è§¦å‘å™¨çº¿ç¨‹ï¼šä¼ è¯´ä¸­çš„ <code>setInterval</code> ä¸ <code>setTimeout</code> æ‰€åœ¨çº¿ç¨‹ï¼Œæ³¨æ„ï¼ŒW3C åœ¨ HTML æ ‡å‡†ä¸­è§„å®šï¼Œè§„å®šè¦æ±‚ <code>setTimeout</code> ä¸­ä½äº 4ms çš„æ—¶é—´é—´éš”ç®—ä¸º 4ms ã€‚</li>
<li>å¼‚æ­¥ http è¯·æ±‚çº¿ç¨‹ï¼šåœ¨ <code>XMLHttpRequest</code> è¿æ¥åé€šè¿‡æµè§ˆå™¨æ–°å¼€ä¸€ä¸ªçº¿ç¨‹è¯·æ±‚ï¼Œå°†æ£€æµ‹åˆ°çŠ¶æ€å˜æ›´æ—¶ï¼Œå¦‚æœè®¾ç½®æœ‰å›è°ƒå‡½æ•°ï¼Œå¼‚æ­¥çº¿ç¨‹å°±<strong>äº§ç”ŸçŠ¶æ€å˜æ›´äº‹ä»¶</strong>ï¼Œå°†è¿™ä¸ªå›è°ƒå†æ”¾å…¥äº‹ä»¶é˜Ÿåˆ—ä¸­ã€‚å†ç”± JavaScript å¼•æ“æ‰§è¡Œã€‚</li>
</ul>
<p>æ³¨æ„ï¼Œ<strong>GUI æ¸²æŸ“çº¿ç¨‹ä¸ JavaScript å¼•æ“çº¿ç¨‹æ˜¯äº’æ–¥çš„</strong>ï¼Œå½“ JavaScript å¼•æ“æ‰§è¡Œæ—¶ GUI çº¿ç¨‹ä¼šè¢«æŒ‚èµ·ï¼ˆç›¸å½“äºè¢«å†»ç»“äº†ï¼‰ï¼ŒGUI æ›´æ–°ä¼šè¢«ä¿å­˜åœ¨ä¸€ä¸ªé˜Ÿåˆ—ä¸­<strong>ç­‰åˆ° JavaScript å¼•æ“ç©ºé—²æ—¶</strong>ç«‹å³è¢«æ‰§è¡Œã€‚æ‰€ä»¥å¦‚æœ JavaScript æ‰§è¡Œçš„æ—¶é—´è¿‡é•¿ï¼Œè¿™æ ·å°±ä¼šé€ æˆé¡µé¢çš„æ¸²æŸ“ä¸è¿è´¯ï¼Œå¯¼è‡´é¡µé¢æ¸²æŸ“åŠ è½½é˜»å¡ã€‚</p>
<h3 id="äºŒã€å•çº¿ç¨‹çš„-JavaScript"><a href="#äºŒã€å•çº¿ç¨‹çš„-JavaScript" class="headerlink" title="äºŒã€å•çº¿ç¨‹çš„ JavaScript"></a>äºŒã€å•çº¿ç¨‹çš„ JavaScript</h3><p>æ‰€è°“å•çº¿ç¨‹ï¼Œæ˜¯æŒ‡åœ¨ JavaScript å¼•æ“ä¸­è´Ÿè´£è§£é‡Šå’Œæ‰§è¡Œ JavaScript ä»£ç çš„çº¿ç¨‹å”¯ä¸€ï¼ŒåŒä¸€æ—¶é—´ä¸Šåªèƒ½æ‰§è¡Œä¸€ä»¶ä»»åŠ¡ã€‚</p>
<p><strong>é—®é¢˜ï¼šé¦–å…ˆä¸ºä»€ä¹ˆè¦å¼•å…¥å•çº¿ç¨‹ï¼Ÿ</strong></p>
<p>æˆ‘ä»¬çŸ¥é“ï¼š</p>
<ul>
<li>æµè§ˆå™¨éœ€è¦æ¸²æŸ“ DOM</li>
<li>JavaScript å¯ä»¥ä¿®æ”¹ DOM ç»“æ„</li>
<li>JavaScript æ‰§è¡Œæ—¶ï¼Œæµè§ˆå™¨ DOM æ¸²æŸ“åœæ­¢</li>
</ul>
<p>å¦‚æœ JavaScript å¼•æ“çº¿ç¨‹ä¸æ˜¯å•çº¿ç¨‹çš„ï¼Œé‚£ä¹ˆå¯ä»¥åŒæ—¶æ‰§è¡Œå¤šæ®µ JavaScriptï¼Œå¦‚æœè¿™å¤šæ®µ JavaScript éƒ½ä¿®æ”¹ DOMï¼Œé‚£ä¹ˆå°±ä¼šå‡ºç° DOM å†²çªã€‚</p>
<p>ä½ å¯èƒ½ä¼šè¯´ï¼Œ<a href="http://www.ruanyifeng.com/blog/2018/07/web-worker.html">web worker</a> å°±æ”¯æŒå¤šçº¿ç¨‹ï¼Œä½†æ˜¯ web worker ä¸èƒ½è®¿é—® window å¯¹è±¡ï¼Œdocument å¯¹è±¡ç­‰ã€‚</p>
<p><strong>åŸå› ï¼šé¿å… DOM æ¸²æŸ“çš„å†²çª</strong></p>
<p>å½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºæµè§ˆå™¨å¼•å…¥<strong>é”</strong> çš„æœºåˆ¶æ¥è§£å†³è¿™äº›å†²çªï¼Œä½†å…¶å¤§å¤§æé«˜äº†å¤æ‚æ€§ï¼Œæ‰€ä»¥ JavaScriptä»è¯ç”Ÿå¼€å§‹å°±é€‰æ‹©äº†å•çº¿ç¨‹æ‰§è¡Œã€‚</p>
<p>å¼•å…¥å•çº¿ç¨‹å°±æ„å‘³ç€ï¼Œæ‰€æœ‰ä»»åŠ¡éœ€è¦æ’é˜Ÿï¼Œå‰ä¸€ä¸ªä»»åŠ¡ç»“æŸï¼Œæ‰ä¼šæ‰§è¡Œåä¸€ä¸ªä»»åŠ¡ã€‚è¿™åŒæ—¶åˆå¯¼è‡´äº†ä¸€ä¸ªé—®é¢˜ï¼šå¦‚æœå‰ä¸€ä¸ªä»»åŠ¡è€—æ—¶å¾ˆé•¿ï¼Œåä¸€ä¸ªä»»åŠ¡å°±ä¸å¾—ä¸ä¸€ç›´ç­‰ç€ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å®ä¾‹1</span></span><br><span class="line"><span class="keyword">let</span> i, sum = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">1000000000</span>; i ++) &#123;</span><br><span class="line">    sum += i</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(sum)</span><br></pre></td></tr></table></figure>

<p>åœ¨å®ä¾‹1ä¸­ï¼Œ<code>sum</code> å¹¶ä¸èƒ½ç«‹åˆ»æ‰“å°å‡ºæ¥ï¼Œå¿…é¡»åœ¨ for å¾ªç¯æ‰§è¡Œå®Œæˆä¹‹åæ‰èƒ½æ‰§è¡Œ <code>console.log(sum)</code> ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å®ä¾‹2</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">1</span>)</span><br><span class="line">alert(<span class="string">&#x27;hello&#x27;</span>)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<p>åœ¨å®ä¾‹2ä¸­ï¼Œæµè§ˆå™¨å…ˆæ‰“å° <code>1</code> ï¼Œç„¶åå¼¹å‡ºå¼¹æ¡†ï¼Œç‚¹å‡»ç¡®å®šåæ‰æ‰§è¡Œ <code>console.log(2)</code> ã€‚</p>
<p><strong>æ€»ç»“ï¼š</strong></p>
<ul>
<li>ä¼˜ç‚¹ï¼šå®ç°æ¯”è¾ƒç®€å•ï¼Œæ‰§è¡Œç¯å¢ƒç›¸å¯¹å•çº¯</li>
<li>ç¼ºç‚¹ï¼šåªè¦æœ‰ä¸€ä¸ªä»»åŠ¡è€—æ—¶å¾ˆé•¿ï¼Œåé¢çš„ä»»åŠ¡éƒ½å¿…é¡»æ’é˜Ÿç­‰ç€ï¼Œä¼šæ‹–å»¶æ•´ä¸ªç¨‹åºçš„æ‰§è¡Œã€‚å¸¸è§çš„æµè§ˆå™¨æ— å“åº”ï¼ˆå‡æ­»ï¼‰ï¼Œå¾€å¾€å°±æ˜¯å› ä¸ºæŸä¸€æ®µ Javascript ä»£ç é•¿æ—¶é—´è¿è¡Œï¼ˆæ¯”å¦‚æ­»å¾ªç¯ï¼‰ï¼Œå¯¼è‡´æ•´ä¸ªé¡µé¢å¡åœ¨è¿™ä¸ªåœ°æ–¹ï¼Œå…¶ä»–ä»»åŠ¡æ— æ³•æ‰§è¡Œã€‚</li>
</ul>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒJavaScript è¯­è¨€å°†ä»»åŠ¡çš„æ‰§è¡Œæ¨¡å¼åˆ†ä¸ºä¸¤ç§ï¼šåŒæ­¥å’Œå¼‚æ­¥</p>
<h3 id="ä¸‰ã€åŒæ­¥ä¸å¼‚æ­¥"><a href="#ä¸‰ã€åŒæ­¥ä¸å¼‚æ­¥" class="headerlink" title="ä¸‰ã€åŒæ­¥ä¸å¼‚æ­¥"></a>ä¸‰ã€åŒæ­¥ä¸å¼‚æ­¥</h3><h4 id="1-åŒæ­¥"><a href="#1-åŒæ­¥" class="headerlink" title="1. åŒæ­¥"></a>1. åŒæ­¥</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">func(args...)</span><br></pre></td></tr></table></figure>

<p>å¦‚æœåœ¨å‡½æ•° <code>func</code> è¿”å›çš„æ—¶å€™ï¼Œè°ƒç”¨è€…å°±èƒ½å¤Ÿå¾—åˆ°é¢„æœŸç»“æœ(å³æ‹¿åˆ°äº†é¢„æœŸçš„è¿”å›å€¼æˆ–è€…çœ‹åˆ°äº†é¢„æœŸçš„æ•ˆæœ)ï¼Œé‚£ä¹ˆè¿™ä¸ªå‡½æ•°å°±æ˜¯åŒæ­¥çš„ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="number">1</span></span><br><span class="line"><span class="built_in">Math</span>.floor(a)</span><br><span class="line"><span class="built_in">console</span>.log(a) <span class="comment">// 1</span></span><br></pre></td></tr></table></figure>

<h4 id="2-å¼‚æ­¥"><a href="#2-å¼‚æ­¥" class="headerlink" title="2. å¼‚æ­¥"></a>2. å¼‚æ­¥</h4><p>å¦‚æœåœ¨å‡½æ•° <code>func</code> è¿”å›çš„æ—¶å€™ï¼Œè°ƒç”¨è€…è¿˜ä¸èƒ½å¤Ÿå¾—åˆ°é¢„æœŸç»“æœï¼Œè€Œæ˜¯éœ€è¦åœ¨å°†æ¥é€šè¿‡ä¸€å®šçš„æ‰‹æ®µå¾—åˆ°ï¼Œé‚£ä¹ˆè¿™ä¸ªå‡½æ•°å°±æ˜¯å¼‚æ­¥çš„ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">fs.readFile(<span class="string">&#x27;foo.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><strong>æ€»ç»“ï¼š</strong></p>
<p>JavaScript é‡‡ç”¨å¼‚æ­¥ç¼–ç¨‹åŸå› æœ‰ä¸¤ç‚¹ï¼Œ</p>
<ul>
<li>ä¸€æ˜¯ JavaScript æ˜¯å•çº¿ç¨‹ï¼›</li>
<li>äºŒæ˜¯ä¸ºäº†æé«˜ CPU çš„åˆ©ç”¨ç‡ã€‚</li>
</ul>
<h3 id="å››ã€å¼‚æ­¥è¿‡ç¨‹"><a href="#å››ã€å¼‚æ­¥è¿‡ç¨‹" class="headerlink" title="å››ã€å¼‚æ­¥è¿‡ç¨‹"></a>å››ã€å¼‚æ­¥è¿‡ç¨‹</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">fs.readFile(<span class="string">&#x27;data.json&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>åœ¨æ‰§è¡Œè¿™æ®µä»£ç æ—¶ï¼Œ<code>fs.readFile</code> å‡½æ•°è¿”å›æ—¶ï¼Œå¹¶ä¸ä¼šç«‹åˆ»æ‰“å° <code>data</code> ï¼Œåªæœ‰ <code>data.json</code> è¯»å–å®Œæˆæ—¶æ‰æ‰“å°ã€‚ä¹Ÿå°±æ˜¯å¼‚æ­¥å‡½æ•° <code>fs.readFile</code> æ‰§è¡Œå¾ˆå¿«ï¼Œä½†åé¢è¿˜æœ‰å·¥ä½œçº¿ç¨‹æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡ã€é€šçŸ¥ä¸»çº¿ç¨‹ã€ä¸»çº¿ç¨‹å›è°ƒç­‰æ“ä½œï¼Œè¿™ä¸ªè¿‡ç¨‹å°±å«åšå¼‚æ­¥è¿‡ç¨‹ã€‚</p>
<p>ä¸»çº¿ç¨‹å‘èµ·ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œç›¸åº”çš„å·¥ä½œçº¿ç¨‹æ¥å—è¯·æ±‚å¹¶å‘ŠçŸ¥ä¸»çº¿ç¨‹å·²æ”¶åˆ°ï¼ˆå¼‚æ­¥å‡½æ•°è¿”å›ï¼‰ï¼›ä¸»çº¿ç¨‹ç»§ç»­æ‰§è¡Œåé¢çš„ä»»åŠ¡ï¼ŒåŒæ—¶å·¥ä½œçº¿ç¨‹æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡ï¼›å·¥ä½œçº¿ç¨‹å®Œæˆä»»åŠ¡åï¼Œé€šçŸ¥ä¸»çº¿ç¨‹ï¼›ä¸»çº¿ç¨‹æ”¶åˆ°é€šçŸ¥åï¼Œæ‰§è¡Œä¸€å®šçš„åŠ¨ä½œï¼ˆè°ƒç”¨å›è°ƒå‡½æ•°ï¼‰ã€‚</p>
<p>å·¥ä½œçº¿ç¨‹åœ¨å¼‚æ­¥æ“ä½œå®Œæˆåé€šçŸ¥ä¸»çº¿ç¨‹ï¼Œé‚£ä¹ˆè¿™ä¸ªé€šçŸ¥æœºåˆ¶åˆæ˜¯å¦‚ä½•æ˜¾ç°ï¼Ÿç­”æ¡ˆå°±æ˜¯å°±æ˜¯æ¶ˆæ¯é˜Ÿåˆ—ä¸äº‹ä»¶å¾ªç¯ã€‚</p>
<h3 id="äº”ã€æ¶ˆæ¯é˜Ÿåˆ—ä¸äº‹ä»¶å¾ªç¯"><a href="#äº”ã€æ¶ˆæ¯é˜Ÿåˆ—ä¸äº‹ä»¶å¾ªç¯" class="headerlink" title="äº”ã€æ¶ˆæ¯é˜Ÿåˆ—ä¸äº‹ä»¶å¾ªç¯"></a>äº”ã€æ¶ˆæ¯é˜Ÿåˆ—ä¸äº‹ä»¶å¾ªç¯</h3><p>å·¥ä½œçº¿ç¨‹å°†æ¶ˆæ¯æ”¾åœ¨æ¶ˆæ¯é˜Ÿåˆ—ï¼Œä¸»çº¿ç¨‹é€šè¿‡äº‹ä»¶å¾ªç¯è¿‡ç¨‹å»å–æ¶ˆæ¯ã€‚</p>
<ul>
<li>æ¶ˆæ¯é˜Ÿåˆ—ï¼šæ¶ˆæ¯é˜Ÿåˆ—æ˜¯ä¸€ä¸ªå…ˆè¿›å…ˆå‡ºçš„é˜Ÿåˆ—ï¼Œå®ƒé‡Œé¢å­˜æ”¾ç€å„ç§æ¶ˆæ¯ã€‚</li>
<li>äº‹ä»¶å¾ªç¯ï¼šäº‹ä»¶å¾ªç¯æ˜¯æŒ‡ä¸»çº¿ç¨‹é‡å¤ä»æ¶ˆæ¯é˜Ÿåˆ—ä¸­å–æ¶ˆæ¯ã€æ‰§è¡Œçš„è¿‡ç¨‹ã€‚</li>
</ul>
<h4 id="1-äº‹ä»¶å¾ªç¯ï¼ˆeventloopï¼‰"><a href="#1-äº‹ä»¶å¾ªç¯ï¼ˆeventloopï¼‰" class="headerlink" title="1. äº‹ä»¶å¾ªç¯ï¼ˆeventloopï¼‰"></a>1. äº‹ä»¶å¾ªç¯ï¼ˆeventloopï¼‰</h4><p>ä¸»çº¿ç¨‹ä¸æ–­çš„ä»æ¶ˆæ¯é˜Ÿåˆ—ä¸­å–æ¶ˆæ¯ï¼Œæ‰§è¡Œæ¶ˆæ¯ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºäº‹ä»¶å¾ªç¯ï¼Œè¿™ç§æœºåˆ¶å«äº‹ä»¶å¾ªç¯æœºåˆ¶ï¼Œå–ä¸€æ¬¡æ¶ˆæ¯å¹¶æ‰§è¡Œçš„è¿‡ç¨‹å«ä¸€æ¬¡å¾ªç¯ã€‚</p>
<p>å¤§è‡´å®ç°è¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span>(<span class="literal">true</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> message = queue.get()</span><br><span class="line">    execute(message)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">$.ajax(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;xxxx&#x27;</span>,</span><br><span class="line">    <span class="attr">success</span>: <span class="function"><span class="keyword">function</span>(<span class="params">result</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="number">1</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">2</span>)</span><br><span class="line">&#125;, <span class="number">100</span>)</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">3</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">4</span>)</span><br><span class="line"><span class="comment">// outputï¼š4321 æˆ– 4312</span></span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­ï¼Œä¸»çº¿ç¨‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä¸»çº¿ç¨‹</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">4</span>)</span><br></pre></td></tr></table></figure>

<p>å¼‚æ­¥é˜Ÿåˆ—ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å¼‚æ­¥é˜Ÿåˆ—</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">3</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="comment">// 100mså</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">2</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// ajaxåŠ è½½å®Œæˆä¹‹å</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">1</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>äº‹ä»¶å¾ªç¯æ˜¯JavaScriptå®ç°å¼‚æ­¥çš„å…·ä½“è§£å†³æ–¹æ¡ˆï¼Œå…¶ä¸­åŒæ­¥ä»£ç ï¼Œç›´æ¥æ‰§è¡Œï¼›å¼‚æ­¥å‡½æ•°å…ˆæ”¾åœ¨å¼‚æ­¥é˜Ÿåˆ—ä¸­ï¼Œå¾…åŒæ­¥å‡½æ•°æ‰§è¡Œå®Œæ¯•åï¼Œè½®è¯¢æ‰§è¡Œ å¼‚æ­¥é˜Ÿåˆ— çš„å›è°ƒå‡½æ•°ã€‚</strong></p>
<h4 id="2-æ¶ˆæ¯é˜Ÿåˆ—"><a href="#2-æ¶ˆæ¯é˜Ÿåˆ—" class="headerlink" title="2. æ¶ˆæ¯é˜Ÿåˆ—"></a>2. æ¶ˆæ¯é˜Ÿåˆ—</h4><p>å…¶ä¸­ï¼Œæ¶ˆæ¯å°±æ˜¯æ³¨å†Œå¼‚æ­¥ä»»åŠ¡æ—¶æ·»åŠ çš„å›è°ƒå‡½æ•°ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">$.ajax(<span class="string">&#x27;XXX&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(res)</span><br><span class="line">&#125;)</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>ä¸»çº¿ç¨‹åœ¨å‘èµ· AJAX è¯·æ±‚åï¼Œä¼šç»§ç»­æ‰§è¡Œå…¶ä»–ä»£ç ï¼ŒAJAX çº¿ç¨‹è´Ÿè´£è¯·æ±‚ <code>XXX</code>ï¼Œæ‹¿åˆ°è¯·æ±‚åï¼Œä¼šå°è£…æˆ JavaScript å¯¹è±¡ï¼Œç„¶åæ„é€ ä¸€æ¡æ¶ˆæ¯ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ¶ˆæ¯é˜Ÿåˆ—é‡Œçš„æ¶ˆæ¯</span></span><br><span class="line"><span class="keyword">var</span> message = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    callback(response)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­ <code>callback</code> æ˜¯ AJAX ç½‘ç»œè¯·æ±‚æˆåŠŸå“åº”æ—¶çš„å›è°ƒå‡½æ•°ã€‚</p>
<p>ä¸»çº¿ç¨‹åœ¨æ‰§è¡Œå®Œå½“å‰å¾ªç¯ä¸­çš„æ‰€æœ‰ä»£ç åï¼Œå°±ä¼šåˆ°æ¶ˆæ¯é˜Ÿåˆ—å–å‡ºè¿™æ¡æ¶ˆæ¯(ä¹Ÿå°±æ˜¯ <code>message</code> å‡½æ•°)ï¼Œå¹¶æ‰§è¡Œå®ƒã€‚åˆ°æ­¤ä¸ºæ­¢ï¼Œå°±å®Œæˆäº†å·¥ä½œçº¿ç¨‹å¯¹ä¸»çº¿ç¨‹çš„ <code>é€šçŸ¥</code> ï¼Œå›è°ƒå‡½æ•°ä¹Ÿå°±å¾—åˆ°äº†æ‰§è¡Œã€‚å¦‚æœä¸€å¼€å§‹ä¸»çº¿ç¨‹å°±æ²¡æœ‰æä¾›å›è°ƒå‡½æ•°ï¼ŒAJAX çº¿ç¨‹åœ¨æ”¶åˆ° HTTP å“åº”åï¼Œä¹Ÿå°±æ²¡å¿…è¦é€šçŸ¥ä¸»çº¿ç¨‹ï¼Œä»è€Œä¹Ÿæ²¡å¿…è¦å¾€æ¶ˆæ¯é˜Ÿåˆ—æ”¾æ¶ˆæ¯ã€‚</p>
<p><img src="https://camo.githubusercontent.com/2f5acdeefff9a281d03db7defe011fff037cf1ee/687474703a2f2f7265736f757263652e6d757969792e636e2f696d6167652f32303230303232353139333333392e706e67"></p>
<p>å¼‚æ­¥è¿‡ç¨‹ä¸­çš„å›è°ƒå‡½æ•°ï¼Œ<strong>ä¸€å®šä¸åœ¨å½“å‰è¿™ä¸€è½®äº‹ä»¶å¾ªç¯ä¸­æ‰§è¡Œ</strong>ã€‚</p>
<h3 id="å…­ã€å¼‚æ­¥ä¸äº‹ä»¶"><a href="#å…­ã€å¼‚æ­¥ä¸äº‹ä»¶" class="headerlink" title="å…­ã€å¼‚æ­¥ä¸äº‹ä»¶"></a>å…­ã€å¼‚æ­¥ä¸äº‹ä»¶</h3><p>æ¶ˆæ¯é˜Ÿåˆ—ä¸­çš„æ¯æ¡æ¶ˆæ¯å®é™…ä¸Šéƒ½å¯¹åº”ç€ä¸€ä¸ªäº‹ä»¶ã€‚</p>
<p>å…¶ä¸­ä¸€ä¸ªé‡è¦çš„å¼‚æ­¥è¿‡ç¨‹å°±æ˜¯ï¼š <strong>DOMäº‹ä»¶</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> button = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;button&#x27;</span>)</span><br><span class="line">button.addEventLister(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;äº‹ä»¶&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>ä»å¼‚æ­¥çš„è§’åº¦çœ‹ï¼Œ<code>addEventLister</code> å‡½æ•°å°±æ˜¯å¼‚æ­¥è¿‡ç¨‹çš„å‘èµ·å‡½æ•°ï¼Œäº‹ä»¶ç›‘å¬å™¨å‡½æ•°å°±æ˜¯å¼‚æ­¥è¿‡ç¨‹çš„å›è°ƒå‡½æ•°ã€‚äº‹ä»¶è§¦å‘æ—¶ï¼Œè¡¨ç¤ºå¼‚æ­¥ä»»åŠ¡å®Œæˆï¼Œä¼šå°†äº‹ä»¶ç›‘å¬å™¨å‡½æ•°å°è£…æˆä¸€æ¡æ¶ˆæ¯æ”¾åœ¨æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œç­‰å¾…ä¸»çº¿ç¨‹æ‰§è¡Œã€‚</p>
<p>äº‹ä»¶çš„æ¦‚å¿µå®é™…ä¸Šå¹¶ä¸æ˜¯å¿…é¡»çš„ï¼Œäº‹ä»¶æœºåˆ¶å®é™…ä¸Šå°±æ˜¯å¼‚æ­¥è¿‡ç¨‹çš„é€šçŸ¥æœºåˆ¶ã€‚</p>
<p>å¦å¤–ï¼Œæ‰€æœ‰çš„å¼‚æ­¥è¿‡ç¨‹ä¹Ÿéƒ½å¯ä»¥ç”¨äº‹ä»¶æ¥æè¿°ã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">setTimeout</span>(func, <span class="number">1000</span>)</span><br><span class="line"><span class="comment">// å¯ä»¥çœ‹æˆï¼š</span></span><br><span class="line">timer.addEventLister(<span class="string">&#x27;timeout&#x27;</span>, <span class="number">1000</span>, func)</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­å…³äºäº‹ä»¶çš„è¯¦ç»†æè¿°ï¼Œå¯ä»¥çœ‹è¿™ç¯‡æ–‡ç« ï¼š <a href="http://blog.xieliqun.com/2016/08/12/event-delegate/">äº‹ä»¶ç»‘å®šã€äº‹ä»¶ç›‘å¬ã€äº‹ä»¶å§”æ‰˜</a>ï¼Œè¿™é‡Œä¸å†æ·±å…¥ä»‹ç»ã€‚</p>
<h3 id="ä¸ƒã€ç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…"><a href="#ä¸ƒã€ç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…" class="headerlink" title="ä¸ƒã€ç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…"></a>ä¸ƒã€ç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…</h3><p>ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…é—®é¢˜æ˜¯çº¿ç¨‹æ¨¡å‹ä¸­çš„ç»å…¸é—®é¢˜ï¼šç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…åœ¨åŒä¸€æ—¶é—´æ®µå†…å…±ç”¨åŒä¸€ä¸ªå­˜å‚¨ç©ºé—´ï¼Œç”Ÿäº§è€…å¾€å­˜å‚¨ç©ºé—´ä¸­æ·»åŠ æ•°æ®ï¼Œæ¶ˆè´¹è€…ä»å­˜å‚¨ç©ºé—´ä¸­å–èµ°æ•°æ®ï¼Œå½“å­˜å‚¨ç©ºé—´ä¸ºç©ºæ—¶ï¼Œæ¶ˆè´¹è€…é˜»å¡ï¼Œå½“å­˜å‚¨ç©ºé—´æ»¡æ—¶ï¼Œç”Ÿäº§è€…é˜»å¡ã€‚</p>
<p><img src="https://camo.githubusercontent.com/a717134740586438955fb819b2b76d07ff4d3295/687474703a2f2f7265736f757263652e6d757969792e636e2f696d6167652f32303230303232353139323732312e676966"></p>
<p>ä»ç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…çš„è§’åº¦çœ‹ï¼Œå¼‚æ­¥è¿‡ç¨‹æ˜¯è¿™æ ·çš„ï¼š</p>
<p>å·¥ä½œçº¿ç¨‹æ˜¯ç”Ÿäº§è€…ï¼Œä¸»çº¿ç¨‹æ˜¯æ¶ˆè´¹è€…(åªæœ‰ä¸€ä¸ªæ¶ˆè´¹è€…)ã€‚å·¥ä½œçº¿ç¨‹æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡ï¼Œæ‰§è¡Œå®ŒæˆåæŠŠå¯¹åº”çš„å›è°ƒå‡½æ•°å°è£…æˆä¸€æ¡æ¶ˆæ¯æ”¾åˆ°æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼›ä¸»çº¿ç¨‹ä¸æ–­åœ°ä»æ¶ˆæ¯é˜Ÿåˆ—ä¸­å–æ¶ˆæ¯å¹¶æ‰§è¡Œï¼Œå½“æ¶ˆæ¯é˜Ÿåˆ—ç©ºæ—¶ä¸»çº¿ç¨‹é˜»å¡ï¼Œç›´åˆ°æ¶ˆæ¯é˜Ÿåˆ—å†æ¬¡éç©ºã€‚</p>
<p>é‚£ä¹ˆå¼‚æ­¥çš„å®ç°æ–¹å¼æœ‰å“ªäº›ï¼Ÿ</p>
<ul>
<li>ES6ä¹‹å‰ï¼šå›è°ƒå‡½æ•°ã€eventloopäº‹ä»¶æœºåˆ¶ã€Promiseã€å‘å¸ƒ/è®¢é˜…</li>
<li>ES6ï¼šGenerator</li>
<li>ES7: Async/Await</li>
</ul>
<hr>
<p>å‚è€ƒï¼š<br><a href="https://github.com/sisterAn/blog/issues/11">ç“¶å­å› blog</a></p>
<p><a href="https://github.com/sisterAn/blog/issues/23">ç“¶å­å› Generator</a></p>
<p><a href="https://github.com/sisterAn/blog/issues/27">ç“¶å­å› coå‡½æ•°</a></p>
]]></content>
      <tags>
        <tag>JS</tag>
      </tags>
  </entry>
  <entry>
    <title>æµè§ˆå™¨å¼‚æ­¥ï¼ˆä¸‰ï¼‰</title>
    <url>/2020/07/18/%E6%B5%8F%E8%A7%88%E5%99%A8%E5%BC%82%E6%AD%A5%EF%BC%88%E4%B8%89%EF%BC%89%E4%B9%8BPromise%E5%AE%9E%E7%8E%B0/</url>
    <content><![CDATA[<blockquote>
<p>æ­¤ç¯‡åšæ–‡è½¬è½½è‡ªç“¶å­å›çš„blog <a href="https://github.com/sisterAn/blog/issues/13">é“¾æ¥</a>ï¼Œå¹¶åŠ ä»¥è‡ªå·±çš„ç†è§£å’Œæ³¨é‡Šã€‚</p>
</blockquote>
<h3 id="Promiseæœ¬è´¨"><a href="#Promiseæœ¬è´¨" class="headerlink" title="Promiseæœ¬è´¨"></a>Promiseæœ¬è´¨</h3><p><strong>Promiseå°±æ˜¯ä¸ºäº†è§£å†³callbackçš„é—®é¢˜è€Œäº§ç”Ÿçš„ã€‚</strong></p>
<p>Promise æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªç»‘å®šäº†å›è°ƒçš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯å°†å›è°ƒä¼ å›å‡½æ•°å†…éƒ¨ã€‚</p>
<p><strong>å¼€é—¨è§å±±ï¼ŒPromiseè§£å†³çš„æ˜¯å›è°ƒå‡½æ•°å¤„ç†å¼‚æ­¥çš„ç¬¬2ä¸ªé—®é¢˜ï¼šæ§åˆ¶åè½¬</strong>ã€‚</p>
<p>æˆ‘ä»¬æŠŠä¸Šé¢é‚£ä¸ªå¤šå±‚å›è°ƒåµŒå¥—çš„ä¾‹å­ç”¨Promiseçš„æ–¹å¼é‡æ„ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> getPromise1 = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Promsie(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">        $.ajax(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">&#x27;XXX1&#x27;</span>,</span><br><span class="line">            <span class="attr">success</span>: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">               <span class="keyword">let</span> key = data;</span><br><span class="line">               resolve(key);         </span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">error</span>: <span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line">                reject(err);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> getPromise2 = <span class="function"><span class="keyword">function</span> (<span class="params">key</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Promsie(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">        $.ajax(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">&#x27;XXX2&#x27;</span>,</span><br><span class="line">            <span class="attr">data</span>: &#123;</span><br><span class="line">                <span class="attr">key</span>: key</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">success</span>: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">                resolve(data);         </span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">error</span>: <span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line">                reject(err);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> getPromise3 = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Promsie(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">        $.ajax(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">&#x27;XXX3&#x27;</span>,</span><br><span class="line">            <span class="attr">success</span>: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">                resolve(data);         </span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">error</span>: <span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line">                reject(err);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">getPromise1()</span><br><span class="line">    .then(<span class="function"><span class="keyword">function</span> (<span class="params">key</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> getPromise2(key);</span><br><span class="line">    &#125;)</span><br><span class="line">    .then(<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> getPromise3(data);</span><br><span class="line">    &#125;)</span><br><span class="line">    .then(<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">    	<span class="comment">// todo</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;ä¸šåŠ¡æ•°æ®ï¼š&#x27;</span>, data);</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch(<span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(err);</span><br><span class="line">    &#125;); </span><br></pre></td></tr></table></figure>

<p>Promise åœ¨ä¸€å®šç¨‹åº¦ä¸Šå…¶å®æ”¹å–„äº†å›è°ƒå‡½æ•°çš„ä¹¦å†™æ–¹å¼ï¼›å¦å¤–é€»è¾‘æ€§æ›´æ˜æ˜¾äº†ï¼Œå°†å¼‚æ­¥ä¸šåŠ¡æå–æˆå•ä¸ªå‡½æ•°ï¼Œæ•´ä¸ªæµç¨‹å¯ä»¥çœ‹åˆ°æ˜¯ä¸€æ­¥æ­¥å‘ä¸‹æ‰§è¡Œçš„ï¼Œä¾èµ–å±‚çº§ä¹Ÿå¾ˆæ¸…æ™°ï¼Œæœ€åéœ€è¦çš„æ•°æ®æ˜¯åœ¨æ•´ä¸ªä»£ç çš„æœ€åä¸€æ­¥è·å¾—ã€‚</p>
<p>æ‰€ä»¥ï¼ŒPromiseåœ¨ä¸€å®šç¨‹åº¦ä¸Šè§£å†³äº†å›è°ƒå‡½æ•°çš„ä¹¦å†™ç»“æ„é—®é¢˜ï¼Œä½†å›è°ƒå‡½æ•°ä¾ç„¶åœ¨ä¸»æµç¨‹ä¸Šå­˜åœ¨ï¼Œåªä¸è¿‡éƒ½æ”¾åˆ°äº†then(â€¦)é‡Œé¢ï¼Œå’Œæˆ‘ä»¬å¤§è„‘é¡ºåºçº¿æ€§çš„æ€ç»´é€»è¾‘è¿˜æ˜¯æœ‰å‡ºå…¥çš„ã€‚</p>
<h3 id="Promise-æ˜¯ä»€ä¹ˆ"><a href="#Promise-æ˜¯ä»€ä¹ˆ" class="headerlink" title="Promise æ˜¯ä»€ä¹ˆ"></a>Promise æ˜¯ä»€ä¹ˆ</h3><p>Promiseæ˜¯ä»€ä¹ˆï¼Œæ— è®ºæ˜¯ES6çš„Promiseä¹Ÿå¥½ï¼ŒjQueryçš„Promiseä¹Ÿå¥½ï¼Œä¸åŒçš„åº“æœ‰ä¸åŒçš„å®ç°ï¼Œä½†æ˜¯å¤§å®¶éµå¾ªçš„éƒ½æ˜¯åŒä¸€å¥—è§„èŒƒï¼Œæ‰€ä»¥ï¼ŒPromiseå¹¶ä¸æŒ‡ç‰¹å®šçš„æŸä¸ªå®ç°ï¼Œ<strong>å®ƒæ˜¯ä¸€ç§è§„èŒƒï¼Œæ˜¯ä¸€å¥—å¤„ç†JavaScriptå¼‚æ­¥çš„æœºåˆ¶</strong>ã€‚</p>
<p>Promiseçš„è§„èŒƒä¼šå¤šï¼Œå¦‚Promise/Aã€Promise/Bã€Promise/Dä»¥åŠPromise/Açš„å‡çº§ç‰ˆPromise/A+ï¼Œå…¶ä¸­ES6éµå¾ªPromise/A+è§„èŒƒï¼Œæœ‰å…³Promise/A+ï¼Œä½ å¯ä»¥å‚è€ƒä¸€ä¸‹ï¼š</p>
<ul>
<li>è‹±æ–‡ç‰ˆï¼š<a href="https://promisesaplus.com/">Promise/A+</a></li>
<li>ç¿»è¯‘ç‰ˆï¼š<a href="http://www.ituring.com.cn/article/66566">ã€ç¿»è¯‘ã€‘Promises/A+è§„èŒƒ</a></li>
</ul>
<p>è¿™é‡Œåªç®€è¦ä»‹ç»ä¸‹å‡ ç‚¹ä¸æ¥ä¸‹æ¥å†…å®¹ç›¸å…³çš„è§„èŒƒï¼š</p>
<ul>
<li>Promise æœ¬è´¨æ˜¯ä¸€ä¸ªçŠ¶æ€æœºï¼Œæ¯ä¸ª Promise æœ‰ä¸‰ç§çŠ¶æ€ï¼špendingã€resolvedä»¥åŠrejectedã€‚çŠ¶æ€è½¬å˜åªèƒ½æ˜¯pending â€”resolved æˆ–è€… pending â€”rejectedã€‚çŠ¶æ€è½¬å˜ä¸å¯é€†ã€‚</li>
<li>then æ–¹æ³•å¯ä»¥è¢«åŒä¸€ä¸ª promise è°ƒç”¨å¤šæ¬¡ã€‚</li>
<li>then æ–¹æ³•å¿…é¡»è¿”å›ä¸€ä¸ª promiseã€‚è§„èŒƒ2.2.7ä¸­è§„å®šï¼Œ then å¿…é¡»è¿”å›ä¸€ä¸ªæ–°çš„ Promise</li>
<li>å€¼ç©¿é€</li>
</ul>
<h3 id="Promise-å®ç°åŠæºç è§£è¯»"><a href="#Promise-å®ç°åŠæºç è§£è¯»" class="headerlink" title="Promise å®ç°åŠæºç è§£è¯»"></a>Promise å®ç°åŠæºç è§£è¯»</h3><p>é¦–å…ˆï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹Promiseçš„ç®€å•ä½¿ç”¨ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// Do an async task async task and then...</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="comment">/* good condition */</span>) &#123;</span><br><span class="line">        resolve(<span class="string">&#x27;Success!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        reject(<span class="string">&#x27;Failure!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">p.then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">    <span class="comment">/* do something with the result */</span></span><br><span class="line">&#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">/* error :( */</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬é€šè¿‡è¿™ç§ä½¿ç”¨æ„å»ºPromiseå®ç°çš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬</p>
<p><strong>è‡ªå·±çš„å†™æ³•ä¹Ÿæ˜¯ç»“åˆè°ƒç”¨å®ä¾‹çš„é€†æ¨è¿‡ç¨‹</strong>ã€‚</p>
<p>ä¸ºä»€ä¹ˆè¦å°†callbackå•ç‹¬ä¼ å…¥å‘¢ï¼Ÿå› ä¸ºå•Šï¼Œnew Promise(â€¦ ) è¿™æ‹¬å·é‡Œçš„å‡½æ•°é€»è¾‘æ˜¯ç”±æˆ‘ä»¬ç¼–å†™çš„ï¼Œå¯è°ƒæ•´å¯ä¿®æ”¹ï¼Œåœ¨ä»»ä½•æ¡ä»¶ä¸‹çš„resolveå’Œrejectï¼Œæ‰€ä»¥å°è£…çš„æ—¶å€™æœ€å¥½å†™æˆä¸€ä¸ªé€šç”¨çš„å›è°ƒå‡½æ•°ã€‚</p>
<h4 id="Promiseæ„å»ºç‰ˆæœ¬ä¸€"><a href="#Promiseæ„å»ºç‰ˆæœ¬ä¸€" class="headerlink" title="Promiseæ„å»ºç‰ˆæœ¬ä¸€"></a>Promiseæ„å»ºç‰ˆæœ¬ä¸€</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MyPromise</span>(<span class="params">callback</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> _this = <span class="built_in">this</span></span><br><span class="line">    _this.value = <span class="keyword">void</span> <span class="number">0</span> <span class="comment">// Promiseçš„å€¼</span></span><br><span class="line">    <span class="keyword">var</span> onResolvedCallback  <span class="comment">// Promise resolveå›è°ƒå‡½æ•°</span></span><br><span class="line">    <span class="keyword">var</span> onRejectedCallback  <span class="comment">// Promise rejectå›è°ƒå‡½æ•°</span></span><br><span class="line">    <span class="comment">// resolve å¤„ç†å‡½æ•°</span></span><br><span class="line">    _this.resolve = <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">        onResolvedCallback()</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="comment">// reject å¤„ç†å‡½æ•°</span></span><br><span class="line">    _this.reject = <span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</span><br><span class="line">        onRejectedCallback()</span><br><span class="line">    &#125; </span><br><span class="line">    callback(_this.resolve, _this.reject) <span class="comment">// æ‰§è¡Œcallbackå¹¶ä¼ å…¥ç›¸åº”çš„å‚æ•°</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ·»åŠ  then æ–¹æ³• å› ä¸ºæ˜¯promiseçš„å®ä¾‹éœ€è¦ç”¨åˆ°ï¼Œæ‰€ä»¥thenæœ€å¥½æŒ‚è½½åœ¨promiseçš„åŸå‹ä¸Š</span></span><br><span class="line">MyPromise.prototype.then = <span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;&#125;</span><br></pre></td></tr></table></figure>

<p>å¤§è‡´æ¡†æ¶å·²ç»å‡ºæ¥äº†ï¼Œä½†æˆ‘ä»¬çœ‹åˆ°PromiseçŠ¶æ€ã€resloveå‡½æ•°ã€rejectå‡½æ•°ä»¥åŠthenç­‰éƒ½æ²¡æœ‰å¤„ç†ã€‚</p>
<h4 id="Promiseæ„å»ºä¹‹äºŒï¼šé“¾å¼å­˜å‚¨"><a href="#Promiseæ„å»ºä¹‹äºŒï¼šé“¾å¼å­˜å‚¨" class="headerlink" title="Promiseæ„å»ºä¹‹äºŒï¼šé“¾å¼å­˜å‚¨"></a>Promiseæ„å»ºä¹‹äºŒï¼šé“¾å¼å­˜å‚¨</h4><p>é“¾å¼å­˜å‚¨ï¼šè®²çš„å°±æ˜¯promiseå®ä¾‹ä¼šæœ‰å¾ˆå¤šæ¬¡thenï¼Œç„¶åä¸‹ä¸€æ¬¡çš„thenéƒ½ä¼šè·å¾—ä¸Šä¸€æ¬¡çš„thençš„ç»“æœï¼Œå°±åƒé“¾å¼ä¸€èˆ¬ã€‚å°†ç»“æœå­˜å‚¨ä¸‹å»ï¼Œç›´è‡³returnã€‚</p>
<p>é¦–å…ˆï¼Œä¸¾ä¸ªä¾‹å­ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> a=<span class="number">1</span>;</span><br><span class="line">        resolve(a);</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(res);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> b=<span class="number">2</span>;</span><br><span class="line">            resolve(b);</span><br><span class="line">        &#125;, <span class="number">1000</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(res);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> c=<span class="number">3</span></span><br><span class="line">            resolve(c);</span><br><span class="line">        &#125;, <span class="number">1000</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(res);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>ä¸Šä¾‹ç»“æœæ˜¯æ¯é—´éš”1sæ‰“å°ä¸€ä¸ªæ•°å­—ï¼Œé¡ºåºä¸º1ã€2ã€3ã€‚</p>
<p>è¿™é‡Œä¿è¯äº†ï¼š</p>
<ul>
<li>è®©a,b,cçš„å€¼èƒ½åœ¨thené‡Œé¢çš„å›è°ƒæ¥æ”¶åˆ°</li>
<li>åœ¨è¿ç»­è°ƒç”¨å¼‚æ­¥ï¼Œå¦‚ä½•ç¡®ä¿å¼‚æ­¥å‡½æ•°çš„æ‰§è¡Œé¡ºåº</li>
</ul>
<p>Promiseä¸€ä¸ªå¸¸è§çš„éœ€æ±‚å°±æ˜¯è¿ç»­æ‰§è¡Œä¸¤ä¸ªæˆ–è€…å¤šä¸ªå¼‚æ­¥æ“ä½œï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œæ¯ä¸€ä¸ªåæ¥çš„æ“ä½œéƒ½åœ¨å‰é¢çš„æ“ä½œæ‰§è¡ŒæˆåŠŸä¹‹åï¼Œå¸¦ç€ä¸Šä¸€æ­¥æ“ä½œæ‰€è¿”å›çš„ç»“æœå¼€å§‹æ‰§è¡Œã€‚è¿™é‡Œç”¨<code>setTimeout</code>æ¥å¤„ç†</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MyPromise</span>(<span class="params">callback</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> _this = <span class="built_in">this</span></span><br><span class="line">    _this.value = <span class="keyword">void</span> <span class="number">0</span> <span class="comment">// Promiseçš„å€¼</span></span><br><span class="line">    <span class="comment">// ç”¨äºä¿å­˜ then çš„å›è°ƒï¼Œ åªæœ‰å½“ promise</span></span><br><span class="line">    <span class="comment">// çŠ¶æ€ä¸º pending æ—¶æ‰ä¼šç¼“å­˜ï¼Œå¹¶ä¸”æ¯ä¸ªå®ä¾‹è‡³å¤šç¼“å­˜ä¸€ä¸ª</span></span><br><span class="line">    _this.onResolvedCallbacks = [] <span class="comment">// Promise resolveæ—¶çš„å›è°ƒå‡½æ•°é›†</span></span><br><span class="line">    _this.onRejectedCallbacks = [] <span class="comment">// Promise rejectæ—¶çš„å›è°ƒå‡½æ•°é›†</span></span><br><span class="line">    _this.resolve = <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// å¼‚æ­¥æ‰§è¡Œ</span></span><br><span class="line">            _this.onResolvedCallbacks.forEach(cb =cb())</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125; <span class="comment">// resolve å¤„ç†å‡½æ•°</span></span><br><span class="line">    _this.reject = <span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// å¼‚æ­¥æ‰§è¡Œ</span></span><br><span class="line">            _this.onRejectedCallbacks.forEach(cb =cb())</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125; <span class="comment">// reject å¤„ç†å‡½æ•°</span></span><br><span class="line">    callback(_this.resolve, _this.reject) <span class="comment">// æ‰§è¡Œcallbackå¹¶ä¼ å…¥ç›¸åº”çš„å‚æ•°</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ·»åŠ  then æ–¹æ³•</span></span><br><span class="line">MyPromise.prototype.then = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Promiseæ„å»ºä¹‹ä¸‰ï¼šçŠ¶æ€æœºåˆ¶ã€é¡ºåºæ‰§è¡Œ"><a href="#Promiseæ„å»ºä¹‹ä¸‰ï¼šçŠ¶æ€æœºåˆ¶ã€é¡ºåºæ‰§è¡Œ" class="headerlink" title="Promiseæ„å»ºä¹‹ä¸‰ï¼šçŠ¶æ€æœºåˆ¶ã€é¡ºåºæ‰§è¡Œ"></a>Promiseæ„å»ºä¹‹ä¸‰ï¼šçŠ¶æ€æœºåˆ¶ã€é¡ºåºæ‰§è¡Œ</h4><p>ä¸ºäº†ä¿è¯Promiseçš„å¼‚æ­¥æ“ä½œæ—¶çš„é¡ºåºæ‰§è¡Œï¼Œè¿™é‡Œç»™PromiseåŠ ä¸ŠçŠ¶æ€æœºåˆ¶</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä¸‰ç§çŠ¶æ€</span></span><br><span class="line"><span class="keyword">const</span> PENDING = <span class="string">&quot;pending&quot;</span></span><br><span class="line"><span class="keyword">const</span> RESOLVED = <span class="string">&quot;resolved&quot;</span></span><br><span class="line"><span class="keyword">const</span> REJECTED = <span class="string">&quot;rejected&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MyPromise</span>(<span class="params">callback</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> _this = <span class="built_in">this</span></span><br><span class="line">    _this.currentState = PENDING <span class="comment">// Promiseå½“å‰çš„çŠ¶æ€</span></span><br><span class="line">    _this.value = <span class="keyword">void</span> <span class="number">0</span> <span class="comment">// Promiseçš„å€¼</span></span><br><span class="line">    <span class="comment">// ç”¨äºä¿å­˜ then çš„å›è°ƒï¼Œ åªæœ‰å½“ promise</span></span><br><span class="line">    <span class="comment">// çŠ¶æ€ä¸º pending æ—¶æ‰ä¼šç¼“å­˜ï¼Œå¹¶ä¸”æ¯ä¸ªå®ä¾‹è‡³å¤šç¼“å­˜ä¸€ä¸ª</span></span><br><span class="line">    _this.onResolvedCallbacks = [] <span class="comment">// Promise resolveæ—¶çš„å›è°ƒå‡½æ•°é›†</span></span><br><span class="line">    _this.onRejectedCallbacks = [] <span class="comment">// Promise rejectæ—¶çš„å›è°ƒå‡½æ•°é›†</span></span><br><span class="line">    _this.resolve = <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// å¼‚æ­¥æ‰§è¡Œï¼Œä¿è¯é¡ºåºæ‰§è¡Œ</span></span><br><span class="line">            <span class="keyword">if</span> (_this.currentState === PENDING) &#123;</span><br><span class="line">                _this.currentState = RESOLVED <span class="comment">// çŠ¶æ€ç®¡ç†</span></span><br><span class="line">                _this.value = value</span><br><span class="line">                _this.onResolvedCallbacks.forEach(<span class="function"><span class="params">cb</span> =&gt;</span> cb())</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125; <span class="comment">// resolve å¤„ç†å‡½æ•°</span></span><br><span class="line">    _this.reject = <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// å¼‚æ­¥æ‰§è¡Œï¼Œä¿è¯é¡ºåºæ‰§è¡Œ</span></span><br><span class="line">            <span class="keyword">if</span> (_this.currentState === PENDING) &#123;</span><br><span class="line">            	_this.currentState = REJECTED <span class="comment">// çŠ¶æ€ç®¡ç†</span></span><br><span class="line">            	_this.value = value</span><br><span class="line">            	_this.onRejectedCallbacks.forEach(<span class="function"><span class="params">cb</span> =&gt;</span> cb())</span><br><span class="line">        	&#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125; <span class="comment">// reject å¤„ç†å‡½æ•°</span></span><br><span class="line">    callback(_this.resolve, _this.reject) <span class="comment">// æ‰§è¡Œcallbackå¹¶ä¼ å…¥ç›¸åº”çš„å‚æ•°</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ·»åŠ  then æ–¹æ³•</span></span><br><span class="line">MyPromise.prototype.then = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Promiseæ„å»ºä¹‹å››ï¼šé€’å½’æ‰§è¡Œ"><a href="#Promiseæ„å»ºä¹‹å››ï¼šé€’å½’æ‰§è¡Œ" class="headerlink" title="Promiseæ„å»ºä¹‹å››ï¼šé€’å½’æ‰§è¡Œ"></a>Promiseæ„å»ºä¹‹å››ï¼šé€’å½’æ‰§è¡Œ</h4><p>æ¯ä¸ªPromiseåé¢é“¾æ¥ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«onresolved,onrejected,å­promiseä¸‰ä¸ªå±æ€§.</p>
<p>å½“çˆ¶Promise çŠ¶æ€æ”¹å˜å®Œæ¯•,æ‰§è¡Œå®Œç›¸åº”çš„onresolved/onrejectedçš„æ—¶å€™ï¼Œæ‹¿åˆ°å­promise,åœ¨ç­‰å¾…è¿™ä¸ªå­promiseçŠ¶æ€æ”¹å˜ï¼Œåœ¨æ‰§è¡Œç›¸åº”çš„onresolved/onrejectedã€‚ä¾æ¬¡å¾ªç¯ç›´åˆ°å½“å‰promiseæ²¡æœ‰å­promiseã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä¸‰ç§çŠ¶æ€</span></span><br><span class="line"><span class="keyword">const</span> PENDING = <span class="string">&quot;pending&quot;</span></span><br><span class="line"><span class="keyword">const</span> RESOLVED = <span class="string">&quot;resolved&quot;</span></span><br><span class="line"><span class="keyword">const</span> REJECTED = <span class="string">&quot;rejected&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MyPromise</span>(<span class="params">callback</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> _this = <span class="built_in">this</span></span><br><span class="line">    _this.currentState = PENDING <span class="comment">// Promiseå½“å‰çš„çŠ¶æ€</span></span><br><span class="line">    _this.value = <span class="keyword">void</span> <span class="number">0</span> <span class="comment">// Promiseçš„å€¼</span></span><br><span class="line">    <span class="comment">// ç”¨äºä¿å­˜ then çš„å›è°ƒï¼Œ åªæœ‰å½“ promise</span></span><br><span class="line">    <span class="comment">// çŠ¶æ€ä¸º pending æ—¶æ‰ä¼šç¼“å­˜ï¼Œå¹¶ä¸”æ¯ä¸ªå®ä¾‹è‡³å¤šç¼“å­˜ä¸€ä¸ª</span></span><br><span class="line">    _this.onResolvedCallbacks = [] <span class="comment">// Promise resolveæ—¶çš„å›è°ƒå‡½æ•°é›†</span></span><br><span class="line">    _this.onRejectedCallbacks = [] <span class="comment">// Promise rejectæ—¶çš„å›è°ƒå‡½æ•°é›†</span></span><br><span class="line">    _this.resolve = <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (value <span class="keyword">instanceof</span> MyPromise) &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœ value æ˜¯ä¸ª MyPromiseï¼Œ é€’å½’æ‰§è¡Œ</span></span><br><span class="line">            <span class="keyword">return</span> value.then(_this.resolve, _this.reject)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// å¼‚æ­¥æ‰§è¡Œï¼Œä¿è¯é¡ºåºæ‰§è¡Œ</span></span><br><span class="line">            <span class="keyword">if</span> (_this.currentState === PENDING) &#123;</span><br><span class="line">                _this.currentState = RESOLVED <span class="comment">// çŠ¶æ€ç®¡ç†</span></span><br><span class="line">                _this.value = value</span><br><span class="line">                _this.onResolvedCallbacks.forEach(<span class="function"><span class="params">cb</span> =&gt;</span> cb())</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125; <span class="comment">// resolve å¤„ç†å‡½æ•°</span></span><br><span class="line">    _this.reject = <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// å¼‚æ­¥æ‰§è¡Œï¼Œä¿è¯é¡ºåºæ‰§è¡Œ</span></span><br><span class="line">            <span class="keyword">if</span> (_this.currentState === PENDING) &#123;</span><br><span class="line">            	_this.currentState = REJECTED <span class="comment">// çŠ¶æ€ç®¡ç†</span></span><br><span class="line">            	_this.value = value</span><br><span class="line">            	_this.onRejectedCallbacks.forEach(<span class="function"><span class="params">cb</span> =&gt;</span> cb())</span><br><span class="line">        	&#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125; <span class="comment">// reject å¤„ç†å‡½æ•°</span></span><br><span class="line">    callback(_this.resolve, _this.reject) <span class="comment">// æ‰§è¡Œcallbackå¹¶ä¼ å…¥ç›¸åº”çš„å‚æ•°</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ·»åŠ  then æ–¹æ³•</span></span><br><span class="line">MyPromise.prototype.then = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Promiseæ„å»ºä¹‹äº”ï¼šå¼‚å¸¸å¤„ç†"><a href="#Promiseæ„å»ºä¹‹äº”ï¼šå¼‚å¸¸å¤„ç†" class="headerlink" title="Promiseæ„å»ºä¹‹äº”ï¼šå¼‚å¸¸å¤„ç†"></a>Promiseæ„å»ºä¹‹äº”ï¼šå¼‚å¸¸å¤„ç†</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä¸‰ç§çŠ¶æ€</span></span><br><span class="line"><span class="keyword">const</span> PENDING = <span class="string">&quot;pending&quot;</span></span><br><span class="line"><span class="keyword">const</span> RESOLVED = <span class="string">&quot;resolved&quot;</span></span><br><span class="line"><span class="keyword">const</span> REJECTED = <span class="string">&quot;rejected&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MyPromise</span>(<span class="params">callback</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> _this = <span class="built_in">this</span></span><br><span class="line">    _this.currentState = PENDING <span class="comment">// Promiseå½“å‰çš„çŠ¶æ€</span></span><br><span class="line">    _this.value = <span class="keyword">void</span> <span class="number">0</span> <span class="comment">// Promiseçš„å€¼</span></span><br><span class="line">    <span class="comment">// ç”¨äºä¿å­˜ then çš„å›è°ƒï¼Œ åªæœ‰å½“ promise</span></span><br><span class="line">    <span class="comment">// çŠ¶æ€ä¸º pending æ—¶æ‰ä¼šç¼“å­˜ï¼Œå¹¶ä¸”æ¯ä¸ªå®ä¾‹è‡³å¤šç¼“å­˜ä¸€ä¸ª</span></span><br><span class="line">    _this.onResolvedCallbacks = [] <span class="comment">// Promise resolveæ—¶çš„å›è°ƒå‡½æ•°é›†</span></span><br><span class="line">    _this.onRejectedCallbacks = [] <span class="comment">// Promise rejectæ—¶çš„å›è°ƒå‡½æ•°é›†</span></span><br><span class="line">    _this.resolve = <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (value <span class="keyword">instanceof</span> MyPromise) &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœ value æ˜¯ä¸ª MyPromiseï¼Œ é€’å½’æ‰§è¡Œ</span></span><br><span class="line">            <span class="keyword">return</span> value.then(_this.resolve, _this.reject)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// å¼‚æ­¥æ‰§è¡Œï¼Œä¿è¯é¡ºåºæ‰§è¡Œ</span></span><br><span class="line">            <span class="keyword">if</span> (_this.currentState === PENDING) &#123;</span><br><span class="line">                _this.currentState = RESOLVED <span class="comment">// çŠ¶æ€ç®¡ç†</span></span><br><span class="line">                _this.value = value</span><br><span class="line">                _this.onResolvedCallbacks.forEach(<span class="function"><span class="params">cb</span> =&gt;</span> cb())</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125; <span class="comment">// resolve å¤„ç†å‡½æ•°</span></span><br><span class="line">    _this.reject = <span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// å¼‚æ­¥æ‰§è¡Œï¼Œä¿è¯é¡ºåºæ‰§è¡Œ</span></span><br><span class="line">            <span class="keyword">if</span> (_this.currentState === PENDING) &#123;</span><br><span class="line">            	_this.currentState = REJECTED <span class="comment">// çŠ¶æ€ç®¡ç†</span></span><br><span class="line">            	_this.value = value</span><br><span class="line">            	_this.onRejectedCallbacks.forEach(<span class="function"><span class="params">cb</span> =&gt;</span> cb())</span><br><span class="line">        	&#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125; <span class="comment">// reject å¤„ç†å‡½æ•°</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å¼‚å¸¸å¤„ç†</span></span><br><span class="line">    <span class="comment">// new Promise(() =throw Error(&#x27;error&#x27;))</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        callback(_this.resolve, _this.reject) <span class="comment">// æ‰§è¡Œcallbackå¹¶ä¼ å…¥ç›¸åº”çš„å‚æ•°</span></span><br><span class="line">    &#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">        _this.reject(e)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ·»åŠ  then æ–¹æ³•</span></span><br><span class="line">MyPromise.prototype.then = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Promiseæ„å»ºä¹‹å…­ï¼šthençš„å®ç°"><a href="#Promiseæ„å»ºä¹‹å…­ï¼šthençš„å®ç°" class="headerlink" title="Promiseæ„å»ºä¹‹å…­ï¼šthençš„å®ç°"></a>Promiseæ„å»ºä¹‹å…­ï¼šthençš„å®ç°</h4><p>then æ–¹æ³•æ˜¯ Promise çš„æ ¸å¿ƒï¼Œè¿™é‡Œåšä¸€ä¸‹è¯¦ç»†ä»‹ç»ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">promise.then(onFulfilled, onRejected)</span><br></pre></td></tr></table></figure>

<p>ä¸€ä¸ª Promise çš„thenæ¥å—ä¸¤ä¸ªå‚æ•°ï¼š onFulfilledå’ŒonRejectedï¼ˆéƒ½æ˜¯å¯é€‰å‚æ•°ï¼Œå¹¶ä¸”ä¸ºå‡½æ•°ï¼Œè‹¥ä¸æ˜¯å‡½æ•°å°†è¢«å¿½ç•¥ï¼‰</p>
<ul>
<li>onFulfilled ç‰¹æ€§ï¼š<ul>
<li>å½“ Promise æ‰§è¡Œç»“æŸåå…¶å¿…é¡»è¢«è°ƒç”¨ï¼Œå…¶ç¬¬ä¸€ä¸ªå‚æ•°ä¸º promise çš„ç»ˆå€¼ï¼Œä¹Ÿå°±æ˜¯ resolve ä¼ è¿‡æ¥çš„å€¼</li>
<li>åœ¨ Promise æ‰§è¡Œç»“æŸå‰ä¸å¯è¢«è°ƒç”¨</li>
<li>å…¶è°ƒç”¨æ¬¡æ•°ä¸å¯è¶…è¿‡ä¸€æ¬¡</li>
</ul>
</li>
<li>onRejected ç‰¹æ€§<ul>
<li>å½“ Promise è¢«æ‹’ç»æ‰§è¡Œåå…¶å¿…é¡»è¢«è°ƒç”¨ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸º Promise çš„æ‹’ç»åŸå› ï¼Œä¹Ÿå°±æ˜¯rejectä¼ è¿‡æ¥çš„å€¼</li>
<li>åœ¨ Promise æ‰§è¡Œç»“æŸå‰ä¸å¯è¢«è°ƒç”¨</li>
<li>å…¶è°ƒç”¨æ¬¡æ•°ä¸å¯è¶…è¿‡ä¸€æ¬¡</li>
</ul>
</li>
<li>è°ƒç”¨æ—¶æœº<br><code>onFulfilled</code> å’Œ <code>onRejected</code> åªæœ‰åœ¨<a href="http://es5.github.io/#x10.3">æ‰§è¡Œç¯å¢ƒ</a>å †æ ˆä»…åŒ…å«<strong>å¹³å°ä»£ç </strong>æ—¶æ‰å¯è¢«è°ƒç”¨ï¼ˆå¹³å°ä»£ç æŒ‡å¼•æ“ã€ç¯å¢ƒä»¥åŠ promise çš„å®æ–½ä»£ç ï¼‰</li>
<li>è°ƒç”¨è¦æ±‚<br><code>onFulfilled</code> å’Œ <code>onRejected</code> å¿…é¡»è¢«ä½œä¸ºå‡½æ•°è°ƒç”¨ï¼ˆå³æ²¡æœ‰ <code>this</code> å€¼ï¼Œåœ¨ <strong>ä¸¥æ ¼æ¨¡å¼ï¼ˆstrictï¼‰</strong> ä¸­ï¼Œå‡½æ•° <code>this</code> çš„å€¼ä¸º <code>undefined</code> ï¼›åœ¨éä¸¥æ ¼æ¨¡å¼ä¸­å…¶ä¸ºå…¨å±€å¯¹è±¡ã€‚ï¼‰</li>
<li>å¤šæ¬¡è°ƒç”¨<br><code>then</code> æ–¹æ³•å¯ä»¥è¢«åŒä¸€ä¸ª <code>promise</code> è°ƒç”¨å¤šæ¬¡<ul>
<li>å½“ <code>promise</code> æˆåŠŸæ‰§è¡Œæ—¶ï¼Œæ‰€æœ‰ <code>onFulfilled</code> éœ€æŒ‰ç…§å…¶æ³¨å†Œé¡ºåºä¾æ¬¡å›è°ƒ</li>
<li>å½“ <code>promise</code> è¢«æ‹’ç»æ‰§è¡Œæ—¶ï¼Œæ‰€æœ‰çš„ <code>onRejected</code> éœ€æŒ‰ç…§å…¶æ³¨å†Œé¡ºåºä¾æ¬¡å›è°ƒ</li>
</ul>
</li>
<li>è¿”å›<br><code>then</code>æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ª<code>Promise</code>ï¼Œå…³äºè¿™ä¸€ç‚¹ï¼ŒPromise/A+æ ‡å‡†å¹¶æ²¡æœ‰è¦æ±‚è¿”å›çš„è¿™ä¸ªPromiseæ˜¯ä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œä½†åœ¨Promise/Aæ ‡å‡†ä¸­ï¼Œæ˜ç¡®è§„å®šäº†thenè¦è¿”å›ä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œç›®å‰çš„Promiseå®ç°ä¸­thenå‡ ä¹éƒ½æ˜¯è¿”å›ä¸€ä¸ªæ–°çš„Promise(<a href="https://promisesaplus.com/differences-from-promises-a#point-5">è¯¦æƒ…</a>)å¯¹è±¡ï¼Œæ‰€ä»¥åœ¨æˆ‘ä»¬çš„å®ç°ä¸­ï¼Œä¹Ÿè®©thenè¿”å›ä¸€ä¸ªæ–°çš„Promiseå¯¹è±¡ã€‚<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">promise2 = promise1.then(onFulfilled, onRejected);</span><br></pre></td></tr></table></figure>



<ul>
<li>å¦‚æœ <code>onFulfilled</code> æˆ–è€… <code>onRejected</code> è¿”å›ä¸€ä¸ªå€¼ <code>x</code> ï¼Œåˆ™è¿è¡Œä¸‹é¢çš„ <strong>Promise è§£å†³è¿‡ç¨‹</strong>ï¼š<code>[[Resolve]](promise2, x)</code></li>
<li>å¦‚æœ <code>onFulfilled</code> æˆ–è€… <code>onRejected</code> æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ <code>e</code> ï¼Œåˆ™ <code>promise2</code> å¿…é¡»æ‹’ç»æ‰§è¡Œï¼Œå¹¶è¿”å›æ‹’å›  <code>e</code></li>
<li>å¦‚æœ <code>onFulfilled</code> ä¸æ˜¯å‡½æ•°ä¸” <code>promise1</code> æˆåŠŸæ‰§è¡Œï¼Œ <code>promise2</code> å¿…é¡»æˆåŠŸæ‰§è¡Œå¹¶è¿”å›ç›¸åŒçš„å€¼</li>
<li>å¦‚æœ <code>onRejected</code> ä¸æ˜¯å‡½æ•°ä¸” <code>promise1</code> æ‹’ç»æ‰§è¡Œï¼Œ <code>promise2</code> å¿…é¡»æ‹’ç»æ‰§è¡Œå¹¶è¿”å›ç›¸åŒçš„æ‹’å› </li>
</ul>
<strong>ä¸è®º promise1 è¢« reject è¿˜æ˜¯è¢« resolve ï¼Œ promise2 éƒ½ä¼šè¢« resolveï¼Œåªæœ‰å‡ºç°å¼‚å¸¸æ—¶æ‰ä¼šè¢« rejected</strong>ã€‚<br>æ¯ä¸ªPromiseå¯¹è±¡éƒ½å¯ä»¥åœ¨å…¶ä¸Šå¤šæ¬¡è°ƒç”¨thenæ–¹æ³•ï¼Œè€Œæ¯æ¬¡è°ƒç”¨thenè¿”å›çš„Promiseçš„çŠ¶æ€å–å†³äºé‚£ä¸€æ¬¡è°ƒç”¨thenæ—¶ä¼ å…¥å‚æ•°çš„è¿”å›å€¼ï¼Œæ‰€ä»¥thenä¸èƒ½è¿”å›thisï¼Œå› ä¸ºthenæ¯æ¬¡è¿”å›çš„Promiseçš„ç»“æœéƒ½æœ‰å¯èƒ½ä¸åŒã€‚</li>
</ul>
<p>ä¸‹é¢ä»£ç å®ç°ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// then æ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ï¼ŒonFulfilledï¼ŒonRejectedï¼Œåˆ†åˆ«ä¸ºPromiseæˆåŠŸæˆ–å¤±è´¥çš„å›è°ƒ</span></span><br><span class="line">MyPromise.prototype.then = <span class="function"><span class="keyword">function</span>(<span class="params">onFulfilled, onRejected</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> _this = <span class="built_in">this</span></span><br><span class="line">    <span class="comment">// è§„èŒƒ 2.2.7ï¼Œthen å¿…é¡»è¿”å›ä¸€ä¸ªæ–°çš„ promise</span></span><br><span class="line">    <span class="keyword">var</span> promise2</span><br><span class="line">    <span class="comment">// æ ¹æ®è§„èŒƒ 2.2.1 ï¼ŒonFulfilledã€onRejected éƒ½æ˜¯å¯é€‰å‚æ•°</span></span><br><span class="line">    <span class="comment">// onFulfilledã€onRejectedä¸æ˜¯å‡½æ•°éœ€è¦å¿½ç•¥ï¼ŒåŒæ—¶ä¹Ÿå®ç°äº†å€¼ç©¿é€</span></span><br><span class="line">    onFulfilled = <span class="keyword">typeof</span> onFulfilled === <span class="string">&#x27;function&#x27;</span> ? onFulfilled : value =value</span><br><span class="line">    onRejected = <span class="keyword">typeof</span> onRejected === <span class="string">&#x27;function&#x27;</span> ? onRejected : error =&#123;<span class="keyword">throw</span> error&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (_this.currentState === RESOLVED) &#123;</span><br><span class="line">        <span class="keyword">return</span> promise2 = <span class="keyword">new</span> MyPromise(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">            </span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (_this.currentState === REJECTED) &#123;</span><br><span class="line">        <span class="keyword">return</span> promise2 = <span class="keyword">new</span> MyPromise(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">            </span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (_this.currentState === PENDING) &#123;</span><br><span class="line">        <span class="keyword">return</span> promise2 = <span class="keyword">new</span> MyPromise(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">            </span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>é™„ï¼šå€¼ç©¿é€è§£è¯»</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">MyPromise.prototype.then = <span class="function"><span class="keyword">function</span> (<span class="params">onFulfilled, onRejected</span>) </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    onFulfilled = <span class="keyword">typeof</span> onFulfilled === <span class="string">&#x27;function&#x27;</span> ? onFulfilled : value =value</span><br><span class="line">    onRejected = <span class="keyword">typeof</span> onRejected === <span class="string">&#x27;function&#x27;</span> ? onRejected : error =&#123;<span class="keyword">throw</span> error&#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢æåˆ°å€¼ç©¿é€ï¼Œå€¼ç©¿é€å³ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> promise = <span class="keyword">new</span> MyPromise((resolve, reject) =&#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(() =&#123;</span><br><span class="line">        resolve(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    &#125;, <span class="number">1000</span>)</span><br><span class="line">&#125;)</span><br><span class="line">promise.then(<span class="string">&#x27;2&#x27;</span>).then(<span class="built_in">console</span>.log)</span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆæ‰“ç»“æœæ˜¯<code>1</code>è€Œä¸æ˜¯<code>2</code></p>
<p>å†ä¾‹å¦‚ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> MyPromise(resolve =resolve(<span class="string">&#x27;1&#x27;</span>))</span><br><span class="line">    .then()</span><br><span class="line">    .then()</span><br><span class="line">    .then(<span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">        alert(value)</span><br><span class="line">    &#125;)</span><br><span class="line"><span class="comment">// output: alert å‡º 1</span></span><br></pre></td></tr></table></figure>

<p>é€šè¿‡ <code>return this</code> åªå®ç°äº†å€¼ç©¿é€çš„ä¸€ç§æƒ…å†µï¼Œå…¶å®å€¼ç©¿é€æœ‰ä¸¤ç§æƒ…å†µï¼š</p>
<ol>
<li>promise å·²ç»æ˜¯ RESOLVED/REJECTED æ—¶ï¼Œé€šè¿‡ return this å®ç°çš„å€¼ç©¿é€ï¼š<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(() =&#123;</span><br><span class="line">        resolve(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    &#125;, <span class="number">1000</span>)</span><br><span class="line">&#125;)</span><br><span class="line">promise.then(() =&#123;</span><br><span class="line">    promise.then().then((res) =&#123; <span class="comment">// çŠ¶å†µA</span></span><br><span class="line">        <span class="built_in">console</span>.log(res) <span class="comment">// output: 1</span></span><br><span class="line">    &#125;)</span><br><span class="line">    promise.catch().then((res) =&#123; <span class="comment">// çŠ¶å†µB</span></span><br><span class="line">        <span class="built_in">console</span>.log(res) <span class="comment">// output: 1</span></span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="built_in">console</span>.log(promise.then() === promise.catch()) <span class="comment">// output: true</span></span><br><span class="line">    <span class="built_in">console</span>.log(promise.then(<span class="number">1</span>) === promise.catch(&#123;<span class="attr">name</span>: <span class="string">&#x27;anran&#x27;</span>&#125;)) <span class="comment">// output: true</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>


çŠ¶å†µAä¸Bå¤„ promise å·²ç»æ˜¯ RESOLVED äº†ç¬¦åˆæ¡ä»¶ï¼Œæ‰€ä»¥æ‰§è¡Œäº† <code>return this</code>ã€‚<br>æ³¨æ„ï¼šåŸç”Ÿçš„Promiseå®ç°é‡Œå¹¶ä¸æ˜¯è¿™æ ·å®ç°çš„ï¼Œä¼šæ‰“å°å‡ºä¸¤ä¸ªfalse</li>
<li>promise æ˜¯ PENDINGæ—¶ï¼Œé€šè¿‡ç”Ÿæˆæ–°çš„ promise åŠ å…¥åˆ°çˆ¶ promise çš„ queueï¼Œçˆ¶ promise æœ‰å€¼æ—¶è°ƒç”¨ callFulfilled-&gt;doResolve æˆ– callRejected-&gt;doRejectï¼ˆå› ä¸º then/catch ä¼ å…¥çš„å‚æ•°ä¸æ˜¯å‡½æ•°ï¼‰è®¾ç½®å­ promise çš„çŠ¶æ€å’Œå€¼ä¸ºçˆ¶ promise çš„çŠ¶æ€ä¸å€¼ã€‚å¦‚ï¼š<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>((resolve) =&#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(() =&#123;</span><br><span class="line">        resolve(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    &#125;, <span class="number">1000</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">var</span> a = promise.then()</span><br><span class="line">a.then((res) =&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(res) <span class="comment">// output: 1</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">var</span> b = promise.catch()</span><br><span class="line">b.then((res) =&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(res) <span class="comment">// output: 1</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(a === b) <span class="comment">// output: false</span></span><br></pre></td></tr></table></figure></li>
</ol>
<p>Promise æœ‰ä¸‰ç§çŠ¶æ€ï¼Œæˆ‘ä»¬åˆ†3ä¸ªifå—æ¥å¤„ç†ï¼Œæ¯å—éƒ½è¿”å›ä¸€ä¸ªnew Promiseã€‚</p>
<p>æ ¹æ®æ ‡å‡†ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œå¯¹äºä¸€ä¸‹ä»£ç ï¼Œpromise2çš„å€¼å–å†³äºthené‡Œé¢çš„è¿”å›å€¼ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">promise2 = promise1.then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&#x27;error&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>å¦‚æœpromise1è¢«resolveäº†ï¼Œpromise2çš„è¢«<code>1</code>resolveï¼Œå¦‚æœpromise1 è¢«rejectäº†ï¼Œpromise2å°†è¢«<code>new Error(&#39;error&#39;)</code>rejectã€‚</p>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦åœ¨thené‡Œé¢æ‰§è¡ŒonFulfilledæˆ–è€…onRejectedï¼Œå¹¶æ ¹æ®è¿”å›ç€ï¼ˆæ ‡è®°ä¸­è®°ä¸º<code>x</code>ï¼‰æ¥ç¡®å®špromise2çš„ç»“æœï¼Œå¹¶ä¸”ï¼Œå¦‚æœonFulfilled/onRejectedè¿”å›çš„æ˜¯ä¸€ä¸ªPromiseï¼Œpromiseå°†ç›´æ¥å–è¿™ä¸ªPromiseçš„ç»“æœã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// then æ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ï¼ŒonFulfilledï¼ŒonRejectedï¼Œåˆ†åˆ«ä¸ºPromiseæˆåŠŸæˆ–å¤±è´¥çš„å›è°ƒ</span></span><br><span class="line">MyPromise.prototype.then = <span class="function"><span class="keyword">function</span>(<span class="params">onFulfilled, onRejected</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> _this = <span class="built_in">this</span></span><br><span class="line">    <span class="comment">// è§„èŒƒ 2.2.7ï¼Œthen å¿…é¡»è¿”å›ä¸€ä¸ªæ–°çš„ promise</span></span><br><span class="line">    <span class="keyword">var</span> promise2</span><br><span class="line">    <span class="comment">// æ ¹æ®è§„èŒƒ 2.2.1 ï¼ŒonFulfilledã€onRejected éƒ½æ˜¯å¯é€‰å‚æ•°</span></span><br><span class="line">    <span class="comment">// onFulfilledã€onRejectedä¸æ˜¯å‡½æ•°éœ€è¦å¿½ç•¥ï¼ŒåŒæ—¶ä¹Ÿå®ç°äº†å€¼ç©¿é€</span></span><br><span class="line">    onFulfilled = <span class="keyword">typeof</span> onFulfilled === <span class="string">&#x27;function&#x27;</span> ? onFulfilled : value =value</span><br><span class="line">    onRejected = <span class="keyword">typeof</span> onRejected === <span class="string">&#x27;function&#x27;</span> ? onRejected : error =&#123;<span class="keyword">throw</span> error&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (_this.currentState === RESOLVED) &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœpromise1ï¼ˆæ­¤å¤„ä¸ºself/thisï¼‰çš„çŠ¶æ€å·²ç»ç¡®å®šå¹¶ä¸”ä¸ºresolvedï¼Œæˆ‘ä»¬è°ƒç”¨onFulfilled</span></span><br><span class="line">        <span class="comment">// å¦‚æœè€ƒè™‘åˆ°æœ‰å¯èƒ½throwï¼Œæ‰€ä»¥æˆ‘ä»¬å°†å…¶åŒ…åœ¨try/catchå—ä¸­</span></span><br><span class="line">        <span class="keyword">return</span> promise2 = <span class="keyword">new</span> MyPromise(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">            <span class="comment">// è§„èŒƒ 2.2.4ï¼Œä¿è¯ onFulfilledï¼ŒonRjected å¼‚æ­¥æ‰§è¡Œ</span></span><br><span class="line">      		<span class="comment">// æ‰€ä»¥ç”¨äº† setTimeout åŒ…è£¹ä¸‹</span></span><br><span class="line">            <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                	<span class="keyword">var</span> x = onFulfilled(_this.value)</span><br><span class="line">                	<span class="comment">// å¦‚æœ onFulfilled çš„è¿”å›å€¼æ˜¯ä¸€ä¸ª Promise å¯¹è±¡ï¼Œç›´æ¥å–å®ƒçš„ç»“æœä½œä¸º promise2 çš„ç»“æœ</span></span><br><span class="line">                	<span class="keyword">if</span> (x <span class="keyword">instanceof</span> MyPromise) &#123;</span><br><span class="line">                    	x.then(resolve, reject)</span><br><span class="line">                	&#125;</span><br><span class="line">                	resolve(x) <span class="comment">// å¦åˆ™ï¼Œä»¥å®ƒçš„è¿”å›å€¼ä¸º promise2 çš„ç»“æœ</span></span><br><span class="line">            	&#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">                	reject(err) <span class="comment">// å¦‚æœå‡ºé”™ï¼Œä»¥æ•è·åˆ°çš„é”™è¯¯ä½œä¸ºpromise2çš„ç»“æœ</span></span><br><span class="line">            	&#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ­¤å¤„å®ç°ä¸FULFILLEDç›¸ä¼¼ï¼ŒåŒºåˆ«åœ¨ä½¿ç”¨çš„æ˜¯onRejectedè€Œä¸æ˜¯onFulfilled</span></span><br><span class="line">    <span class="keyword">if</span> (_this.currentState === REJECTED) &#123;</span><br><span class="line">        <span class="keyword">return</span> promise2 = <span class="keyword">new</span> MyPromise(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">            <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                	<span class="keyword">var</span> x = onRejected(_this.value)</span><br><span class="line">                	<span class="keyword">if</span> (x <span class="keyword">instanceof</span> <span class="built_in">Promise</span>)&#123;</span><br><span class="line">                    	x.then(resolve, reject)</span><br><span class="line">                	&#125;</span><br><span class="line">            	&#125; <span class="keyword">catch</span>(err) &#123;</span><br><span class="line">                	reject(err)</span><br><span class="line">            	&#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (_this.currentState === PENDING) &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœå½“å‰çš„Promiseè¿˜å¤„äºPENDINGçŠ¶æ€ï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½ç¡®å®šè°ƒç”¨onFulfilledè¿˜æ˜¯onRejected</span></span><br><span class="line">        <span class="comment">// åªæœ‰ç­‰å¾…Promiseçš„çŠ¶æ€ç¡®å®šåï¼Œå†åšå¤„ç†</span></span><br><span class="line">        <span class="comment">// æ‰€ä»¥æˆ‘ä»¬éœ€è¦æŠŠæˆ‘ä»¬çš„ä¸¤ç§æƒ…å†µçš„å¤„ç†é€»è¾‘åšæˆcallbackæ”¾å…¥promise1ï¼ˆæ­¤å¤„å³self/thisï¼‰çš„å›è°ƒæ•°ç»„å†…</span></span><br><span class="line">        <span class="comment">// å¤„ç†é€»è¾‘å’Œä»¥ä¸Šç›¸ä¼¼</span></span><br><span class="line">        <span class="keyword">return</span> promise2 = <span class="keyword">new</span> MyPromise(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">            _this.onResolvedCallbacks.push(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">var</span> x = onFulfilled(_this.value)</span><br><span class="line">                    <span class="keyword">if</span> (x <span class="keyword">instanceof</span> MyPromise) &#123;</span><br><span class="line">                        x.then(resolve, reject)</span><br><span class="line">                    &#125;</span><br><span class="line">                    resolve(x)</span><br><span class="line">                &#125; <span class="keyword">catch</span>(err) &#123;</span><br><span class="line">                    reject(err)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">            _this.onRejectedCallbacks.push(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">var</span> x = onRejected(_this.value)</span><br><span class="line">                    <span class="keyword">if</span> (x <span class="keyword">instanceof</span> MyPromise) &#123;</span><br><span class="line">                        x.then(resolve, reject)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">                    reject(err)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Promiseæ„å»ºä¹‹ä¸ƒï¼šcatchçš„å®ç°"><a href="#Promiseæ„å»ºä¹‹ä¸ƒï¼šcatchçš„å®ç°" class="headerlink" title="Promiseæ„å»ºä¹‹ä¸ƒï¼šcatchçš„å®ç°"></a>Promiseæ„å»ºä¹‹ä¸ƒï¼šcatchçš„å®ç°</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// catch çš„å®ç°</span></span><br><span class="line">MyPromise.prototype.catch = <span class="function"><span class="keyword">function</span> (<span class="params">onRejected</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.then(<span class="literal">null</span>, onRejected)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å¤§è‡´å®ç°äº†Promiseæ ‡å‡†ä¸­æ‰€æ¶‰åŠåˆ°çš„å†…å®¹ã€‚</p>
<h4 id="Promiseæ„å»ºä¹‹å…«ï¼šé—®é¢˜è¡¥å……ï¼šæ— ç¼è°ƒç”¨"><a href="#Promiseæ„å»ºä¹‹å…«ï¼šé—®é¢˜è¡¥å……ï¼šæ— ç¼è°ƒç”¨" class="headerlink" title="Promiseæ„å»ºä¹‹å…«ï¼šé—®é¢˜è¡¥å……ï¼šæ— ç¼è°ƒç”¨"></a>Promiseæ„å»ºä¹‹å…«ï¼šé—®é¢˜è¡¥å……ï¼šæ— ç¼è°ƒç”¨</h4><p>ä¸åŒçš„Promiseå®ç°ä¹‹é—´éœ€è¦æ— ç¼çš„å¯äº¤äº’ï¼Œå¦‚ES6çš„Promiseï¼Œå’Œæˆ‘ä»¬è‡ªå·±å®ç°çš„Promiseä¹‹é—´ä»¥åŠå…¶ä»–çš„Promiseå®ç°ï¼Œå¿…é¡»æ˜¯æ— ç¼è°ƒç”¨çš„ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> MyPromise(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        resolve(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    &#125;, <span class="number">1000</span>)</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>.reject(<span class="string">&#x27;2&#x27;</span>) <span class="comment">// ES6 çš„ Promise</span></span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Q.all([ <span class="comment">// Q çš„ Promise</span></span><br><span class="line">        <span class="keyword">new</span> MyPromise(resolve =resolve(<span class="string">&#x27;3&#x27;</span>)) <span class="comment">// æˆ‘ä»¬å®ç°çš„Promise</span></span><br><span class="line">        <span class="keyword">new</span> <span class="built_in">Promise</span>.eresolve(<span class="string">&#x27;4&#x27;</span>) <span class="comment">// ES6 çš„ Promise</span></span><br><span class="line">        Q.resolve(<span class="string">&#x27;5&#x27;</span>) <span class="comment">// Q çš„ Promise</span></span><br><span class="line">    ])</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä¹‹å‰å®ç°çš„ä»£ç åªæ˜¯åˆ¤æ–­OnFullfilled/onRejectedçš„è¿”å›å€¼æ˜¯å¦ä¸ºæˆ‘ä»¬è‡ªå·±å®ç°çš„å®ä¾‹ï¼Œå¹¶æ²¡æœ‰å¯¹å…¶ä»–ç±»å‹Promiseçš„åˆ¤æ–­ï¼Œæ‰€ä»¥ï¼Œä¸Šé¢çš„ä»£ç æ— æ³•æ­£å¸¸è¿è¡Œã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è§£å†³è¿™ä¸ªé—®é¢˜</p>
<p>å…³äºä¸åŒPromiseä¹‹é—´çš„äº¤äº’ï¼Œå…¶å®<a href="https://promisesaplus.com/#point-46">Promise/A+æ ‡å‡†</a>ä¸­æœ‰ä»‹ç»ï¼Œå…¶ä¸­è¯¦ç»†çš„æŒ‡å®šäº†å¦‚ä½•é€šè¿‡thençš„å®å‚è¿”å›çš„å€¼æ¥å†³å®špromise2çš„çŠ¶æ€ï¼Œæˆ‘ä»¬åªéœ€è¦æŒ‰ç…§æ ‡å‡†æŠŠæ ‡å‡†çš„å†…å®¹è½¬æˆä»£ç å³å¯ã€‚</p>
<p>å³æˆ‘ä»¬è¦<strong>æŠŠonFulfilled/onRejectedçš„è¿”å›å€¼xã€‚å½“æˆæ˜¯ä¸€ä¸ªå¯èƒ½æ˜¯Promiseçš„å¯¹è±¡</strong>ï¼Œä¹Ÿå³æ ‡å‡†ä¸­çš„thenableï¼Œå¹¶ä»¥æœ€ä¿é™©çš„å§¿åŠ¿è°ƒç”¨xä¸Šçš„thenæ–¹æ³•ï¼Œå¦‚æœå¤§å®¶éƒ½æŒ‰ç…§æ ‡å‡†æ¥å®ç°ï¼Œé‚£ä¹ˆä¸åŒçš„Promiseä¹‹é—´å°±å¯ä»¥äº¤äº’äº†ã€‚</p>
<p>è€Œæ ‡å‡†ä¸ºäº†ä¿é™©èµ·è§ï¼Œå³ä½¿xè¿”å›äº†ä¸€ä¸ªå¸¦æœ‰thenå±æ€§ä½†ä¸éµå¾ªPromiseæ ‡å‡†çš„å¯¹è±¡ï¼ˆä¸å¦‚è¯´è¿™ä¸ªxæŠŠå®ƒthené‡Œçš„ä¸¤ä¸ªå‚æ•°éƒ½è°ƒç”¨äº†ï¼ŒåŒæ­¥æˆ–è€…å¼‚æ­¥è°ƒç”¨ï¼ˆPSï¼ŒåŸåˆ™ä¸Šthençš„ä¸¤ä¸ªå‚æ•°éœ€è¦å¼‚æ­¥è°ƒç”¨ï¼Œä¸‹æ–‡ä¼šè®²åˆ°ï¼‰ï¼Œæˆ–è€…æ˜¯å‡ºé”™ååˆè°ƒç”¨äº†å®ƒä»¬ï¼Œæˆ–è€…thenæ ¹æœ¬ä¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼‰ï¼Œä¹Ÿèƒ½å°½å¯èƒ½æ­£ç¡®å¤„ç†ã€‚</p>
<p>å…³äºä¸ºä½•éœ€è¦ä¸åŒçš„Promiseå®ç°èƒ½å¤Ÿç›¸äº’äº¤äº’ï¼Œæˆ‘æƒ³åŸå› åº”è¯¥æ˜¯æ˜¾ç„¶çš„ï¼ŒPromiseå¹¶ä¸æ˜¯JSä¸€æ—©å°±æœ‰çš„æ ‡å‡†ï¼Œä¸åŒç¬¬ä¸‰æ–¹çš„å®ç°ä¹‹é—´æ˜¯å¹¶ä¸ç›¸äº’çŸ¥æ™“çš„ï¼Œå¦‚æœä½ ä½¿ç”¨çš„æŸä¸€ä¸ªåº“ä¸­å°è£…äº†ä¸€ä¸ªPromiseå®ç°ï¼Œæƒ³è±¡ä¸€ä¸‹å¦‚æœå®ƒä¸èƒ½è·Ÿä½ è‡ªå·±ä½¿ç”¨çš„Promiseå®ç°äº¤äº’çš„åœºæ™¯ã€‚ã€‚ã€‚</p>
<p>ä»£ç å®ç°ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è§„èŒƒ 2.3</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">resolutionProcedureå‡½æ•°å³ä¸ºæ ¹æ®xçš„å€¼æ¥å†³å®špromise2çš„çŠ¶æ€çš„å‡½æ•°</span></span><br><span class="line"><span class="comment">ä¹Ÿå³æ ‡å‡†ä¸­çš„[Promise Resolution Procedure](https://promisesaplus.com/#point-47)</span></span><br><span class="line"><span class="comment">x ä¸º promise2 = promise1.then(onFulfilled, onRejected)é‡ŒonFulfilled/onRejectedçš„è¿”å›å€¼</span></span><br><span class="line"><span class="comment">resolve å’Œ reject å®é™…ä¸Šæ˜¯ promise2 çš„executorçš„ä¸¤ä¸ªå®å‚ï¼Œå› ä¸ºå¾ˆéš¾æŒ‚åœ¨å…¶ä»–åœ°æ–¹ï¼Œæ‰€ä»¥ä¸€å¹¶ä¼ è¿‡æ¥ã€‚</span></span><br><span class="line"><span class="comment">ç›¸ä¿¡å„ä½ä¸€å®šå¯ä»¥å¯¹ç…§æ ‡å‡†è½¬æ¢æˆä»£ç ï¼Œè¿™é‡Œå°±åªæ ‡å‡ºä»£ç åœ¨æ ‡å‡†ä¸­å¯¹åº”çš„ä½ç½®ï¼Œåªåœ¨å¿…è¦çš„åœ°æ–¹åšä¸€äº›è§£é‡Šã€‚</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">resolutionProcedure</span>(<span class="params">promise2, x, resolve, reject</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// è§„èŒƒ 2.3.1ï¼Œx ä¸èƒ½å’Œ promise2 ç›¸åŒï¼Œé¿å…å¾ªç¯å¼•ç”¨</span></span><br><span class="line">    <span class="keyword">if</span> (promise2 === x) &#123;</span><br><span class="line">        <span class="keyword">return</span> reject(<span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">&quot;Chaining cycle detected for promise!&quot;</span>))</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è§„èŒƒ 2.3.2</span></span><br><span class="line">    <span class="comment">// å¦‚æœ x ä¸º Promiseï¼ŒçŠ¶æ€ä¸º pending éœ€è¦ç»§ç»­ç­‰å¾…å¦åˆ™æ‰§è¡Œ</span></span><br><span class="line">    <span class="keyword">if</span> (x <span class="keyword">instanceof</span> MyPromise) &#123;</span><br><span class="line">        <span class="comment">// 2.3.2.1 å¦‚æœxä¸ºpendingçŠ¶æ€ï¼Œpromiseå¿…é¡»ä¿æŒpendingçŠ¶æ€ï¼Œç›´åˆ°xä¸ºfulfilled/rejected</span></span><br><span class="line">        <span class="keyword">if</span> (x.currentState === PENDING) &#123;</span><br><span class="line">            x.then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">                <span class="comment">// å†æ¬¡è°ƒç”¨è¯¥å‡½æ•°æ˜¯ä¸ºäº†ç¡®è®¤ x resolve çš„</span></span><br><span class="line">                <span class="comment">// å‚æ•°æ˜¯ä»€ä¹ˆç±»å‹ï¼Œå¦‚æœæ˜¯åŸºæœ¬ç±»å‹å°±å†æ¬¡ resolve</span></span><br><span class="line">                <span class="comment">// æŠŠå€¼ä¼ ç»™ä¸‹ä¸ª then</span></span><br><span class="line">                resolutionProcedure(promise2, value, resolve, reject)</span><br><span class="line">            &#125;, reject)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; <span class="comment">// ä½†å¦‚æœè¿™ä¸ªpromiseçš„çŠ¶æ€å·²ç»ç¡®å®šäº†ï¼Œé‚£ä¹ˆå®ƒè‚¯å®šæœ‰ä¸€ä¸ªæ­£å¸¸çš„å€¼ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªthenableï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥å–å®ƒçš„çŠ¶æ€</span></span><br><span class="line">            x.then(resolve, reject)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> called = <span class="literal">false</span></span><br><span class="line">    <span class="comment">// è§„èŒƒ 2.3.3ï¼Œåˆ¤æ–­ x æ˜¯å¦ä¸ºå¯¹è±¡æˆ–å‡½æ•°</span></span><br><span class="line">    <span class="keyword">if</span> (x !== <span class="literal">null</span> &amp;&amp; (<span class="keyword">typeof</span> x === <span class="string">&quot;object&quot;</span> || <span class="keyword">typeof</span> x === <span class="string">&quot;function&quot;</span>)) &#123;</span><br><span class="line">        <span class="comment">// è§„èŒƒ 2.3.3.2ï¼Œå¦‚æœä¸èƒ½å–å‡º thenï¼Œå°± reject</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// è§„èŒƒ2.3.3.1 å› ä¸ºx.thenå¯èƒ½æ˜¯ä¸€ä¸ªgetterï¼Œè¿™ç§æƒ…å†µä¸‹å¤šæ¬¡è¯»å–å°±æœ‰å¯èƒ½äº§ç”Ÿå‰¯ä½œç”¨</span></span><br><span class="line">            <span class="comment">// æ—¢è¦åˆ¤æ–­å®ƒçš„ç±»å‹ï¼Œåˆè¦è°ƒç”¨å®ƒï¼Œè¿™å°±æ˜¯ä¸¤æ¬¡è¯»å–</span></span><br><span class="line">            <span class="keyword">let</span> then = x.then</span><br><span class="line">            <span class="comment">// è§„èŒƒ2.3.3.3ï¼Œå¦‚æœ then æ˜¯å‡½æ•°ï¼Œè°ƒç”¨ x.then</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">typeof</span> then === <span class="string">&quot;function&quot;</span>) &#123;</span><br><span class="line">                <span class="comment">// è§„èŒƒ 2.3.3.3</span></span><br><span class="line">    			<span class="comment">// reject æˆ– reject å…¶ä¸­ä¸€ä¸ªæ‰§è¡Œè¿‡çš„è¯ï¼Œå¿½ç•¥å…¶ä»–çš„</span></span><br><span class="line">                then.call(</span><br><span class="line">                    x,</span><br><span class="line">                    y =&#123; <span class="comment">// è§„èŒƒ 2.3.3.3.1</span></span><br><span class="line">                        <span class="keyword">if</span> (called) <span class="keyword">return</span> <span class="comment">// è§„èŒƒ 2.3.3.3.3ï¼Œå³è¿™ä¸‰å¤„è°å…ˆæ‰§è¡Œå°±ä»¥è°çš„ç»“æœä¸ºå‡†</span></span><br><span class="line">                        called = <span class="literal">true</span></span><br><span class="line">                        <span class="comment">// è§„èŒƒ 2.3.3.3.1</span></span><br><span class="line">                        <span class="keyword">return</span> resolutionProcedure(promise2, y, resolve, reject)</span><br><span class="line">                    &#125;,</span><br><span class="line">                    r =&#123;</span><br><span class="line">                        <span class="keyword">if</span> (called) <span class="keyword">return</span> <span class="comment">// è§„èŒƒ 2.3.3.3.3ï¼Œå³è¿™ä¸‰å¤„è°å…ˆæ‰§è¡Œå°±ä»¥è°çš„ç»“æœä¸ºå‡†</span></span><br><span class="line">                        called = <span class="literal">true</span></span><br><span class="line">                         <span class="keyword">return</span> reject(r)</span><br><span class="line">                    &#125;</span><br><span class="line">                )</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// è§„èŒƒ 2.3.3.4</span></span><br><span class="line">                resolve(x)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123; <span class="comment">// è§„èŒƒ 2.3.3.2</span></span><br><span class="line">            <span class="keyword">if</span> (called) <span class="keyword">return</span> <span class="comment">// è§„èŒƒ 2.3.3.3.3ï¼Œå³è¿™ä¸‰å¤„è°å…ˆæ‰§è¡Œå°±ä»¥è°çš„ç»“æœä¸ºå‡†</span></span><br><span class="line">            called = <span class="literal">true</span></span><br><span class="line">            <span class="keyword">return</span> reject(e)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// è§„èŒƒ 2.3.4ï¼Œx ä¸ºåŸºæœ¬ç±»å‹</span></span><br><span class="line">        resolve(x)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨<code>resolutionProcedure</code>å‡½æ•°æ›¿æ¢<code>MyPromise.prototype.then</code>é‡Œé¢å‡ å¤„åˆ¤æ–­xæ˜¯å¦ä¸ºMyPromiseå¯¹è±¡çš„ä½ç½®å³å¯ã€‚å³ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (x <span class="keyword">instanceof</span> MyPromise) &#123;</span><br><span class="line">    x.then(resolve, reject)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// resolve(x) // å¦åˆ™ï¼Œä»¥å®ƒçš„è¿”å›å€¼ä¸º promise2 çš„ç»“æœ</span></span><br></pre></td></tr></table></figure>

<p>æ›¿æ¢ä¸ºï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">resolutionProcedure(promise2, x, resolve, reject)</span><br></pre></td></tr></table></figure>

<p>æ€»å…±å››å¤„ï¼Œä¸è¦é—æ¼äº†</p>
<h4 id="Promiseæ„å»ºä¹ï¼šå®Œæ•´ä»£ç å®ç°"><a href="#Promiseæ„å»ºä¹ï¼šå®Œæ•´ä»£ç å®ç°" class="headerlink" title="Promiseæ„å»ºä¹ï¼šå®Œæ•´ä»£ç å®ç°"></a>Promiseæ„å»ºä¹ï¼šå®Œæ•´ä»£ç å®ç°</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä¸‰ç§çŠ¶æ€</span></span><br><span class="line"><span class="keyword">const</span> PENDING = <span class="string">&quot;pending&quot;</span></span><br><span class="line"><span class="keyword">const</span> RESOLVED = <span class="string">&quot;resolved&quot;</span></span><br><span class="line"><span class="keyword">const</span> REJECTED = <span class="string">&quot;rejected&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MyPromise</span>(<span class="params">callback</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> _this = <span class="built_in">this</span></span><br><span class="line">    _this.currentState = PENDING <span class="comment">// Promiseå½“å‰çš„çŠ¶æ€</span></span><br><span class="line">    _this.value = <span class="keyword">void</span> <span class="number">0</span> <span class="comment">// Promiseçš„å€¼</span></span><br><span class="line">    <span class="comment">// ç”¨äºä¿å­˜ then çš„å›è°ƒï¼Œ åªæœ‰å½“ promise</span></span><br><span class="line">    <span class="comment">// çŠ¶æ€ä¸º pending æ—¶æ‰ä¼šç¼“å­˜ï¼Œå¹¶ä¸”æ¯ä¸ªå®ä¾‹è‡³å¤šç¼“å­˜ä¸€ä¸ª</span></span><br><span class="line">    _this.onResolvedCallbacks = [] <span class="comment">// Promise resolveæ—¶çš„å›è°ƒå‡½æ•°é›†</span></span><br><span class="line">    _this.onRejectedCallbacks = [] <span class="comment">// Promise rejectæ—¶çš„å›è°ƒå‡½æ•°é›†</span></span><br><span class="line">    _this.resolve = <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (value <span class="keyword">instanceof</span> MyPromise) &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœ value æ˜¯ä¸ª Promiseï¼Œ é€’å½’æ‰§è¡Œ</span></span><br><span class="line">            <span class="keyword">return</span> value.then(_this.resolve, _this.reject)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">setTimeout</span>(() =&#123; <span class="comment">// å¼‚æ­¥æ‰§è¡Œï¼Œä¿è¯é¡ºåºæ‰§è¡Œ</span></span><br><span class="line">            <span class="keyword">if</span> (_this.currentState === PENDING) &#123;</span><br><span class="line">                _this.currentState = RESOLVED <span class="comment">// çŠ¶æ€ç®¡ç†</span></span><br><span class="line">                _this.value = value</span><br><span class="line">                _this.onResolvedCallbacks.forEach(cb =cb())</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125; <span class="comment">// resolve å¤„ç†å‡½æ•°</span></span><br><span class="line">    _this.reject = <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(() =&#123; <span class="comment">// å¼‚æ­¥æ‰§è¡Œï¼Œä¿è¯é¡ºåºæ‰§è¡Œ</span></span><br><span class="line">            <span class="keyword">if</span> (_this.currentState === PENDING) &#123;</span><br><span class="line">                _this.currentState = REJECTED <span class="comment">// çŠ¶æ€ç®¡ç†</span></span><br><span class="line">                _this.value = value</span><br><span class="line">                _this.onRejectedCallbacks.forEach(cb =cb())</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125; <span class="comment">// reject å¤„ç†å‡½æ•°</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¼‚å¸¸å¤„ç†</span></span><br><span class="line">    <span class="comment">// new Promise(() =throw Error(&#x27;error&#x27;))</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        callback(_this.resolve, _this.reject) <span class="comment">// æ‰§è¡Œcallbackå¹¶ä¼ å…¥ç›¸åº”çš„å‚æ•°</span></span><br><span class="line">    &#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">        _this.reject(e)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// then æ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ï¼ŒonFulfilledï¼ŒonRejectedï¼Œåˆ†åˆ«ä¸ºPromiseæˆåŠŸæˆ–å¤±è´¥çš„å›è°ƒ</span></span><br><span class="line">MyPromise.prototype.then = <span class="function"><span class="keyword">function</span>(<span class="params">onFulfilled, onRejected</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> _this = <span class="built_in">this</span></span><br><span class="line">    <span class="comment">// è§„èŒƒ 2.2.7ï¼Œthen å¿…é¡»è¿”å›ä¸€ä¸ªæ–°çš„ promise</span></span><br><span class="line">    <span class="keyword">var</span> promise2</span><br><span class="line">    <span class="comment">// æ ¹æ®è§„èŒƒ 2.2.1 ï¼ŒonFulfilledã€onRejected éƒ½æ˜¯å¯é€‰å‚æ•°</span></span><br><span class="line">    <span class="comment">// onFulfilledã€onRejectedä¸æ˜¯å‡½æ•°éœ€è¦å¿½ç•¥ï¼ŒåŒæ—¶ä¹Ÿå®ç°äº†å€¼ç©¿é€</span></span><br><span class="line">    onFulfilled = <span class="keyword">typeof</span> onFulfilled === <span class="string">&#x27;function&#x27;</span> ? onFulfilled : value =value</span><br><span class="line">    onRejected = <span class="keyword">typeof</span> onRejected === <span class="string">&#x27;function&#x27;</span> ? onRejected : error =&#123;<span class="keyword">throw</span> error&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (_this.currentState === RESOLVED) &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœpromise1ï¼ˆæ­¤å¤„ä¸ºself/thisï¼‰çš„çŠ¶æ€å·²ç»ç¡®å®šå¹¶ä¸”ä¸ºresolvedï¼Œæˆ‘ä»¬è°ƒç”¨onFulfilled</span></span><br><span class="line">        <span class="comment">// å¦‚æœè€ƒè™‘åˆ°æœ‰å¯èƒ½throwï¼Œæ‰€ä»¥æˆ‘ä»¬å°†å…¶åŒ…åœ¨try/catchå—ä¸­</span></span><br><span class="line">        <span class="keyword">return</span> promise2 = <span class="keyword">new</span> MyPromise(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">var</span> x = onFulfilled(_this.value)</span><br><span class="line">                <span class="comment">// å¦‚æœ onFulfilled çš„è¿”å›å€¼æ˜¯ä¸€ä¸ª Promise å¯¹è±¡ï¼Œç›´æ¥å–å®ƒçš„ç»“æœä½œä¸º promise2 çš„ç»“æœ</span></span><br><span class="line">                resolutionProcedure(promise2, x, resolve, reject)</span><br><span class="line">            &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">                reject(err) <span class="comment">// å¦‚æœå‡ºé”™ï¼Œä»¥æ•è·åˆ°çš„é”™è¯¯ä½œä¸ºpromise2çš„ç»“æœ</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ­¤å¤„å®ç°ä¸FULFILLEDç›¸ä¼¼ï¼ŒåŒºåˆ«åœ¨ä½¿ç”¨çš„æ˜¯onRejectedè€Œä¸æ˜¯onFulfilled</span></span><br><span class="line">    <span class="keyword">if</span> (_this.currentState === REJECTED) &#123;</span><br><span class="line">        <span class="keyword">return</span> promise2 = <span class="keyword">new</span> MyPromise(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">var</span> x = onRejected(_this.value)</span><br><span class="line">                resolutionProcedure(promise2, x, resolve, reject)</span><br><span class="line">            &#125; <span class="keyword">catch</span>(err) &#123;</span><br><span class="line">                reject(err)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (_this.currentState === PENDING) &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœå½“å‰çš„Promiseè¿˜å¤„äºPENDINGçŠ¶æ€ï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½ç¡®å®šè°ƒç”¨onFulfilledè¿˜æ˜¯onRejected</span></span><br><span class="line">        <span class="comment">// åªæœ‰ç­‰å¾…Promiseçš„çŠ¶æ€ç¡®å®šåï¼Œå†åšå¤„ç†</span></span><br><span class="line">        <span class="comment">// æ‰€ä»¥æˆ‘ä»¬éœ€è¦æŠŠæˆ‘ä»¬çš„ä¸¤ç§æƒ…å†µçš„å¤„ç†é€»è¾‘åšæˆcallbackæ”¾å…¥promise1ï¼ˆæ­¤å¤„å³_this/thisï¼‰çš„å›è°ƒæ•°ç»„å†…</span></span><br><span class="line">        <span class="comment">// å¤„ç†é€»è¾‘å’Œä»¥ä¸Šç›¸ä¼¼</span></span><br><span class="line">        <span class="keyword">return</span> promise2 = <span class="keyword">new</span> MyPromise(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">            _this.onResolvedCallbacks.push(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">var</span> x = onFulfilled(_this.value)</span><br><span class="line">                    resolutionProcedure(promise2, x, resolve, reject)</span><br><span class="line">                &#125; <span class="keyword">catch</span>(err) &#123;</span><br><span class="line">                    reject(err)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">            _this.onRejectedCallbacks.push(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">var</span> x = onRejected(_this.value)</span><br><span class="line">                    resolutionProcedure(promise2, x, resolve, reject)</span><br><span class="line">                &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">                    reject(err)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è§„èŒƒ 2.3</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    resolutionProcedureå‡½æ•°å³ä¸ºæ ¹æ®xçš„å€¼æ¥å†³å®špromise2çš„çŠ¶æ€çš„å‡½æ•°</span></span><br><span class="line"><span class="comment">    ä¹Ÿå³æ ‡å‡†ä¸­çš„[Promise Resolution Procedure](https://promisesaplus.com/#point-47)</span></span><br><span class="line"><span class="comment">    x ä¸º promise2 = promise1.then(onFulfilled, onRejected)é‡ŒonFulfilled/onRejectedçš„è¿”å›å€¼</span></span><br><span class="line"><span class="comment">    resolve å’Œ reject å®é™…ä¸Šæ˜¯ promise2 çš„executorçš„ä¸¤ä¸ªå®å‚ï¼Œå› ä¸ºå¾ˆéš¾æŒ‚åœ¨å…¶ä»–åœ°æ–¹ï¼Œæ‰€ä»¥ä¸€å¹¶ä¼ è¿‡æ¥ã€‚</span></span><br><span class="line"><span class="comment">    ç›¸ä¿¡å„ä½ä¸€å®šå¯ä»¥å¯¹ç…§æ ‡å‡†è½¬æ¢æˆä»£ç ï¼Œè¿™é‡Œå°±åªæ ‡å‡ºä»£ç åœ¨æ ‡å‡†ä¸­å¯¹åº”çš„ä½ç½®ï¼Œåªåœ¨å¿…è¦çš„åœ°æ–¹åšä¸€äº›è§£é‡Šã€‚</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">resolutionProcedure</span>(<span class="params">promise2, x, resolve, reject</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// è§„èŒƒ 2.3.1ï¼Œx ä¸èƒ½å’Œ promise2 ç›¸åŒï¼Œé¿å…å¾ªç¯å¼•ç”¨</span></span><br><span class="line">        <span class="keyword">if</span> (promise2 === x) &#123;</span><br><span class="line">            <span class="keyword">return</span> reject(<span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">&quot;Chaining cycle detected for promise!&quot;</span>))</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è§„èŒƒ 2.3.2</span></span><br><span class="line">        <span class="comment">// å¦‚æœ x ä¸º Promiseï¼ŒçŠ¶æ€ä¸º pending éœ€è¦ç»§ç»­ç­‰å¾…å¦åˆ™æ‰§è¡Œ</span></span><br><span class="line">        <span class="keyword">if</span> (x <span class="keyword">instanceof</span> MyPromise) &#123;</span><br><span class="line">            <span class="comment">// 2.3.2.1 å¦‚æœxä¸ºpendingçŠ¶æ€ï¼Œpromiseå¿…é¡»ä¿æŒpendingçŠ¶æ€ï¼Œç›´åˆ°xä¸ºfulfilled/rejected</span></span><br><span class="line">            <span class="keyword">if</span> (x.currentState === PENDING) &#123;</span><br><span class="line">                x.then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">                    <span class="comment">// å†æ¬¡è°ƒç”¨è¯¥å‡½æ•°æ˜¯ä¸ºäº†ç¡®è®¤ x resolve çš„</span></span><br><span class="line">                    <span class="comment">// å‚æ•°æ˜¯ä»€ä¹ˆç±»å‹ï¼Œå¦‚æœæ˜¯åŸºæœ¬ç±»å‹å°±å†æ¬¡ resolve</span></span><br><span class="line">                    <span class="comment">// æŠŠå€¼ä¼ ç»™ä¸‹ä¸ª then</span></span><br><span class="line">                    resolutionProcedure(promise2, value, resolve, reject)</span><br><span class="line">                &#125;, reject)</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123; <span class="comment">// ä½†å¦‚æœè¿™ä¸ªpromiseçš„çŠ¶æ€å·²ç»ç¡®å®šäº†ï¼Œé‚£ä¹ˆå®ƒè‚¯å®šæœ‰ä¸€ä¸ªæ­£å¸¸çš„å€¼ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªthenableï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥å–å®ƒçš„çŠ¶æ€</span></span><br><span class="line">                x.then(resolve, reject)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> called = <span class="literal">false</span></span><br><span class="line">        <span class="comment">// è§„èŒƒ 2.3.3ï¼Œåˆ¤æ–­ x æ˜¯å¦ä¸ºå¯¹è±¡æˆ–å‡½æ•°</span></span><br><span class="line">        <span class="keyword">if</span> (x !== <span class="literal">null</span> &amp;&amp; (<span class="keyword">typeof</span> x === <span class="string">&quot;object&quot;</span> || <span class="keyword">typeof</span> x === <span class="string">&quot;function&quot;</span>)) &#123;</span><br><span class="line">            <span class="comment">// è§„èŒƒ 2.3.3.2ï¼Œå¦‚æœä¸èƒ½å–å‡º thenï¼Œå°± reject</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">// è§„èŒƒ2.3.3.1 å› ä¸ºx.thenå¯èƒ½æ˜¯ä¸€ä¸ªgetterï¼Œè¿™ç§æƒ…å†µä¸‹å¤šæ¬¡è¯»å–å°±æœ‰å¯èƒ½äº§ç”Ÿå‰¯ä½œç”¨</span></span><br><span class="line">                <span class="comment">// æ—¢è¦åˆ¤æ–­å®ƒçš„ç±»å‹ï¼Œåˆè¦è°ƒç”¨å®ƒï¼Œè¿™å°±æ˜¯ä¸¤æ¬¡è¯»å–</span></span><br><span class="line">                <span class="keyword">let</span> then = x.then</span><br><span class="line">                <span class="comment">// è§„èŒƒ2.3.3.3ï¼Œå¦‚æœ then æ˜¯å‡½æ•°ï¼Œè°ƒç”¨ x.then</span></span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">typeof</span> then === <span class="string">&quot;function&quot;</span>) &#123;</span><br><span class="line">                    <span class="comment">// è§„èŒƒ 2.3.3.3</span></span><br><span class="line">                    <span class="comment">// reject æˆ– reject å…¶ä¸­ä¸€ä¸ªæ‰§è¡Œè¿‡çš„è¯ï¼Œå¿½ç•¥å…¶ä»–çš„</span></span><br><span class="line">                    then.call(</span><br><span class="line">                        x,</span><br><span class="line">                        y =&#123; <span class="comment">// è§„èŒƒ 2.3.3.3.1</span></span><br><span class="line">                            <span class="keyword">if</span> (called) <span class="keyword">return</span> <span class="comment">// è§„èŒƒ 2.3.3.3.3ï¼Œå³è¿™ä¸‰å¤„è°å…ˆæ‰§è¡Œå°±ä»¥è°çš„ç»“æœä¸ºå‡†</span></span><br><span class="line">                            called = <span class="literal">true</span></span><br><span class="line">                            <span class="comment">// è§„èŒƒ 2.3.3.3.1</span></span><br><span class="line">                            <span class="keyword">return</span> resolutionProcedure(promise2, y, resolve, reject)</span><br><span class="line">                        &#125;,</span><br><span class="line">                        r =&#123;</span><br><span class="line">                            <span class="keyword">if</span> (called) <span class="keyword">return</span> <span class="comment">// è§„èŒƒ 2.3.3.3.3ï¼Œå³è¿™ä¸‰å¤„è°å…ˆæ‰§è¡Œå°±ä»¥è°çš„ç»“æœä¸ºå‡†</span></span><br><span class="line">                            called = <span class="literal">true</span></span><br><span class="line">                            <span class="keyword">return</span> reject(r)</span><br><span class="line">                        &#125;</span><br><span class="line">                    )</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">// è§„èŒƒ 2.3.3.4</span></span><br><span class="line">                    resolve(x)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (e) &#123; <span class="comment">// è§„èŒƒ 2.3.3.2</span></span><br><span class="line">                <span class="keyword">if</span> (called) <span class="keyword">return</span> <span class="comment">// è§„èŒƒ 2.3.3.3.3ï¼Œå³è¿™ä¸‰å¤„è°å…ˆæ‰§è¡Œå°±ä»¥è°çš„ç»“æœä¸ºå‡†</span></span><br><span class="line">                called = <span class="literal">true</span></span><br><span class="line">                <span class="keyword">return</span> reject(e)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// è§„èŒƒ 2.3.4ï¼Œx ä¸ºåŸºæœ¬ç±»å‹</span></span><br><span class="line">            resolve(x)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// catch çš„å®ç°</span></span><br><span class="line">MyPromise.prototype.catch = <span class="function"><span class="keyword">function</span> (<span class="params">onRejected</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.then(<span class="literal">null</span>, onRejected)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// finally çš„å®ç°</span></span><br><span class="line">MyPromise.prototype.finally = <span class="function"><span class="keyword">function</span> (<span class="params">callback</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">this</span>.then(<span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> MyPromise.resolve(callback()).then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> value</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;, <span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> MyPromise.resolve(callback()).then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">throw</span> err</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é¢å¤–ï¼Œé™„åŠ  <code>Promise.race</code> ä¸ <code>Promise.all</code> çš„å®ç°ï¼Œæœ‰å…´è¶£çš„å¯ä»¥äº†è§£ä¸€ä¸‹</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// race</span></span><br><span class="line">MyPromise.race = <span class="function"><span class="keyword">function</span>(<span class="params">values</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> MyPromise(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">        values.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">            MyPromise.resolve(value).then(resolve, reject)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// all</span></span><br><span class="line">MyPromise.all = <span class="function"><span class="keyword">function</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> args = <span class="built_in">Array</span>.prototype.slice.call(arr)</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> MyPromise(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (args.length === <span class="number">0</span>) <span class="keyword">return</span> resolve([])</span><br><span class="line">        <span class="keyword">var</span> remaining = args.length</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; args.length; i++) &#123;</span><br><span class="line">            res(i, args[i])</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">res</span>(<span class="params">i, val</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (val &amp;&amp; (<span class="keyword">typeof</span> val === <span class="string">&#x27;object&#x27;</span> || <span class="keyword">typeof</span> val === <span class="string">&#x27;function&#x27;</span>)) &#123;</span><br><span class="line">                <span class="keyword">if</span> (val <span class="keyword">instanceof</span> MyPromise &amp;&amp; val.then === MyPromise.prototype.then) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (val.currentState === RESOLVED) <span class="keyword">return</span> res(i, val.value)</span><br><span class="line">                    <span class="keyword">if</span> (val.currentState === REJECTED) reject(val.value)</span><br><span class="line">                    val.then(<span class="function"><span class="keyword">function</span> (<span class="params">val</span>) </span>&#123;</span><br><span class="line">                        res(i, val)</span><br><span class="line">                    &#125;, reject)</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">var</span> then = val.then</span><br><span class="line">                    <span class="keyword">if</span> (<span class="keyword">typeof</span> then === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">                        <span class="keyword">var</span> p = <span class="keyword">new</span> MyPromise(then.bind(val))</span><br><span class="line">                        p.then(<span class="function"><span class="keyword">function</span>(<span class="params">val</span>) </span>&#123;</span><br><span class="line">                            res(i, val)</span><br><span class="line">                        &#125;, reject)</span><br><span class="line">                        <span class="keyword">return</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            args[i] = val</span><br><span class="line">            <span class="keyword">if</span> (--remaining === <span class="number">0</span>) &#123;</span><br><span class="line">                resolve(args)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Void 0 å…¶å®å¯ä»¥ç†è§£æˆundefinedï¼Œå› ä¸ºundefinedå¯ä»¥åœ¨å±€éƒ¨å‡½æ•°é‡Œè¢«è¦†ç›–ï¼Œvoid 0 ä¸ä¼šã€‚</p>
<p>voidæ˜¯ä¸€ä¸ªè¿ç®—ç¬¦ï¼Œç»™è¡¨è¾¾å¼æ±‚å€¼ï¼Œè¿”å›undefinedã€‚void 0 æ˜¯è¡¨è¾¾å¼ä¸­æœ€çŸ­çš„ï¼Œæœ€èŠ‚çœå­—èŠ‚ã€‚</p>
<p>setTimeout å¦‚æœä¸ä¼ æ—¶é—´ï¼Œé»˜è®¤å–0ã€‚</p>
<p>â€œå‚è€ƒâ€</p>
<p><a href="https://segmentfault.com/q/1010000009781257">promiseå–æ¶ˆçš„ä¸€äº›è®¨è®º</a></p>
]]></content>
      <tags>
        <tag>Promise å·¥å…·</tag>
      </tags>
  </entry>
  <entry>
    <title>æµè§ˆå™¨å¼‚æ­¥ï¼ˆäºŒï¼‰</title>
    <url>/2020/07/18/%E6%B5%8F%E8%A7%88%E5%99%A8%E5%BC%82%E6%AD%A5%EF%BC%88%E4%BA%8C%EF%BC%89/</url>
    <content><![CDATA[<blockquote>
<p>è½¬è½½è‡ªç“¶å­å›çš„blog <a href="https://github.com/sisterAn/blog/issues/12">é“¾æ¥</a></p>
</blockquote>
<h3 id="step1ï¼šå›è°ƒå‡½æ•°callback"><a href="#step1ï¼šå›è°ƒå‡½æ•°callback" class="headerlink" title="step1ï¼šå›è°ƒå‡½æ•°callback"></a>step1ï¼šå›è°ƒå‡½æ•°callback</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">asyncFunction(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// todo</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>è¿™ç§å›è°ƒå‡½æ•°ï¼Œå¤§å®¶æ˜¯æœ€ç†Ÿæ‚‰çš„ã€‚ä¸€èˆ¬æ˜¯éœ€è¦åœ¨æŸä¸ªè€—æ—¶æ“ä½œä¹‹åæ‰§è¡ŒæŸä¸ªå›è°ƒå‡½æ•°ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;Time out&#x27;</span>)</span><br><span class="line">&#125;, <span class="number">1000</span>)</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­ï¼Œæˆ‘ä»¬ç§°<code>setTimeout</code>ä¸ºå‘èµ·å‡½æ•°ï¼Œ<code>fn</code>ä¸ºå›è°ƒå‡½æ•°ã€‚éƒ½æ˜¯åœ¨ä¸»çº¿ç¨‹ä¸Šè°ƒç”¨çš„ï¼Œå…¶ä¸­å‘èµ·å‡½æ•°ç”¨æ¥å‘åŠ¨å¼‚æ­¥è¿‡ç¨‹ï¼Œå›è°ƒå‡½æ•°ç”¨æ¥å¤„ç†ç»“æœã€‚åœ¨æ‰§è¡Œ<code>setTimeout</code>1såï¼Œæ‰§è¡Œfunctionå‡½æ•°ã€‚</p>
<p>ä¸‹é¢ï¼Œæˆ‘ä»¬å†çœ‹ä¸€ç§æƒ…å†µã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">$.ajax(&#123;</span><br><span class="line">    <span class="attr">url</span>:<span class="string">&#x27;XXX1&#x27;</span>,</span><br><span class="line">    <span class="attr">success</span>: <span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</span><br><span class="line">        $.ajax(&#123;</span><br><span class="line">            <span class="attr">url</span>:<span class="string">&#x27;XXX2&#x27;</span>,</span><br><span class="line">            <span class="attr">success</span>: <span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</span><br><span class="line">                $.ajax(&#123;</span><br><span class="line">                    <span class="attr">url</span>: <span class="string">&#x27;XXX3&#x27;</span>,</span><br><span class="line">                    <span class="attr">success</span>: <span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</span><br><span class="line">                        <span class="comment">// todo</span></span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="attr">fail</span>: <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">                        <span class="built_in">console</span>.log(err)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">fail</span>: <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(err)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;) </span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">fail</span>: <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">    	<span class="built_in">console</span>.log(err)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>åœ¨ä¸Šä¾‹ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°è¿™æ®µå›è°ƒå‡½æ•°ï¼Œä¸æ–­çš„åœ¨å›è°ƒï¼Œè¿™åªæ˜¯ä¸‰å±‚å›è°ƒï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬é‡åˆ°çš„éœ€æ±‚ä¼šæ›´å¤æ‚ï¼Œå›è°ƒä¹Ÿè®¸æ›´å¤šï¼Œè°ƒè¯•èµ·æ¥ä¹Ÿå°±æ›´éº»çƒ¦ï¼Œä»£ç ä¹Ÿæ›´ä¸ç¾è§‚ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬è¦å¼•å…¥çš„ç¬¬ä¸€ä¸ªé—®é¢˜ï¼šå›è°ƒåœ°ç‹±ã€‚</p>
<p><strong>é—®é¢˜1: å›è°ƒåœ°ç‹±</strong></p>
<p>å›è°ƒåœ°ç‹±æ˜¯JSé‡Œä¸€ä¸ªçº¦å®šä¿—æˆçš„åç§°ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸€ä¸ªä¸šåŠ¡ä¾èµ–äºä¸Šå±‚ä¸šåŠ¡ï¼Œä¸Šå±‚ä¸šåŠ¡åˆä¾èµ–äºæ›´ä¸Šä¸€å±‚çš„ä¸šåŠ¡ï¼Œä»¥æ­¤ç±»æ¨ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨å›è°ƒå‡½æ•°æ¥å¤„ç†å¼‚æ­¥çš„è¯ï¼Œå°±ä¼šå‡ºç°å›è°ƒåœ°ç‹±ã€‚</p>
<p>ä¸»è¦æ˜¯å› ä¸ºï¼šå¤§è„‘å¯¹ä¸šåŠ¡çš„é€»è¾‘å¤„ç†æ˜¯çº¿æ€§çš„ã€é˜»å¡çš„ã€å•çº¿ç¨‹çš„ï¼Œä½†æ˜¯å›è°ƒè¡¨è¾¾å¼‚æ­¥çš„æ–¹å¼æ˜¯éçº¿å½¢çš„ã€éé¡ºåºçš„ï¼Œè¿™ä½¿å¾—æ­£ç¡®æ¨å¯¼è¿™ç±»ä»£ç çš„éš¾åº¦å¾ˆå¤§ï¼Œå¾ˆå®¹æ˜“å‡ºbugã€‚</p>
<p>å†ä¾‹å¦‚ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// A</span></span><br><span class="line">$.ajax(&#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="attr">success</span>: <span class="function"><span class="keyword">function</span> (<span class="params">...</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// C</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// B</span></span><br></pre></td></tr></table></figure>

<p>Aå’ŒBå‘ç”Ÿäºç°åœ¨ï¼Œåœ¨JavaScriptä¸»ç¨‹åºçš„ç›´æ¥æ§åˆ¶ä¹‹ä¸‹ï¼Œè€ŒCä¼šå»¶è¿Ÿåˆ°å°†æ¥å‘ç”Ÿï¼Œå¹¶ä¸”æ˜¯åœ¨ç¬¬ä¸‰æ–¹çš„æ§åˆ¶ä¸‹ï¼Œåœ¨æœ¬ä¾‹ä¸­å°±æ˜¯å‡½æ•°$.ajax(â€¦)ã€‚ä»æ ¹æœ¬ä¸Šæ¥è¯´ï¼Œè¿™ç§æ§åˆ¶çš„è½¬ç§»é€šå¸¸ä¸ä¼šç»™ç¨‹åºå¸¦æ¥å¾ˆå¤šé—®é¢˜ã€‚</p>
<p>ä½†æ˜¯ï¼Œè¯·ä¸è¦è¢«è¿™ä¸ªå°æ¦‚ç‡è¿·æƒ‘è€Œè®¤ä¸ºè¿™ç§æ§åˆ¶åˆ‡æ¢ä¸æ˜¯ä»€ä¹ˆå¤§é—®é¢˜ã€‚å®é™…ä¸Šï¼Œè¿™æ˜¯å›è°ƒé©±åŠ¨è®¾è®¡æœ€ä¸¥é‡ï¼ˆä¹Ÿæ˜¯æœ€å¾®å¦™ï¼‰çš„é—®é¢˜ã€‚å®ƒä»¥è¿™æ ·ä¸€ä¸ªæ€è·¯ä¸ºä¸­å¿ƒï¼šæœ‰æ—¶å€™ajax(â€¦)ï¼Œä¹Ÿå°±æ˜¯ä½ äº¤ä»˜å›è°ƒå‡½æ•°çš„ç¬¬ä¸‰æ–¹ä¸æ˜¯ä½ ç¼–å†™çš„ä»£ç ï¼Œä¹Ÿä¸åœ¨ä½ çš„ç›´æ¥æ§åˆ¶ä¹‹ä¸‹ï¼Œå®ƒæ˜¯æŸä¸ªç¬¬ä¸‰æ–¹æä¾›çš„å·¥å…·ã€‚</p>
<p>è¿™ç§æƒ…å†µç§°ä¸º<strong>æ§åˆ¶åè½¬</strong>ï¼Œä¹Ÿå°±æ˜¯æŠŠè‡ªå·±ç¨‹åºä¸€éƒ¨åˆ†çš„æ‰§è¡Œæ§åˆ¶äº¤ç»™æŸä¸ªç¬¬ä¸‰æ–¹ï¼Œåœ¨ä½ çš„ä»£ç å’Œç¬¬ä¸‰æ–¹å·¥å…·ç›´æ¥æœ‰ä¸€ä»½å¹¶æ²¡æœ‰æ˜ç¡®è¡¨è¾¾çš„å¥‘çº¦ã€‚</p>
<p>æ—¢ç„¶æ˜¯æ— æ³•æ§åˆ¶çš„ç¬¬ä¸‰æ–¹åœ¨æ‰§è¡Œä½ çš„å›è°ƒå‡½æ•°ï¼Œé‚£ä¹ˆå°±æœ‰å¯èƒ½å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼Œå½“ç„¶é€šå¸¸æƒ…å†µä¸‹æ˜¯ä¸ä¼šå‘ç”Ÿçš„ï¼š</p>
<ol>
<li>è°ƒç”¨å›è°ƒè¿‡æ—©</li>
<li>è°ƒç”¨å›è°ƒè¿‡æ™š</li>
<li>è°ƒç”¨å›è°ƒæ¬¡æ•°å¤ªå¤šæˆ–è€…å¤ªå°‘</li>
<li>æœªèƒ½æŠŠæ‰€éœ€çš„å‚æ•°æˆåŠŸä¼ ç»™ä½ çš„å›è°ƒå‡½æ•°</li>
<li>åæ‰å¯èƒ½å‡ºç°çš„é”™è¯¯æˆ–å¼‚å¸¸</li>
<li>â€¦â€¦</li>
</ol>
<p>è¿™ç§æ§åˆ¶åè½¬ä¼šå¯¼è‡´ä¿¡ä»»é“¾çš„å®Œå…¨æ–­è£‚ï¼Œå¦‚æœä½ æ²¡æœ‰é‡‡å–è¡ŒåŠ¨æ¥è§£å†³è¿™äº›æ§åˆ¶åè½¬å¯¼è‡´çš„ä¿¡ä»»é—®é¢˜ï¼Œé‚£ä¹ˆä½ çš„ä»£ç å·²ç»æœ‰äº†éšè—çš„Bugï¼Œå°½ç®¡æˆ‘ä»¬å¤§å¤šæ•°äººéƒ½æ²¡æœ‰è¿™æ ·åšã€‚</p>
<p>è¿™é‡Œï¼Œæˆ‘ä»¬å¼•å‡ºäº†å›è°ƒå‡½æ•°å¤„ç†å¼‚æ­¥çš„ç¬¬äºŒä¸ªé—®é¢˜ï¼š<strong>æ§åˆ¶åè½¬</strong>ã€‚</p>
<h3 id="step2ï¼šæ§åˆ¶åè½¬"><a href="#step2ï¼šæ§åˆ¶åè½¬" class="headerlink" title="step2ï¼šæ§åˆ¶åè½¬"></a><strong>step2ï¼šæ§åˆ¶åè½¬</strong></h3><p>ç»¼ä¸Šï¼Œå›è°ƒå‡½æ•°å¤„ç†å¼‚æ­¥æµç¨‹å­˜åœ¨2ä¸ªé—®é¢˜ï¼š</p>
<p><strong>1. ç¼ºä¹é¡ºåºæ€§ï¼š å›è°ƒåœ°ç‹±å¯¼è‡´çš„è°ƒè¯•å›°éš¾ï¼Œå’Œå¤§è„‘çš„æ€ç»´æ–¹å¼ä¸ç¬¦</strong></p>
<p><strong>2. ç¼ºä¹å¯ä¿¡ä»»æ€§ï¼š æ§åˆ¶åè½¬å¯¼è‡´çš„ä¸€ç³»åˆ—ä¿¡ä»»é—®é¢˜</strong></p>
<p>é‚£ä¹ˆå¦‚ä½•æ¥è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜ï¼Œå…ˆé©±è€…ä»¬å¼€å§‹äº†æ¢ç´¢ä¹‹è·¯â€¦â€¦</p>
<hr>
<p>å‚è€ƒï¼š<br><a href="https://github.com/sisterAn/blog/issues/12">ç“¶å­å› blog</a></p>
]]></content>
      <tags>
        <tag>JS</tag>
      </tags>
  </entry>
  <entry>
    <title>ç§»åŠ¨ç«¯</title>
    <url>/2018/11/03/%E7%A7%BB%E5%8A%A8%E7%AB%AF/</url>
    <content><![CDATA[<h4 id="å¦‚ä½•ç¼–å†™ç§»åŠ¨ç«¯ğŸ˜-ï¼Ÿè¯ä¸å¤šè¯´ï¼Œå³åˆ»å¸¦å¤§å®¶è¿›å…¥ä»Šå¤©ä¸»é¢˜"><a href="#å¦‚ä½•ç¼–å†™ç§»åŠ¨ç«¯ğŸ˜-ï¼Ÿè¯ä¸å¤šè¯´ï¼Œå³åˆ»å¸¦å¤§å®¶è¿›å…¥ä»Šå¤©ä¸»é¢˜" class="headerlink" title="å¦‚ä½•ç¼–å†™ç§»åŠ¨ç«¯ğŸ˜ ï¼Ÿè¯ä¸å¤šè¯´ï¼Œå³åˆ»å¸¦å¤§å®¶è¿›å…¥ä»Šå¤©ä¸»é¢˜"></a>å¦‚ä½•ç¼–å†™ç§»åŠ¨ç«¯ğŸ˜ ï¼Ÿè¯ä¸å¤šè¯´ï¼Œå³åˆ»å¸¦å¤§å®¶è¿›å…¥ä»Šå¤©ä¸»é¢˜</h4><ul>
<li>å¦‚æˆ‘ä»¬å¸¸è§„æ‰€è§ï¼Œç§»åŠ¨ç«¯å’ŒPCç«¯çš„æœ€å¤§å·®å¼‚å°±æ˜¯ï¼šè®¾å¤‡çš„åˆ†è¾¨ç‡ã€‚</li>
<li>ç§»åŠ¨ç«¯ï¼šä¸‹é¢æ˜¯ä¸€æ®µé»˜è®¤åŠ è½½åœ¨å¤´éƒ¨çš„è®¾ç½®<code>htmlæ ‡ç­¾çš„fontSize</code>çš„js<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> (<span class="params">pageWidth= <span class="number">750</span></span>) </span>&#123; <span class="comment">// è®¾è®¡ç¨¿å¯ä»¥ä¼ å‚ï¼Œæ™®éæ˜¯750</span></span><br><span class="line">    !(<span class="function"><span class="keyword">function</span>(<span class="params">win, doc</span>)</span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">setFontSize</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="comment">// è·å–è®¾å¤‡ å®½åº¦</span></span><br><span class="line">            <span class="keyword">var</span> winWidth =  <span class="built_in">window</span>.innerWidth;</span><br><span class="line">            <span class="keyword">var</span> size = (winWidth / pageWidth) * <span class="number">100</span>;</span><br><span class="line">            doc.documentElement.style.fontSize = size + <span class="string">&#x27;px&#x27;</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> evt = <span class="string">&#x27;onorientationchange&#x27;</span> <span class="keyword">in</span> win ? <span class="string">&#x27;orientationchange&#x27;</span> : <span class="string">&#x27;resize&#x27;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> timer = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        win.addEventListener(evt, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="built_in">clearTimeout</span>(timer);</span><br><span class="line"></span><br><span class="line">            timer = <span class="built_in">setTimeout</span>(setFontSize, <span class="number">300</span>);</span><br><span class="line">        &#125;, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">        win.addEventListener(<span class="string">&quot;pageshow&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (e.persisted) &#123;</span><br><span class="line">                <span class="built_in">clearTimeout</span>(timer);</span><br><span class="line"></span><br><span class="line">                timer = <span class="built_in">setTimeout</span>(setFontSize, <span class="number">300</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">        setFontSize();</span><br><span class="line"></span><br><span class="line">    &#125;(<span class="built_in">window</span>, <span class="built_in">document</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>åŠ¨æ€çš„è·å–è®¾å¤‡ç‹¬ç«‹åƒç´ ï¼Œç„¶åé™¤ä»¥è®¾è®¡ç¨¿çš„å®½åº¦(å¸¸è§„UIæ˜¯è¾“å‡º750å®½åº¦)ï¼Œè¦ä¹˜100ï¼Œç„¶åèµ‹ç»™æ ¹å­—ä½“çš„<code>fontsize</code>ï¼Œä»¥è‡´åšåˆ°è‡ªé€‚åº”ï¼Œæ¥åŠ¨æ€æ”¹å˜æ ¹å­—ä½“å¤§å°ã€‚è¿™é‡Œæ‹¿åˆ°æ˜¯ç™¾åˆ†æ¯” ã€‚</li>
<li>ä¸ºä»€ä¹ˆè¦ä¹˜100ï¼Œé¦–å…ˆå‡è®¾è¯´è®¾å¤‡åˆ†è¾¨ç‡æ˜¯375ï¼Œ375 / 750æ˜¯0.5ï¼Œ0.5æˆ‘ä»¬ç§°ä¸º<code>æ¯”ä¾‹R</code>.è€Œæµè§ˆå™¨é»˜è®¤æœ€å°å­—ä½“ä¸º12pxã€‚ è¿™æ—¶æˆ‘ä»¬çš„0.5å°±ä¼šè¢«12é‡ç½®äº†ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦æ”¾å¤§ä¸€äº›ï¼Œè€Œ100åˆå¾ˆå¥½ç®—ã€‚åœ¨æ­¤ï¼Œå°±æŠŠæµè§ˆå™¨é»˜è®¤å­—å·è®¾ç½®ä¸º100pxï¼Œåˆšæ‰è·å–çš„0.5æ˜¯æ¯”ä¾‹ã€‚é‚£ä¹ˆç›¸ä¹˜åè·å¾—çš„50pxï¼Œå°±æ˜¯è‡ªé€‚åº”åçš„htmlæ ¹å­—ä½“å¤§å°ã€‚</li>
<li>ä¸ºäº†é€‚é…ç§»åŠ¨ç«¯ï¼ŒæŠŠå•ä½è½¬æ¢æˆremã€‚  <figure class="highlight js"><table><tr><td class="code"><pre><span class="line">body&#123;</span><br><span class="line">    font-size: 16px; <span class="comment">// ä¼šä½¿remä¸è·Ÿéšé”™è¯¯çš„12pxæˆ–è€…10px ï¼ˆæ¯”å¦‚è®¾ç½®62.5%æ—¶ï¼Œå°±ä¼š`bodysize`æ˜¯10pxï¼Œé‚£æ ·emå’Œreméƒ½ä¼šç®—é”™ã€‚ï¼‰</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li>
<li>é‚£ä¹ˆ1rem ç­‰äºï¼ˆ2ï¼‰æ­¥éª¤è¿”å›çš„html æ ¹å­—ä½“å¤§å°ã€‚ä½†è¿™æ—¶å€™é—®é¢˜æ¥äº†ï¼Œè®¾è®¡ç¨¿è¾“å‡ºçš„æ˜¯750å®½çš„å›¾çº¸ï¼Œè€Œä¸”æ˜¯pxï¼Œé‚£ä¹ˆä¸­é—´è¯¥æ€ä¹ˆè½¬åŒ–ï¼Ÿï¼Ÿï¼Ÿæ¯”å¦‚è¯´1rem ç­‰äº50px é‚£æˆ‘ç°åœ¨çš„bannerå›¾æ˜¯690pxé«˜ï¼Œæˆ‘åº”è¯¥æ˜¯è¾“å‡ºä¸€ä¸ª690/50 = result(rem)<br>å€ŸåŠ©<code>sasså‡½æ•°</code>ï¼Œè¾“å…¥å€¼ä¸º690pxï¼Œ<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">@<span class="function"><span class="keyword">function</span> <span class="title">pxTorem</span>(<span class="params">$px</span>)</span>&#123;<span class="comment">//$pxä¸ºéœ€è¦è½¬æ¢çš„å­—å·</span></span><br><span class="line">    @<span class="keyword">return</span> $px / $browser-<span class="keyword">default</span>-font-size * 1rem; <span class="comment">// å…¶å®è¿™é‡Œå¯ä»¥ç†è§£ä¸º $px * ï¼ˆ1rem/ 100ï¼‰,ä¹Ÿå°±æ˜¯bannerå›¾çš„é«˜åº¦ * ï¼ˆæ¯”ä¾‹Rï¼‰ï¼Œä»è€Œè·å¾—å®ƒåœ¨è¿™ä¸ªè¯¥è®¾å¤‡åº”è¯¥æœ‰çš„å¤§å°ã€‚</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
æ‰€ä»¥åœ¨æˆ‘ä»¬å¹³æ—¶å†™cssçš„æ—¶å€™ï¼Œå¯ä»¥è¿™ä¹ˆå†™æ ·å¼äº†<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">.city-li&#123;</span><br><span class="line">  text-align: center;</span><br><span class="line">  height: pxTorem(56px);</span><br><span class="line">  line-height: pxTorem(56px);</span><br><span class="line">  padding-left: pxTorem(10px);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>åœ¨å¯ä»¥ä¹¦å†™ç§»åŠ¨ç«¯æ ·å¼åã€‚ç»§ç»­æ¢è®¨ï¼šç¬¬äºŒå·®å¼‚æ˜¯ç½‘ç»œç¯å¢ƒã€‚ç½‘ç»œåŠ è½½é€Ÿåº¦ä¸ä¸€è‡´æ˜¯ç§»åŠ¨ç«¯çš„ç“¶é¢ˆï¼Œæ‰€ä»¥ä»£ç é‡çš„å¤§å°å’Œè´¨é‡æ˜¯ç§»åŠ¨ç«¯æ€§èƒ½ä¼˜åŒ–çš„å…³é”®ã€‚</li>
</ul>
]]></content>
      <tags>
        <tag>ç§»åŠ¨ç«¯</tag>
      </tags>
  </entry>
  <entry>
    <title>ç§»åŠ¨ç«¯æ‹–æ‹½</title>
    <url>/2019/02/25/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E6%8B%96%E6%8B%BD/</url>
    <content><![CDATA[<blockquote>
<p>ä»Šå¤©èŠä¸€ä¸‹ç§»åŠ¨ç«¯çš„æ‹–æ‹½ï¼Œä¸Šå‘¨ä¸€ä¸ªæ‹–åŠ¨çš„éœ€æ±‚ï¼Œæ­£å¥½æ•´ç†ä¸‹</p>
</blockquote>
<h6 id="åœºæ™¯æ˜¯è¿™æ ·çš„"><a href="#åœºæ™¯æ˜¯è¿™æ ·çš„" class="headerlink" title="åœºæ™¯æ˜¯è¿™æ ·çš„"></a>åœºæ™¯æ˜¯è¿™æ ·çš„</h6><pre><code>éœ€è¦åœ¨H5é‚€è¯·å‡½é‡Œåšåå­—æ ä½çš„æ‹–æ‹½ï¼Œå¹¶ä¸”è¦èƒ½è®°ä½å®ƒçš„ä½ç½®ä»¥ä¾¿äºå›¾ç‰‡åˆæˆã€‚
</code></pre>
<h6 id="ç”¨åˆ°çš„æŠ€æœ¯"><a href="#ç”¨åˆ°çš„æŠ€æœ¯" class="headerlink" title="ç”¨åˆ°çš„æŠ€æœ¯"></a>ç”¨åˆ°çš„æŠ€æœ¯</h6><pre><code>å®ƒä»¬éƒ½å±äºåŸç”ŸJS - ç§»åŠ¨ç«¯ç›‘å¬æ‹–æ‹½çš„APIã€‚
</code></pre>
<ul>
<li><code>touchStart</code> ï¼š<strong>å¼€å§‹è§¦æ‘¸</strong>å±å¹•æ—¶å°±è§¦å‘</li>
<li><code>touchmove</code>ï¼šåœ¨å±å¹•ä¸Š<strong>æ»‘åŠ¨</strong>æ—¶è§¦å‘</li>
<li><code>touchend</code>:  <strong>å±å¹•ä¸Šç¦»å¼€</strong>çš„æ—¶è§¦å‘ã€€ã€€ </li>
</ul>
<ul>
<li>å…¶ä¸­<em>touchStart</em>å’Œ<em>touchmove</em>ä¼šæä¾›<em>touch</em>å¯¹è±¡,åŒ…å«</li>
</ul>
<ul>
<li>pageXï¼šè§¦æ‘¸ç›®æ ‡åœ¨é¡µé¢ä¸­çš„xåæ ‡ã€‚</li>
<li>pageYï¼šè§¦æ‘¸ç›®æ ‡åœ¨é¡µé¢ä¸­çš„yåæ ‡ã€‚<br>è¿™æ¬¡åªç”¨äº†è¿™ä¸¤ä¸ªå‚æ•°<h6 id="è¿˜æ˜¯ä¸Šç‚¹ä»£ç å§"><a href="#è¿˜æ˜¯ä¸Šç‚¹ä»£ç å§" class="headerlink" title="è¿˜æ˜¯ä¸Šç‚¹ä»£ç å§"></a>è¿˜æ˜¯ä¸Šç‚¹ä»£ç å§</h6><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dragStart</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    isdrag = <span class="literal">true</span>;</span><br><span class="line">    tempX = <span class="built_in">parseInt</span>($(<span class="string">&#x27;.guest_name&#x27;</span>).css(<span class="string">&#x27;left&#x27;</span>) + <span class="number">0</span>);</span><br><span class="line">    tempY = <span class="built_in">parseInt</span>($(<span class="string">&#x27;.guest_name&#x27;</span>).css(<span class="string">&#x27;top&#x27;</span>) + <span class="number">0</span>);</span><br><span class="line">    x = e.touches[<span class="number">0</span>].pageX;</span><br><span class="line">    y = e.touches[<span class="number">0</span>].pageY;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dragMove</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (isdrag) &#123; <span class="comment">// è¿™é‡Œ e.touches[0].pageYä¸­çš„pageY</span></span><br><span class="line">        <span class="keyword">let</span> curX = tempX + e.touches[<span class="number">0</span>].pageX - x;</span><br><span class="line">        <span class="keyword">let</span> curY = tempY + e.touches[<span class="number">0</span>].pageY - y;</span><br><span class="line">        <span class="comment">// è¾¹ç•Œåˆ¤æ–­</span></span><br><span class="line">        <span class="comment">// curX = curX &lt; 0 ? 0 : curX;</span></span><br><span class="line">        curY = curY &lt; <span class="number">0</span> ? <span class="number">0</span> : curY;</span><br><span class="line">        curX = curX &lt; <span class="built_in">document</span>.documentElement.clientWidth - <span class="number">80</span> ? curX : <span class="built_in">document</span>.documentElement.clientWidth - <span class="number">80</span>;</span><br><span class="line">        curY = curY &lt; $(<span class="string">&#x27;.firstPageBackground&#x27;</span>).height() - <span class="number">25</span> ? curY : $(<span class="string">&#x27;.firstPageBackground&#x27;</span>).height() - <span class="number">25</span>; <span class="comment">// è¿™é‡Œçš„é«˜åº¦é™åˆ¶ $(&#x27;.firstPageBackground&#x27;).height() - 25 æ˜¯æ¥æºäºä¸šåŠ¡ä¸Šï¼Œé‚€è¯·å‡½ç”»å¸ƒçš„é«˜åº¦ï¼Œæ§åˆ¶åå­—ä¸èƒ½è¶…å‡ºé™åˆ¶ã€‚25æ˜¯åå­—æœ¬èº«çš„é«˜åº¦ã€‚éƒ½ä»¥pxä¸ºå•ä½ã€‚</span></span><br><span class="line">        $(<span class="string">&#x27;.guest_name&#x27;</span>).css(&#123;</span><br><span class="line">            <span class="string">&#x27;left&#x27;</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="string">&#x27;top&#x27;</span>: curY</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// ç¦æ­¢æµè§ˆå™¨é»˜è®¤äº‹ä»¶</span></span><br><span class="line">        e.preventDefault();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dragEnd</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    isdrag = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id=""><a href="#" class="headerlink" title=""></a></h6>å¥½å•¦ï¼Œè¿˜æ˜¯åˆ«å–å…³å­äº†ï¼Œå…¶å®åŸç†å°±æ˜¯ï¼Œåˆ©ç”¨äº†ä¸¤æ¬¡ç›‘å¬ç§»åŠ¨æä¾›çš„pageXå’ŒpageY ä¹‹å·®ã€‚å°†å·®å€¼åŠ åˆ°åŸæ¥çš„ç»å¯¹å®šä½ï¼Œleftå’Œtopé‡Œã€‚è®©domçš„ä½ç½®å‘ç”Ÿå˜åŒ–ã€‚ä»è€Œè¾¾åˆ°æ‹–æ‹½çš„æ•ˆæœã€‚</li>
</ul>
<h6 id="å‚è€ƒé“¾æ¥ï¼š"><a href="#å‚è€ƒé“¾æ¥ï¼š" class="headerlink" title="å‚è€ƒé“¾æ¥ï¼š"></a>å‚è€ƒé“¾æ¥ï¼š</h6><p><a href="https://blog.csdn.net/lee_magnum/article/details/17753807">blog</a><br><a href="https://blog.csdn.net/qq_35800306/article/details/59502392">blog</a></p>
]]></content>
      <tags>
        <tag>ç§»åŠ¨ç«¯</tag>
      </tags>
  </entry>
  <entry>
    <title>ç®—æ³•</title>
    <url>/2020/07/15/%E7%AE%97%E6%B3%95/</url>
    <content><![CDATA[<h4 id="1-æ·±åº¦ä¼˜å…ˆæœç´¢-amp-amp-å¹¿åº¦ä¼˜å…ˆæœç´¢"><a href="#1-æ·±åº¦ä¼˜å…ˆæœç´¢-amp-amp-å¹¿åº¦ä¼˜å…ˆæœç´¢" class="headerlink" title="1. æ·±åº¦ä¼˜å…ˆæœç´¢ &amp;&amp; å¹¿åº¦ä¼˜å…ˆæœç´¢"></a>1. æ·±åº¦ä¼˜å…ˆæœç´¢ &amp;&amp; å¹¿åº¦ä¼˜å…ˆæœç´¢</h4><p>æ·±åº¦ï¼šä¸€ä¸ªäººï¼Œä¸€æ¡è·¯èµ°åˆ°é»‘ï¼Œè·¯ä¸é€šï¼Œåˆ™åˆ°ä¸Šä¸€ä¸ªåˆ†å‰å£ï¼Œå†ä¸€æ¬¡ä¸€æ¡è·¯èµ°åˆ°é»‘ï¼Œå¾ªç¯ï¼Œç›´åˆ°æ‰¾åˆ°å‡ºå£ä¸ºæ­¢<br>å¹¿åº¦ï¼šå‡ ä¸ªäººï¼ŒåŒæ—¶é¢å¯¹å‡ ä¸ªåˆ†å‰è·¯å£ï¼Œç›´åˆ°æ‰¾åˆ°å‡ºå£ä¸ºæ­¢ã€‚åƒwifiçŠ¶çš„æ•°æ®èŠ‚ç‚¹åˆ†å¸ƒå°±æœ€é€‚åˆè¿™ç§ç®—æ³•ã€‚</p>
<p>å‚è€ƒï¼š<br><a href="https://github.com/sisterAn/JavaScript-Algorithms">ç“¶å­å› ç®—æ³•</a></p>
]]></content>
      <tags>
        <tag>ç®—æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title>JSçš„å‡ ç§ç»§æ‰¿æ–¹å¼</title>
    <url>/2020/04/07/%E7%BB%A7%E6%89%BF/</url>
    <content><![CDATA[<p>å” å—‘å” å—‘JSçš„ç»§æ‰¿å•¦~~~<span id="more"></span></p>
<h4 id="1-åŸå‹é“¾ç»§æ‰¿"><a href="#1-åŸå‹é“¾ç»§æ‰¿" class="headerlink" title="1. åŸå‹é“¾ç»§æ‰¿"></a>1. åŸå‹é“¾ç»§æ‰¿</h4><p>æ–¹å¼ <code>son.prototype = new father()</code></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">grandFather</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.gF_paroperty = <span class="string">&#x27;gF_paroperty&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">grandFather.prototype.getGFPropery = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// ç¥–çˆ¶åŸå‹çš„æ–¹æ³•</span></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">this</span>.gF_paroperty</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">father</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.fatherPropery = <span class="string">&#x27;fatherPropery&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å»ºç«‹ grandFather å’Œ father çš„ è¿æ¥ è®©çˆ¶äº²ç»§æ‰¿ç¥–çˆ¶ï¼ˆæ ¸å¿ƒï¼‰</span></span><br><span class="line">father.prototype = <span class="keyword">new</span> grandFather(); </span><br><span class="line"></span><br><span class="line">father.prototype.getFatherVal = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// çˆ¶äº²åŸå‹çš„æ–¹æ³•</span></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">this</span>.fatherPropery;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> sonInstance = <span class="keyword">new</span> father() <span class="comment">// å„¿å­ç»§æ‰¿çˆ¶äº²</span></span><br><span class="line"><span class="built_in">console</span>.log(sonInstance.getGFPropery()); <span class="comment">// expect output : &#x27;gF_paroperty&#x27;</span></span><br><span class="line"><span class="built_in">console</span>.log(sonInstance.getFatherVal()); <span class="comment">// expect output : fatherPropery</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ–¹æ³•ç¼ºé™·: å¤šä¸ªå­å®ä¾‹ä¼šæ”¹å˜å¼•ç”¨ç±»å‹</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SuperType</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.colors = [<span class="string">&quot;red&quot;</span>, <span class="string">&quot;blue&quot;</span>, <span class="string">&quot;green&quot;</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SubType</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">SubType.prototype = <span class="keyword">new</span> SuperType();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> instance1 = <span class="keyword">new</span> SubType();</span><br><span class="line">instance1.colors.push(<span class="string">&quot;black&quot;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(instance1.colors); <span class="comment">//&quot;red,blue,green,black&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> instance2 = <span class="keyword">new</span> SubType(); </span><br><span class="line"><span class="built_in">console</span>.log(instance2.colors); <span class="comment">//&quot;red,blue,green,black&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(instance2.__proto__.colors) <span class="comment">// array[4]</span></span><br></pre></td></tr></table></figure>

<h4 id="2-æ„é€ å‡½æ•°-ç»“åˆcallç»§æ‰¿"><a href="#2-æ„é€ å‡½æ•°-ç»“åˆcallç»§æ‰¿" class="headerlink" title="2. æ„é€ å‡½æ•° ç»“åˆcallç»§æ‰¿"></a>2. æ„é€ å‡½æ•° ç»“åˆ<code>call</code>ç»§æ‰¿</h4><p>æè¿°ï¼šæ ¸å¿ƒä»£ç æ˜¯<code>SuperType.call(this)</code>ï¼Œåˆ›å»ºå­ç±»å®ä¾‹æ—¶è°ƒç”¨SuperTypeæ„é€ å‡½æ•°ï¼Œäºæ˜¯SubTypeçš„<code>æ¯ä¸ªå®ä¾‹éƒ½ä¼š</code>å°†SuperTypeä¸­çš„å±æ€§<code>å¤åˆ¶ä¸€ä»½</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>  <span class="title">SuperType</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.color=[<span class="string">&quot;red&quot;</span>,<span class="string">&quot;green&quot;</span>,<span class="string">&quot;blue&quot;</span>];</span><br><span class="line">&#125;</span><br><span class="line">SuperType.prototype.specialWay = <span class="string">&#x27;123&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span>  <span class="title">SubType</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//ç»§æ‰¿è‡ªSuperType</span></span><br><span class="line">    SuperType.call(<span class="built_in">this</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> instance1 = <span class="keyword">new</span> SubType();</span><br><span class="line">instance1.color.push(<span class="string">&quot;black&quot;</span>);</span><br><span class="line"><span class="comment">// alert(instance1.color);//&quot;red,green,blue,black&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> instance2 = <span class="keyword">new</span> SubType();</span><br><span class="line"><span class="comment">// alert(instance2.color);//&quot;red,green,blue&quot;</span></span><br><span class="line"><span class="built_in">console</span>.log(instance2.specialWay); <span class="comment">// outputï¼šundefined åŸå‹ä¸Šçš„å±æ€§ã€æ–¹æ³•ç»§æ‰¿ä¸äº†</span></span><br></pre></td></tr></table></figure>
<div class="tip">
(1) åªèƒ½ç»§æ‰¿çˆ¶ç±»çš„å®ä¾‹å±æ€§å’Œæ–¹æ³•ï¼Œä¸èƒ½ç»§æ‰¿åŸå‹å±æ€§/æ–¹æ³•
(2) æ— æ³•å®ç°å¤ç”¨ï¼Œ`æ¯ä¸ªå­ç±»éƒ½æœ‰çˆ¶ç±»å®ä¾‹å‡½æ•°çš„å‰¯æœ¬`ï¼Œå½±å“æ€§èƒ½
</div>

<h4 id="3-Object-create"><a href="#3-Object-create" class="headerlink" title="3. Object.create"></a>3. <code>Object.create</code></h4><p>ä¹Ÿå°±æ˜¯æä¾›ä¸€ä¸ªè¿”å›ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå¹¶ä¸”è¯¥å¯¹è±¡çš„__proto__æŒ‡å‘ä¼ å…¥çš„å¯¹è±¡<br>è¯­æ³•</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Object</span>.create(proto[, propertiesObject])</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¯”è¾ƒå¥½çš„ç”¨æ³•ğŸ‘</span></span><br><span class="line">son.prototype = <span class="built_in">Object</span>.create(father.prototype)</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åŸç†</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">object</span>(<span class="params">obj</span>)</span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">F</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line">  F.prototype = obj;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> F();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<div class="tip">
(1) åŸå‹é“¾ç»§æ‰¿å¤šä¸ªå®ä¾‹çš„å¼•ç”¨ç±»å‹å±æ€§æŒ‡å‘ç›¸åŒï¼Œå­˜åœ¨ç¯¡æ”¹çš„å¯èƒ½ã€‚
(2) æ— æ³•ä¼ é€’å‚æ•°
</div>

<h4 id="4-ES6-extends-super"><a href="#4-ES6-extends-super" class="headerlink" title="4. ES6 extends super"></a>4. ES6 <code>extends</code> <code>super</code></h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Rectangle</span> </span>&#123;</span><br><span class="line">    <span class="comment">// constructor</span></span><br><span class="line">    <span class="function"><span class="title">constructor</span>(<span class="params">height, width</span>)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.height = height;</span><br><span class="line">        <span class="built_in">this</span>.width = width;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Getter</span></span><br><span class="line">    <span class="keyword">get</span> <span class="title">area</span>() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.calcArea()</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Method</span></span><br><span class="line">    <span class="function"><span class="title">calcArea</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.height * <span class="built_in">this</span>.width;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> rectangle = <span class="keyword">new</span> Rectangle(<span class="number">10</span>, <span class="number">20</span>);</span><br><span class="line"><span class="built_in">console</span>.log(rectangle.area);</span><br><span class="line"><span class="comment">// è¾“å‡º 200</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»§æ‰¿</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Square</span> <span class="keyword">extends</span> <span class="title">Rectangle</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">length</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>(length, length);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å¦‚æœå­ç±»ä¸­å­˜åœ¨æ„é€ å‡½æ•°ï¼Œåˆ™éœ€è¦åœ¨ä½¿ç”¨â€œthisâ€ä¹‹å‰é¦–å…ˆè°ƒç”¨ super()ã€‚</span></span><br><span class="line">    <span class="built_in">this</span>.name = <span class="string">&#x27;Square&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">get</span> <span class="title">area</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.height * <span class="built_in">this</span>.width;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> square = <span class="keyword">new</span> Square(<span class="number">10</span>);</span><br><span class="line"><span class="built_in">console</span>.log(square.area);</span><br><span class="line"><span class="comment">// è¾“å‡º 100</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="5-ES5ç»§æ‰¿å’ŒES6ç»§æ‰¿çš„åŒºåˆ«"><a href="#5-ES5ç»§æ‰¿å’ŒES6ç»§æ‰¿çš„åŒºåˆ«" class="headerlink" title="5. ES5ç»§æ‰¿å’ŒES6ç»§æ‰¿çš„åŒºåˆ«"></a>5. ES5ç»§æ‰¿å’ŒES6ç»§æ‰¿çš„åŒºåˆ«</h4><ul>
<li>ES5çš„ç»§æ‰¿å®è´¨ä¸Šæ˜¯å…ˆåˆ›å»ºå­ç±»çš„å®ä¾‹å¯¹è±¡ï¼Œç„¶åå†å°†çˆ¶ç±»çš„æ–¹æ³•æ·»åŠ åˆ°thisä¸Šï¼ˆParent.call(this)ï¼‰.  </li>
<li>ES6çš„ç»§æ‰¿æœ‰æ‰€ä¸åŒï¼Œå®è´¨ä¸Šæ˜¯å…ˆåˆ›å»ºçˆ¶ç±»çš„å®ä¾‹å¯¹è±¡thisï¼Œç„¶åå†ç”¨å­ç±»çš„æ„é€ å‡½æ•°ä¿®æ”¹thisã€‚<br>å› ä¸ºå­ç±»æ²¡æœ‰è‡ªå·±çš„thiså¯¹è±¡ï¼Œæ‰€ä»¥å¿…é¡»å…ˆè°ƒç”¨çˆ¶ç±»çš„super()æ–¹æ³•ï¼Œå¦åˆ™æ–°å»ºå®ä¾‹æŠ¥é”™ã€‚</li>
</ul>
<p>å‚è€ƒé“¾æ¥ï¼š<br><a href="https://juejin.im/post/5bcb2e295188255c55472db0">æ˜é‡‘</a></p>
]]></content>
      <tags>
        <tag>é¢è¯• JS</tag>
      </tags>
  </entry>
  <entry>
    <title>å‘å¸ƒè®¢é˜…æ¨¡å¼</title>
    <url>/2021/03/18/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85/</url>
    <content><![CDATA[<blockquote>
<p>æœ¬æ–‡æ‘˜è‡ªã€ŠJavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹</p>
</blockquote>
<h3 id="1-å®šä¹‰"><a href="#1-å®šä¹‰" class="headerlink" title="1. å®šä¹‰"></a>1. å®šä¹‰</h3><ul>
<li>å¯¹è±¡ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚å½“ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰€æœ‰ä¾èµ–å®ƒçš„å¯¹è±¡éƒ½ä¼šå¾—åˆ°é€šçŸ¥</li>
<li>Javascriptä¸€èˆ¬ç”¨äº‹ä»¶æ¨¡å‹æ¥æ›¿ä»£ä¼ ç»Ÿçš„å‘å¸ƒ-è®¢é˜…æ¨¡å¼</li>
<li>å¯èƒ½ä¼šæœ‰ä¸­ä»‹è¿™ä¸ªèº«ä»½ï¼Œä¸­è½¬æ‰€æœ‰ä¾èµ–å…³ç³»ã€‚è®©å‘å¸ƒè€…å’Œè®¢é˜…è€…ä¸éœ€è¦äº†è§£å½¼æ­¤ã€‚</li>
</ul>
<h3 id="2-ä¼˜ç‚¹"><a href="#2-ä¼˜ç‚¹" class="headerlink" title="2. ä¼˜ç‚¹"></a>2. ä¼˜ç‚¹</h3><ul>
<li>æä¾›æ•°æ®æ–¹ï¼Œå’Œæ¥å—æ•°æ®æ–¹ï¼Œä¸æ˜¯å¼ºè€¦åˆçš„å…³ç³»</li>
</ul>
<h3 id="3-æ¨¡æ‹Ÿ"><a href="#3-æ¨¡æ‹Ÿ" class="headerlink" title="3. æ¨¡æ‹Ÿ"></a>3. æ¨¡æ‹Ÿ</h3><pre><code><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">document</span>.body.addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    alert(<span class="number">2</span>)</span><br><span class="line">&#125;, <span class="literal">false</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä¸­é—´è€…ç»Ÿä¸€å¤„ç†</span></span><br><span class="line"><span class="keyword">var</span> Event = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> clientList = &#123;&#125;,</span><br><span class="line">        listen,</span><br><span class="line">        trigger,</span><br><span class="line">        remove;</span><br><span class="line">    </span><br><span class="line">    listen = <span class="function"><span class="keyword">function</span> (<span class="params">key, fn</span>) </span>&#123; <span class="comment">// æ·»åŠ </span></span><br><span class="line">        <span class="keyword">if</span> (!clientList[key]) &#123;</span><br><span class="line">            clientList[key] = []</span><br><span class="line">        &#125;</span><br><span class="line">        clientList[key] = fn</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    trigger = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="comment">// é€šçŸ¥ã€å‘å¸ƒ</span></span><br><span class="line">        <span class="keyword">var</span> key = <span class="built_in">Array</span>.prototype.shift.call(<span class="built_in">arguments</span>),</span><br><span class="line">            fns = clientList[key];</span><br><span class="line">        <span class="keyword">if</span> (!fns || fns.length === <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>,fn; fn = fns[i++]) &#123;</span><br><span class="line">            fn.apply(<span class="built_in">this</span>, <span class="built_in">arguments</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    remove = <span class="function"><span class="keyword">function</span> (<span class="params">key, fn</span>) </span>&#123; <span class="comment">// åˆ é™¤</span></span><br><span class="line">        <span class="keyword">var</span> fns = clientList[key]</span><br><span class="line">        <span class="keyword">if</span> (!fns) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!fn) &#123; <span class="comment">// å¦‚æœæ²¡æœ‰ä¼ å…¥å…·ä½“çš„å›è°ƒå‡½æ•°ï¼Œè¡¨ç¤ºéœ€è¦å–æ¶ˆ key å¯¹åº”æ¶ˆæ¯çš„æ‰€æœ‰è®¢é˜…</span></span><br><span class="line">            fns &amp;&amp; (fns.length = <span class="number">0</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = fns.length -<span class="number">1</span>; i&gt;=<span class="number">0</span>; i-- ) &#123;</span><br><span class="line">                <span class="keyword">var</span> _fn = fns[i]</span><br><span class="line">                <span class="keyword">if</span> (_fn === fn) &#123;</span><br><span class="line">                    fns.splice(i, <span class="number">1</span>)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">listen</span>: listen,</span><br><span class="line">        <span class="attr">trigger</span>: trigger,</span><br><span class="line">        <span class="attr">remove</span>: remove</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å°çº¢è®¢é˜…æ¶ˆæ¯ // è¾“å‡ºï¼š&#x27;ä»·æ ¼=2000000&#x27; </span></span><br><span class="line">Event.listen( <span class="string">&#x27;squareMeter88&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"> price </span>)</span>&#123; </span><br><span class="line">    <span class="built_in">console</span>.log( <span class="string">&#x27;ä»·æ ¼= &#x27;</span> + price )</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">Event.trigger( <span class="string">&#x27;squareMeter88&#x27;</span>, <span class="number">2000000</span> );<span class="comment">// å”®æ¥¼å¤„å‘å¸ƒæ¶ˆæ¯</span></span><br></pre></td></tr></table></figure>
</code></pre>
<h3 id="4-æ€è€ƒğŸ¤”"><a href="#4-æ€è€ƒğŸ¤”" class="headerlink" title="4. æ€è€ƒğŸ¤”"></a>4. æ€è€ƒğŸ¤”</h3><pre><code>è®¢é˜…å‘å¸ƒçš„é¡ºåºï¼š
åŸæœ¬æ˜¯å…ˆè®¢é˜…ï¼Œå†å‘å¸ƒï¼Œå› ä¸ºå…ˆå‘å¸ƒæ²¡è®¢é˜…çš„æƒ…å†µä¸‹ï¼Œæ¶ˆæ¯ä¼šä¸¢å¤±
å¢åŠ å…ˆå‘å¸ƒåè®¢é˜…çš„èƒ½åŠ›ï¼šç¦»çº¿äº‹ä»¶çš„å †æ ˆï¼Œç”¨æ¥å­˜å‚¨å°šæœªè¢«è®¢é˜…çš„ç¦»çº¿äº‹ä»¶ã€‚ç­‰åˆ°æœ‰è®¢é˜…çš„æ—¶å€™ï¼Œå†éå†å †æ ˆæ‰§è¡Œã€‚
éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç¦»çº¿äº‹ä»¶çš„è§¦å‘åªæœ‰ä¸€æ¬¡ã€‚(å…·ä½“ä»£ç å®ç°ç»“åˆä¹¦æœ¬å‚è€ƒ )
</code></pre>
<h3 id="5-ä¼˜ç¼ºç‚¹"><a href="#5-ä¼˜ç¼ºç‚¹" class="headerlink" title="5. ä¼˜ç¼ºç‚¹"></a>5. ä¼˜ç¼ºç‚¹</h3><pre><code>+ ä¼˜ç‚¹ï¼šæ—¶é—´å’Œå¯¹è±¡ä¸Šçš„è§£è€¦ï¼Œå¸¸ç”¨äºå¼‚æ­¥ç¼–ç¨‹ã€‚
+ ç¼ºç‚¹ï¼šè®¢é˜…äº†æ¶ˆæ¯ï¼Œè®¢é˜…è€…ä¼šå§‹ç»ˆå­˜åœ¨å†…å­˜ä¸­ã€‚å¯¹è±¡ä¹‹é—´çš„å¿…è¦è”ç³»ä¼šéš¾ä»¥è·Ÿè¸ªã€‚
</code></pre>
<h4 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h4><p><a href="">è®¾è®¡æ¨¡å¼ç¯‡è§‚å¯Ÿè®¢é˜…æ¨¡å¼ç¬¬10èŠ‚</a><br><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function/apply">apply</a></p>
]]></content>
      <tags>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title>è£…é¥°å™¨æ¨¡å¼</title>
    <url>/2021/03/20/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E8%A3%85%E9%A5%B0%E5%99%A8/</url>
    <content><![CDATA[<blockquote>
<p>æœ¬æ–‡æ‘˜è‡ªã€ŠJavascriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹</p>
</blockquote>
<h3 id="1-å®šä¹‰"><a href="#1-å®šä¹‰" class="headerlink" title="1. å®šä¹‰"></a>1. å®šä¹‰</h3><p> ç»™å¯¹è±¡åŠ¨æ€æ·»åŠ èŒè´£</p>
<h3 id="2-åº”ç”¨åœºæ™¯"><a href="#2-åº”ç”¨åœºæ™¯" class="headerlink" title="2. åº”ç”¨åœºæ™¯"></a>2. åº”ç”¨åœºæ™¯</h3><ul>
<li>è§£é™¤è€¦åˆå…³ç³»ï¼Œå¦‚æäº¤å‰çš„è¡¨å•æ£€éªŒï¼Œå‡½æ•°å‚æ•°å°è£…ç­‰</li>
</ul>
<h3 id="3-æ¨¡æ‹Ÿ"><a href="#3-æ¨¡æ‹Ÿ" class="headerlink" title="3. æ¨¡æ‹Ÿ"></a>3. æ¨¡æ‹Ÿ</h3><h4 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h4><p><a href=""></a></p>
]]></content>
      <tags>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title>å¬åˆ°è¯·å›ç­”1988</title>
    <url>/2019/04/06/%E8%AF%B7%E5%9B%9E%E7%AD%941988/</url>
    <content><![CDATA[<p>å•Š   æ„ŸåŠ¨å•Šæ„ŸåŠ¨<br><img src="https://pic2.zhimg.com/v2-73eb983ad340c514bd4c33f08032000f_r.jpg" alt="åˆç…§"><br>å¾ˆæ¸©æš–ï¼Œå¾ˆç®€å•ï¼Œå¾ˆå‹å¥½çš„æƒ…æ„Ÿ</p>
<p>æˆ‘ç°åœ¨å¬ç€1988çš„ç½‘æ˜“äº‘æ­Œå•ï¼Œå†™ä¸‹è¿™ç¯‡æ—¥å¿—ï¼Œå¸Œæœ›çœ‹åˆ°çš„äººä¹Ÿå’Œæˆ‘ä¸€æ ·å–œæ¬¢è¿™éƒ¨ç‰‡å­å‘¢</p>
<p>ä¸€éƒ¨å°å°çš„ç”µè§†æœºé‡Œï¼Œæ”¾ç€çš„æ˜¯æˆ‘ä»¬çš„æ¶¦å‘å“¥å’Œå›½è£å“¥çš„ã€Šè‹±é›„æœ¬è‰²ã€‹ï¼Œå“‡å¥½æœ‰å“ä½å‘€ï¼Œæˆ‘ä»¬æ•…äº‹é‡Œçš„ä¸»äººå…¬ä»¬ååœ¨ç”µè§†æœºå‰ï¼Œå–„å®‡ï¼Œå¨ƒå¨ƒé±¼ï¼Œæ­£ç„•ï¼Œå¾·å–„ï¼Œé˜¿æ³½ã€‚</p>
<p>å“ˆå“ˆï¼Œè±¹çº¹å¥³å£«å¤§å–Šä¸€å£°:â€æ­£ç„•å•Šï¼Œå›å®¶åƒé¥­å•¦ï¼â€ï¼Œæ¥ç€ä»–ä»¬éƒ½å›å®¶åƒé¥­ï¼Œç•™ä¸‹æˆ‘ä»¬å‘†èŒçš„é˜¿æ³½ï¼Œé˜¿æ³½çˆ¸çˆ¸ä¹Ÿè¿›æ¥æˆ¿é—´ï¼Œå¾®ç¬‘ç€è¯´ï¼Œé˜¿æ³½ï¼Œæˆ‘ä»¬ä¹Ÿåƒé¥­å§ğŸ˜Š</p>
<p>æ•…äº‹DuangDuangDuangå¼€å§‹å’¯~~~</p>
]]></content>
      <tags>
        <tag>éšç¬”</tag>
      </tags>
  </entry>
  <entry>
    <title>æµè§ˆå™¨-é‡æ’&amp;&amp;é‡ç»˜</title>
    <url>/2020/07/20/%E9%87%8D%E7%BB%98&amp;&amp;%E9%87%8D%E6%8E%92/</url>
    <content><![CDATA[<p><img src="/%E9%87%8D%E7%BB%98&&%E9%87%8D%E6%8E%92/%E9%87%8D%E7%BB%98%E9%87%8D%E6%8E%921.png" alt="é‡ç»˜é‡æ’1"><br><img src="/%E9%87%8D%E7%BB%98&&%E9%87%8D%E6%8E%92/%E9%87%8D%E7%BB%98%E9%87%8D%E6%8E%922.png" alt="é‡ç»˜é‡æ’2"><br><img src="/%E9%87%8D%E7%BB%98&&%E9%87%8D%E6%8E%92/%E9%87%8D%E7%BB%98%E9%87%8D%E6%8E%923.png" alt="é‡ç»˜é‡æ’3"><br><img src="/%E9%87%8D%E7%BB%98&&%E9%87%8D%E6%8E%92/%E9%87%8D%E7%BB%98%E9%87%8D%E6%8E%924.png" alt="é‡ç»˜é‡æ’4"></p>
<p>å‚è€ƒï¼š<br><a href="https://segmentfault.com/a/1190000016990089">segment</a></p>
]]></content>
      <tags>
        <tag>æµè§ˆå™¨ CSSæ¸²æŸ“</tag>
      </tags>
  </entry>
  <entry>
    <title>é˜²æŠ–ä¸èŠ‚æµ</title>
    <url>/2019/12/03/%E9%98%B2%E6%8A%96%E4%B8%8E%E8%8A%82%E6%B5%81/</url>
    <content><![CDATA[<h3 id="1-é˜²æŠ–"><a href="#1-é˜²æŠ–" class="headerlink" title="1.é˜²æŠ–"></a>1.é˜²æŠ–</h3><p>âœ¨ ä¸šåŠ¡åœºæ™¯ï¼šä½ å°½ç®¡è§¦å‘äº‹ä»¶ï¼Œä½†æ˜¯æˆ‘ä¸€å®šåœ¨äº‹ä»¶è§¦å‘ n ç§’åæ‰æ‰§è¡Œã€‚<br>å¦‚æœä½ åœ¨ä¸€ä¸ªäº‹ä»¶è§¦å‘çš„ n ç§’å†…åˆè§¦å‘äº†è¿™ä¸ªäº‹ä»¶ï¼Œé‚£æˆ‘å°±ä»¥æ–°çš„äº‹ä»¶çš„æ—¶é—´ä¸ºå‡†ï¼Œn ç§’åæ‰æ‰§è¡Œï¼Œ<br>æ€»ä¹‹ï¼Œå°±æ˜¯è¦ç­‰ä½ è§¦å‘å®Œäº‹ä»¶ n ç§’å†…ä¸å†è§¦å‘äº‹ä»¶ï¼Œæˆ‘æ‰æ‰§è¡Œ.<br>ç®€å•çš„è¯´æ³•æ˜¯ï¼Œå–å†³äºä¸Šæ¬¡æ²¡æ“ä½œåï¼Œdelayæ—¶é—´åæ‰§è¡Œã€‚</p>
<p>ğŸ‘é€‚ç”¨åœºæ™¯ï¼šinputçš„æ ¼å¼éªŒè¯ã€æäº¤æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶ï¼ˆè§¦å‘é¢‘ä¸é‚£ä¹ˆé«˜ï¼‰</p>
<p>ä»‹ç»ä¸‰ä¸ªç‰ˆæœ¬ï¼š</p>
<h4 id="1æŒ‡å®šthis"><a href="#1æŒ‡å®šthis" class="headerlink" title="1æŒ‡å®šthis"></a>1æŒ‡å®šthis</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">func, wait</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> timeout;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">clearTimeout</span>(timeout)</span><br><span class="line">        timeout = <span class="built_in">setTimeout</span>(func,wait)  <span class="comment">// ä¿æŒåªæ˜¯ä¸€ä¸ªå®šæ—¶å™¨</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-thisæŒ‡å‘-amp-amp-æŒ‡å®šä¼ å‚ï¼ˆæ¯”å¦‚eventï¼‰"><a href="#2-thisæŒ‡å‘-amp-amp-æŒ‡å®šä¼ å‚ï¼ˆæ¯”å¦‚eventï¼‰" class="headerlink" title="2 thisæŒ‡å‘ &amp;&amp; æŒ‡å®šä¼ å‚ï¼ˆæ¯”å¦‚eventï¼‰"></a>2 thisæŒ‡å‘ &amp;&amp; æŒ‡å®šä¼ å‚ï¼ˆæ¯”å¦‚<code>event</code>ï¼‰</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">func, wait</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> timeout;</span><br><span class="line">    <span class="comment">// console.log(this) // è¿™é‡Œçš„æ—¶å€™æŒ‡å‘window</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> context = <span class="built_in">this</span> <span class="comment">// è¿™é‡Œçš„æ—¶å€™æŒ‡å‘btn å…³é”®æ˜¯ç¼“å­˜è¿™æ—¶å€™çš„this</span></span><br><span class="line">        <span class="keyword">var</span> args = <span class="built_in">arguments</span></span><br><span class="line">        <span class="built_in">clearTimeout</span>(timeout)</span><br><span class="line">        timeout = <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="comment">//æ²¡ç»‘å®šcontextæ—¶ï¼Œè¿™é‡ŒthisæŒ‡å‘window</span></span><br><span class="line">            func.apply(context,args)</span><br><span class="line">        &#125;, wait)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-thisæŒ‡å‘-amp-amp-æŒ‡å®šä¼ å‚-amp-amp-ç«‹å³æ‰§è¡Œ"><a href="#3-thisæŒ‡å‘-amp-amp-æŒ‡å®šä¼ å‚-amp-amp-ç«‹å³æ‰§è¡Œ" class="headerlink" title="3 thisæŒ‡å‘ &amp;&amp; æŒ‡å®šä¼ å‚ &amp;&amp; ç«‹å³æ‰§è¡Œ"></a>3 thisæŒ‡å‘ &amp;&amp; æŒ‡å®šä¼ å‚ &amp;&amp; ç«‹å³æ‰§è¡Œ</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">func, wait, immediate</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> timeout;</span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> context = <span class="built_in">this</span></span><br><span class="line">            <span class="keyword">var</span> args = <span class="built_in">arguments</span></span><br><span class="line">            <span class="keyword">if</span> (timeout) &#123; <span class="built_in">clearTimeout</span>(timeout) &#125;</span><br><span class="line">            <span class="keyword">if</span> (immediate) &#123; <span class="comment">// ç«‹å³æ‰§è¡Œ</span></span><br><span class="line">                <span class="comment">// timeoutæœ‰å€¼çš„æƒ…å†µä¸‹ï¼Œæ”¹ä¸ºå»¶æ—¶</span></span><br><span class="line">                <span class="keyword">var</span> callNow = !timeout</span><br><span class="line">                timeout = <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                    timeout = <span class="literal">null</span></span><br><span class="line">                &#125;,wait)</span><br><span class="line">                <span class="keyword">if</span> (callNow) &#123; func.apply(context,args) &#125;</span><br><span class="line">                <span class="comment">// è·‘å®Œç«‹å³æ‰§è¡Œï¼Œæ°¸è¿œéƒ½ä¼šæ‰§è¡Œä¸Šé¢çš„timeout = nullï¼Œ</span></span><br><span class="line">                <span class="comment">// ç„¶åä¸‹ä¸€æ¬¡è¿›å…¥åˆ¤æ–­callNowæ—¶ï¼Œåˆä¼šæ˜¯ç«‹å³æ‰§è¡Œã€‚ </span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                timeout = <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                    func.apply(context,args)</span><br><span class="line">                &#125;,wait)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-èŠ‚æµ"><a href="#2-èŠ‚æµ" class="headerlink" title="2.èŠ‚æµ"></a>2.èŠ‚æµ</h3><p>æŒ‰æŒ‡å®šçš„delayæ‰§è¡Œ<br> ğŸ‘ é€‚ç”¨åœºæ™¯ï¼šï¼ˆè§¦å‘é¢‘é«˜ï¼‰resize, touchmove, mousemove, scroll åŠ¨ç”»åœºæ™¯</p>
<p>ä¸‹é¢ä»‹ç»ä¸¤ä¸ªç‰ˆæœ¬ï¼š</p>
<h4 id="âœ¨-ä½¿ç”¨æ—¶é—´æˆ³"><a href="#âœ¨-ä½¿ç”¨æ—¶é—´æˆ³" class="headerlink" title="âœ¨ ä½¿ç”¨æ—¶é—´æˆ³"></a>âœ¨ ä½¿ç”¨æ—¶é—´æˆ³</h4><p>  ä½¿ç”¨æ—¶é—´æˆ³ï¼Œå½“è§¦å‘äº‹ä»¶çš„æ—¶å€™ï¼Œæˆ‘ä»¬å–å‡ºå½“å‰çš„æ—¶é—´æˆ³ï¼Œ<br>  ç„¶åå‡å»ä¹‹å‰çš„æ—¶é—´æˆ³(æœ€ä¸€å¼€å§‹å€¼è®¾ä¸º 0 )ï¼Œ<br>  å¦‚æœå¤§äºè®¾ç½®çš„æ—¶é—´å‘¨æœŸï¼Œå°±æ‰§è¡Œå‡½æ•°ï¼Œç„¶åæ›´æ–°æ—¶é—´æˆ³ä¸ºå½“å‰çš„æ—¶é—´æˆ³ï¼Œ<br>  å¦‚æœå°äºï¼Œå°±ä¸æ‰§è¡Œã€‚</p>
<div class="tip">
    ç¬¬ä¸€ä¸‹ä¼šç«‹åˆ»æ‰§è¡Œ
</div>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// +new Date() å°†ä¼šè°ƒç”¨ Date.prototype ä¸Šçš„ valueOf() æ–¹æ³•ï¼Œ</span></span><br><span class="line"><span class="comment">// Date.prototype.valueæ–¹æ³•ç­‰åŒäºDate.prototype.getTime()</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">throttle</span>(<span class="params">func, wait</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> previous = <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> now = +<span class="keyword">new</span> <span class="built_in">Date</span>() </span><br><span class="line">        <span class="keyword">const</span> args = <span class="built_in">arguments</span></span><br><span class="line">        <span class="keyword">const</span> context = <span class="built_in">this</span></span><br><span class="line">        <span class="keyword">if</span> ((now - previous) &gt; wait) &#123;</span><br><span class="line">            func.apply(context,args)</span><br><span class="line">            previous = now</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="âœ¨-ä½¿ç”¨å®šæ—¶å™¨"><a href="#âœ¨-ä½¿ç”¨å®šæ—¶å™¨" class="headerlink" title="âœ¨ ä½¿ç”¨å®šæ—¶å™¨"></a>âœ¨ ä½¿ç”¨å®šæ—¶å™¨</h4><p>å½“è§¦å‘äº‹ä»¶çš„æ—¶å€™ï¼Œæˆ‘ä»¬è®¾ç½®ä¸€ä¸ªå®šæ—¶å™¨ï¼Œ<br>å†è§¦å‘äº‹ä»¶çš„æ—¶å€™ï¼Œå¦‚æœå®šæ—¶å™¨å­˜åœ¨ï¼Œå°±ä¸æ‰§è¡Œï¼Œ<br>ç›´åˆ°å®šæ—¶å™¨æ‰§è¡Œï¼Œç„¶åæ‰§è¡Œå‡½æ•°ï¼Œ<br>æ¸…ç©ºå®šæ—¶å™¨ï¼Œ<br>è¿™æ ·å°±å¯ä»¥è®¾ç½®ä¸‹ä¸ªå®šæ—¶å™¨ã€‚</p>
<div class="tip">
    ç¬¬ä¸€ä¸‹ä¼šå»¶æ—¶æ‰§è¡Œ
</div>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">throttle</span>(<span class="params">func, wait</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> timeout;</span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">const</span> context = <span class="built_in">this</span></span><br><span class="line">            <span class="keyword">const</span> args = <span class="built_in">arguments</span></span><br><span class="line">            <span class="keyword">if</span> (!timeout) &#123;</span><br><span class="line">                timeout = <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                    timeout = <span class="literal">null</span></span><br><span class="line">                    func.apply(context, args)</span><br><span class="line">                &#125;, wait)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<h3 id="3-ä¸¤è€…çš„å…³è”ä¸åŒºåˆ«"><a href="#3-ä¸¤è€…çš„å…³è”ä¸åŒºåˆ«" class="headerlink" title="3.ä¸¤è€…çš„å…³è”ä¸åŒºåˆ«"></a>3.ä¸¤è€…çš„å…³è”ä¸åŒºåˆ«</h3><p>ä¸¤è€…éƒ½æœ‰æ§åˆ¶è§¦å‘çš„æ¬¡æ•°ï¼Œé˜²æŠ–æ§åˆ¶çš„æ›´å‰å®³ï¼ŒèŠ‚æµæ˜¯é™ä½é¢‘ç‡<br>å‡è®¾æ— é™æ¬¡è§¦å‘ï¼šé˜²æŠ–å‡½æ•°æ°¸è¿œä¸ä¼šçœŸæ­£æ‰§è¡Œï¼ŒèŠ‚æµå‡½æ•°åˆ™ä¼šæŒ‰ç…§é—´éš”æ—¶é—´æ‰§è¡Œã€‚</p>
<p>å‚è€ƒé“¾æ¥ï¼š<br><a href="https://zhuanlan.zhihu.com/p/38313717">ä¸“æ </a><br><a href="https://github.com/mqyqingfeng/Blog/issues/26">mqyqingfeng  issue</a></p>
]]></content>
      <tags>
        <tag>JSä¼˜åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title>é¢è¯•è¦æ±‚</title>
    <url>/2020/04/12/%E9%9D%A2%E8%AF%95%E8%A6%81%E6%B1%82/</url>
    <content><![CDATA[<p>çŸ¥å·±çŸ¥å½¼ï¼Œç™¾æˆ˜ç™¾èƒœ<br>å®åŠ›æ¨è<br><a href="https://muyiy.cn/">æœ¨æ˜“æ¨</a></p>
<p>å‚è€ƒé“¾æ¥ï¼š</p>
<p><a href="https://zhuanlan.zhihu.com/p/69705235">é˜¿é‡Œp7è¦æ±‚</a><br><a href="https://github.com/jawil/blog/issues/22">é˜¿é‡ŒP6+è¦æ±‚</a><br><a href="https://juejin.im/post/5e5522b36fb9a07ce152c51c">æ˜é‡‘1</a><br><a href="https://juejin.im/post/587dab348d6d810058d87a0a">æ˜é‡‘2</a><br><a href="https://github.com/axuebin/articles/issues/39">axuebin issue</a><br><a href="https://github.com/coffe1891/frontend-hard-mode-interview">å‰ç«¯å†…å‚github</a></p>
]]></content>
      <tags>
        <tag>é¢è¯•</tag>
      </tags>
  </entry>
</search>
